# 12.4 Security Settings

## 12.4.1 Business Purpose & Scope

## 12.4.1.1 Business Purpose

Security Settings management provides a comprehensive framework for configuring, monitoring, and enforcing security policies across the HR ecosystem. This enables organizations to protect sensitive HR data, prevent unauthorized access, ensure regulatory compliance, manage security risks, and maintain system integrity while providing centralized control over authentication, authorization, encryption, and security monitoring capabilities.

## 12.4.1.2 Business Scope

Enable complete security management including password policies, multi-factor authentication, session management, access control, encryption settings, security monitoring, threat detection, and compliance enforcement. The system supports automated security configuration, real-time threat monitoring, incident response, security analytics, and integration with enterprise security solutions while ensuring data protection, regulatory compliance, and operational security across all HR functions and system components.

## 12.4.2 Security Policy Configuration Schema

```
Table: security_policy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- policy_name: VARCHAR(200) (Required)
- policy_type: ENUM('Password Policy', 'Session Management', 'Access Control', 'Encryption', 'Multi-Factor Auth', 'Network Security', 'Device Security', 'Data Protection', 'Compliance')
- policy_category: ENUM('Authentication', 'Authorization', 'Data Security', 'Network Security', 'Endpoint Security', 'Application Security', 'Physical Security', 'Compliance')
- policy_description: TEXT (Required)
- policy_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- configuration: JSON (Policy configuration parameters)
- enforcement_rules: JSON (Policy enforcement and validation rules)
- exception_handling: JSON (Exception handling and approval workflow)
- compliance_requirements: JSON (Regulatory compliance requirements)
- risk_assessment: JSON (Security risk assessment)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- review_frequency_days: INTEGER (Default: 90)
- last_review_date: DATE
- next_review_date: DATE
- approval_required: BOOLEAN (Default: TRUE)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_policy_type (policy_type)
- INDEX idx_policy_category (policy_category)
- INDEX idx_policy_level (policy_level)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)
- INDEX idx_review_frequency_days (review_frequency_days)
- INDEX idx_last_review_date (last_review_date)
- INDEX idx_next_review_date (next_review_date)
- INDEX idx_approval_required (approval_required)

Constraints:
- fk_security_policy_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_policy_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- fk_security_policy_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_policy_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_review_frequency_positive CHECK (review_frequency_days > 0)
- chk_effective_order CHECK (effective_to IS NULL OR effective_to >= effective_from)
- chk_review_order CHECK (last_review_date IS NULL OR next_review_date >= last_review_date)
```

```
Table: password_policy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- policy_name: VARCHAR(200) (Required)
- min_length: INTEGER (Default: 8)
- max_length: INTEGER (Default: 128)
- require_uppercase: BOOLEAN (Default: TRUE)
- require_lowercase: BOOLEAN (Default: TRUE)
- require_numbers: BOOLEAN (Default: TRUE)
- require_special_chars: BOOLEAN (Default: TRUE)
- require_mixed_case: BOOLEAN (Default: FALSE)
- special_chars_allowed: VARCHAR(50) (Default: '!@#$%^&*()_+-=[]{}|;:,.<>?')
- forbidden_patterns: JSON (Forbidden password patterns)
- password_history_count: INTEGER (Default: 5)
- password_expiry_days: INTEGER (Default: 90)
- warning_days_before_expiry: INTEGER (Default: 14)
- account_lockout_attempts: INTEGER (Default: 5)
- account_lockout_duration_minutes: INTEGER (Default: 30)
- temporary_password_expiry_hours: INTEGER (Default: 24)
- complexity_score_minimum: INTEGER (Default: 3)
- dictionary_check_enabled: BOOLEAN (Default: TRUE)
- breach_check_enabled: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_min_length (min_length)
- INDEX idx_max_length (max_length)
- INDEX idx_require_uppercase (require_uppercase)
- INDEX idx_require_lowercase (require_lowercase)
- INDEX idx_require_numbers (require_numbers)
- INDEX idx_require_special_chars (require_special_chars)
- INDEX idx_password_history_count (password_history_count)
- INDEX idx_password_expiry_days (password_expiry_days)
- INDEX idx_account_lockout_attempts (account_lockout_attempts)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_password_policy_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_password_policy_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_password_policy_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_length_range CHECK (min_length > 0 AND max_length >= min_length)
- chk_history_positive CHECK (password_history_count >= 0)
- chk_expiry_positive CHECK (password_expiry_days > 0)
- chk_warning_positive CHECK (warning_days_before_expiry >= 0)
- chk_lockout_positive CHECK (account_lockout_attempts > 0 AND account_lockout_duration_minutes > 0)
- chk_temp_expiry_positive CHECK (temporary_password_expiry_hours > 0)
- chk_complexity_range CHECK (complexity_score_minimum BETWEEN 0 AND 5)
```

## 12.4.3 Authentication & Session Management Schema

```
Table: authentication_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- auth_method: ENUM('Local', 'LDAP', 'Active Directory', 'SAML', 'OAuth 2.0', 'OpenID Connect', 'Multi-Factor', 'Biometric', 'Certificate')
- auth_provider_name: VARCHAR(200) (Required)
- auth_configuration: JSON (Authentication provider configuration)
- mfa_required: BOOLEAN (Default: FALSE)
- mfa_methods: JSON (Allowed MFA methods)
- mfa_backup_methods: JSON (Backup MFA methods)
- mfa_trusted_devices: BOOLEAN (Default: FALSE)
- mfa_device_trust_days: INTEGER (Default: 30)
- session_timeout_minutes: INTEGER (Default: 30)
- idle_timeout_minutes: INTEGER (Default: 15)
- max_concurrent_sessions: INTEGER (Default: 3)
- session_encryption: BOOLEAN (Default: TRUE)
- secure_cookie_flag: BOOLEAN (Default: TRUE)
- same_site_cookie: BOOLEAN (Default: TRUE)
- csrf_protection: BOOLEAN (Default: TRUE)
- ip_whitelist_enabled: BOOLEAN (Default: FALSE)
- ip_whitelist: JSON (Allowed IP addresses)
- geo_restriction_enabled: BOOLEAN (Default: FALSE)
- geo_restriction_rules: JSON (Geographic restriction rules)
- device_fingerprinting: BOOLEAN (Default: FALSE)
- browser_fingerprinting: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_auth_method (auth_method)
- INDEX idx_mfa_required (mfa_required)
- INDEX idx_session_timeout_minutes (session_timeout_minutes)
- INDEX idx_idle_timeout_minutes (idle_timeout_minutes)
- INDEX idx_max_concurrent_sessions (max_concurrent_sessions)
- INDEX idx_ip_whitelist_enabled (ip_whitelist_enabled)
- INDEX idx_geo_restriction_enabled (geo_restriction_enabled)
- INDEX idx_device_fingerprinting (device_fingerprinting)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_authentication_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_authentication_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_authentication_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_session_timeout_positive CHECK (session_timeout_minutes > 0)
- chk_idle_timeout_positive CHECK (idle_timeout_minutes > 0)
- chk_concurrent_sessions_positive CHECK (max_concurrent_sessions > 0)
- chk_device_trust_positive CHECK (mfa_device_trust_days >= 0)
```

```
Table: user_session
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- user_id: UUID (Foreign Key to user)
- session_id: VARCHAR(200) (Required, Unique, Indexed)
- session_token: VARCHAR(500) (Required)
- refresh_token: VARCHAR(500)
- device_id: VARCHAR(200)
- device_type: ENUM('Desktop', 'Mobile', 'Tablet', 'Unknown')
- device_fingerprint: VARCHAR(500)
- browser_info: JSON (Browser and device information)
- ip_address: VARCHAR(45) (Required)
- user_agent: TEXT
- login_time: TIMESTAMP (Required, Indexed)
- last_activity_time: TIMESTAMP (Required, Indexed)
- expiry_time: TIMESTAMP (Required)
- is_active: BOOLEAN (Default: TRUE)
- is_persistent: BOOLEAN (Default: FALSE)
- mfa_verified: BOOLEAN (Default: FALSE)
- mfa_method: VARCHAR(50)
- security_flags: JSON (Security flags and indicators)
- access_level: ENUM('Standard', 'Elevated', 'Admin', 'System')
- accessed_resources: JSON (Resources accessed during session)
- security_events: JSON (Security events during session)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_user_session_company_session (session_id, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_device_id (device_id)
- INDEX idx_device_type (device_type)
- INDEX idx_ip_address (ip_address)
- INDEX idx_login_time (login_time)
- INDEX idx_last_activity_time (last_activity_time)
- INDEX idx_expiry_time (expiry_time)
- INDEX idx_is_active (is_active)
- INDEX idx_is_persistent (is_persistent)
- INDEX idx_mfa_verified (mfa_verified)
- INDEX idx_access_level (access_level)

Constraints:
- fk_user_session_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_user_session_user FOREIGN KEY (user_id) REFERENCES user(id)
- chk_login_order CHECK (last_activity_time >= login_time AND expiry_time >= login_time)
- chk_expiry_future CHECK (expiry_time >= last_activity_time)
```

## 12.4.4 Encryption & Data Protection Schema

```
Table: encryption_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- encryption_type: ENUM('Data at Rest', 'Data in Transit', 'Database Encryption', 'File Encryption', 'Email Encryption', 'API Encryption', 'Backup Encryption')
- encryption_algorithm: VARCHAR(50) (Required)
- encryption_key_length: INTEGER (Default: 256)
- key_rotation_days: INTEGER (Default: 90)
- key_derivation_function: VARCHAR(50) (Default: 'PBKDF2')
- salt_length: INTEGER (Default: 32)
- iteration_count: INTEGER (Default: 100000)
- encryption_mode: ENUM('CBC', 'GCM', 'CTR', 'ECB', 'CFB', 'OFB', 'XTS')
- initialization_vector_length: INTEGER (Default: 16)
- tag_length: INTEGER (Default: 16)
- hash_algorithm: VARCHAR(50) (Default: 'SHA-256')
- compression_enabled: BOOLEAN (Default: TRUE)
- integrity_check_enabled: BOOLEAN (Default: TRUE)
- key_escrow_enabled: BOOLEAN (Default: FALSE)
- key_escrow_method: VARCHAR(50)
- hardware_security_module: BOOLEAN (Default: FALSE)
- cloud_key_management: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_encryption_type (encryption_type)
- INDEX idx_encryption_algorithm (encryption_algorithm)
- INDEX idx_key_rotation_days (key_rotation_days)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_encryption_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_encryption_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_encryption_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_key_length_positive CHECK (encryption_key_length > 0)
- chk_key_rotation_positive CHECK (key_rotation_days > 0)
- chk_salt_length_positive CHECK (salt_length > 0)
- chk_iteration_count_positive CHECK (iteration_count > 0)
- chk_iv_length_positive CHECK (initialization_vector_length > 0)
- chk_tag_length_positive CHECK (tag_length > 0)
```

```
Table: data_protection_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- protection_type: ENUM('Data Masking', 'Anonymization', 'Pseudonymization', 'Tokenization', 'Field Level Encryption', 'Row Level Security')
- data_source: VARCHAR(200) (Required)
- data_source_type: ENUM('Database', 'File System', 'API', 'Application', 'Cloud Storage', 'Data Warehouse')
- protection_rules: JSON (Data protection rules and mappings)
- masking_patterns: JSON (Data masking patterns and algorithms)
- anonymization_method: VARCHAR(100)
- tokenization_format: VARCHAR(50)
- field_level_encryption: JSON (Field-level encryption configuration)
- row_level_security: JSON (Row-level security predicates)
- data_retention_policy: JSON (Data retention and deletion policies)
- access_logging: BOOLEAN (Default: TRUE)
- change_detection: BOOLEAN (Default: TRUE)
- compliance_monitoring: BOOLEAN (Default: TRUE)
- gdpr_compliant: BOOLEAN (Default: TRUE)
- ccpa_compliant: BOOLEAN (Default: TRUE)
- hipaa_compliant: BOOLEAN (Default: FALSE)
- pci_dss_compliant: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_protection_type (protection_type)
- INDEX idx_data_source (data_source)
- INDEX idx_data_source_type (data_source_type)
- INDEX idx_gdpr_compliant (gdpr_compliant)
- INDEX idx_ccpa_compliant (ccpa_compliant)
- INDEX idx_hipaa_compliant (hipaa_compliant)
- INDEX idx_pci_dss_compliant (pci_dss_compliant)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_data_protection_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_data_protection_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_data_protection_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
```

## 12.4.5 Security Monitoring & Threat Detection Schema

```
Table: security_monitoring_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- monitoring_type: ENUM('Real-time Monitoring', 'Log Analysis', 'Behavioral Analysis', 'Anomaly Detection', 'Threat Intelligence', 'Vulnerability Scanning', 'Compliance Monitoring')
- monitoring_source: VARCHAR(200) (Required)
- monitoring_frequency: ENUM('Continuous', 'Every Minute', 'Every 5 Minutes', 'Every 15 Minutes', 'Hourly', 'Daily', 'Weekly')
- alert_thresholds: JSON (Alert thresholds and triggers)
- risk_scoring: JSON (Risk scoring algorithms and weights)
- machine_learning_enabled: BOOLEAN (Default: FALSE)
- ml_model_type: ENUM('Anomaly Detection', 'Behavioral Analysis', 'Threat Classification', 'Risk Prediction')
- notification_channels: JSON (Alert notification channels)
- escalation_rules: JSON (Alert escalation rules)
- false_positive_reduction: JSON (False positive reduction strategies)
- data_sources: JSON (Data sources for monitoring)
- integration_endpoints: JSON (External security system integrations)
- compliance_reporting: BOOLEAN (Default: TRUE)
- audit_trail_required: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_monitoring_type (monitoring_type)
- INDEX idx_monitoring_source (monitoring_source)
- INDEX idx_monitoring_frequency (monitoring_frequency)
- INDEX idx_machine_learning_enabled (machine_learning_enabled)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_security_monitoring_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_monitoring_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_monitoring_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
```

```
Table: security_incident
Fields:
- id: UUID (Primary Key)
- company_id: UUID (UUID (Foreign Key to company)
- incident_id: VARCHAR(100) (Required, Unique, Indexed)
- incident_type: ENUM('Security Breach', 'Unauthorized Access', 'Malware Attack', 'Phishing', 'Data Loss', 'System Compromise', 'Insider Threat', 'Denial of Service', 'Vulnerability Exploit')
- incident_category: ENUM('Critical', 'High', 'Medium', 'Low', 'Informational')
- incident_severity: ENUM('Critical', 'High', 'Medium', 'Low')
- incident_status: ENUM('Open', 'Investigating', 'Contained', 'Resolved', 'Closed', 'False Positive', 'Under Review')
- incident_title: VARCHAR(200) (Required)
- incident_description: TEXT (Required)
- detected_at: TIMESTAMP (Required, Indexed)
- reported_at: TIMESTAMP
- containment_date: TIMESTAMP
- resolution_date: TIMESTAMP
- affected_systems: JSON (Systems and applications affected)
- data_affected: JSON (Data types and volumes affected)
- users_affected: INTEGER (Default: 0)
- financial_impact: DECIMAL(15,2) (Default: 0.00)
- reputational_impact: TEXT
- compliance_impact: TEXT
- root_cause: TEXT
- containment_actions: JSON (Immediate containment actions taken)
- remediation_actions: JSON (Remediation and recovery actions)
- lessons_learned: TEXT
- preventive_measures: JSON (Preventive measures implemented)
- external_reporting_required: BOOLEAN (Default: FALSE)
- regulatory_deadline: DATE
- reported_to_authorities: BOOLEAN (Default: FALSE)
- assigned_to_user_id: UUID (Foreign Key to user)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_security_incident_company_incident (incident_id, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_incident_type (incident_type)
- INDEX idx_incident_category (incident_category)
- INDEX idx_incident_severity (incident_severity)
- INDEX idx_incident_status (incident_status)
- INDEX idx_detected_at (detected_at)
- INDEX idx_reported_at (reported_at)
- INDEX idx_users_affected (users_affected)
- INDEX idx_financial_impact (financial_impact)
- INDEX idx_assigned_to_user_id (assigned_to_user_id)

Constraints:
- fk_security_incident_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_incident_assigned_to FOREIGN KEY (assigned_to_user_id) REFERENCES user(id)
- fk_security_incident_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_users_affected_positive CHECK (users_affected >= 0)
- chk_financial_impact_positive CHECK (financial_impact >= 0)
- chk_incident_order CHECK (detected_at <= reported_at AND containment_date >= detected_at AND resolution_date >= containment_date)
```

## 12.4.6 Network & Device Security Schema

```
Table: network_security_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- security_type: ENUM('Firewall Rules', 'IP Whitelisting', 'Network Segmentation', 'VPN Access', 'DNS Security', 'DDoS Protection', 'Intrusion Detection', 'Network Monitoring')
- network_zone: VARCHAR(100) (Required)
- security_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- ip_ranges: JSON (Allowed IP address ranges and subnets)
- blocked_ips: JSON (Blocked IP addresses and ranges)
- port_restrictions: JSON (Allowed and blocked ports)
- protocol_restrictions: JSON (Allowed network protocols)
- geo_restrictions: JSON (Geographic access restrictions)
- time_restrictions: JSON (Time-based access restrictions)
- bandwidth_limits: JSON (Network bandwidth limitations)
- connection_limits: JSON (Connection count limitations)
- ssl_inspection: BOOLEAN (Default: FALSE)
- deep_packet_inspection: BOOLEAN (Default: FALSE)
- anomaly_detection: BOOLEAN (Default: TRUE)
- threat_intelligence_enabled: BOOLEAN (Default: TRUE)
- logging_enabled: BOOLEAN (Default: TRUE)
- alert_thresholds: JSON (Network security alert thresholds)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_security_type (security_type)
- INDEX idx_network_zone (network_zone)
- INDEX idx_security_level (security_level)
- INDEX idx_ssl_inspection (ssl_inspection)
- INDEX idx_deep_packet_inspection (deep_packet_inspection)
- INDEX idx_anomaly_detection (anomaly_detection)
- INDEX idx_threat_intelligence_enabled (threat_intelligence_enabled)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_network_security_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_network_security_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_network_security_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
```

```
Table: device_security_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- device_type: ENUM('Desktop', 'Laptop', 'Mobile', 'Tablet', 'Server', 'IoT Device', 'Network Device', 'Storage Device')
- device_category: ENUM('Corporate Owned', 'BYOD', 'Guest Device', 'Shared Device', 'Lab Device')
- security_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- device_encryption_required: BOOLEAN (Default: TRUE)
- encryption_algorithm: VARCHAR(50)
- screen_lock_required: BOOLEAN (Default: TRUE)
- screen_lock_timeout_minutes: INTEGER (Default: 5)
- password_complexity_required: BOOLEAN (Default: TRUE)
- biometric_auth_required: BOOLEAN (Default: FALSE)
- device_jailbreak_detection: BOOLEAN (Default: TRUE)
- device_root_detection: BOOLEAN (Default: TRUE)
- usb_restricted: BOOLEAN (Default: FALSE)
- bluetooth_restricted: BOOLEAN (Default: FALSE)
- wifi_restricted: BOOLEAN (Default: FALSE)
- vpn_required: BOOLEAN (Default: FALSE)
- antivirus_required: BOOLEAN (Default: TRUE)
- firewall_required: BOOLEAN (Default: TRUE)
- automatic_updates_required: BOOLEAN (Default: TRUE)
- remote_wipe_enabled: BOOLEAN (Default: TRUE)
- device_compliance_check: BOOLEAN (Default: TRUE)
- compliance_rules: JSON (Device compliance rules and checks)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_device_type (device_type)
- INDEX idx_device_category (device_category)
- INDEX idx_security_level (security_level)
- INDEX idx_device_encryption_required (device_encryption_required)
- INDEX idx_screen_lock_required (screen_lock_required)
- INDEX idx_biometric_auth_required (biometric_auth_required)
- INDEX idx_device_jailbreak_detection (device_jailbreak_detection)
- INDEX idx_device_root_detection (device_root_detection)
- INDEX idx_vpn_required (vpn_required)
- INDEX idx_antivirus_required (antivirus_required)
- INDEX idx_firewall_required (firewall_required)
- INDEX idx_automatic_updates_required (automatic_updates_required)
- INDEX idx_remote_wipe_enabled (remote_wipe_enabled)
- INDEX idx_device_compliance_check (device_compliance_check)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_device_security_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_device_security_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_device_security_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_screen_lock_timeout_positive CHECK (screen_lock_timeout_minutes > 0)
```

## 12.4.7 Security Compliance & Audit Schema

```
Table: security_compliance_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- compliance_framework: ENUM('SOX', 'GDPR', 'HIPAA', 'PCI DSS', 'ISO 27001', 'NIST', 'CIS Controls', 'COBIT', 'Custom')
- compliance_category: ENUM('Access Control', 'Data Protection', 'Incident Response', 'Risk Management', 'Security Awareness', 'Physical Security', 'Network Security', 'Application Security')
- compliance_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- compliance_requirements: JSON (Specific compliance requirements and controls)
- control_objectives: JSON (Control objectives and success criteria)
- testing_procedures: JSON (Compliance testing procedures and methodologies)
- evidence_requirements: JSON (Evidence collection and documentation requirements)
- reporting_frequency: ENUM('Monthly', 'Quarterly', 'Semi-Annual', 'Annual', 'On-demand')
- audit_frequency: ENUM('Monthly', 'Quarterly', 'Semi-Annual', 'Annual', 'Continuous')
- automated_monitoring: BOOLEAN (Default: TRUE)
- real_time_alerts: BOOLEAN (Default: TRUE)
- compliance_score_threshold: DECIMAL(5,2) (Default: 95.00)
- remediation_timeline_days: INTEGER (Default: 30)
- escalation_rules: JSON (Compliance violation escalation rules)
- notification_recipients: JSON (Compliance notification recipients)
- external_auditor_access: BOOLEAN (Default: FALSE)
- audit_trail_required: BOOLEAN (Default: TRUE)
- digital_signatures_required: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_compliance_framework (compliance_framework)
- INDEX idx_compliance_category (compliance_category)
- INDEX idx_compliance_level (compliance_level)
- INDEX idx_reporting_frequency (reporting_frequency)
- INDEX idx_audit_frequency (audit_frequency)
- INDEX idx_automated_monitoring (automated_monitoring)
- INDEX idx_real_time_alerts (real_time_alerts)
- INDEX idx_compliance_score_threshold (compliance_score_threshold)
- INDEX idx_remediation_timeline_days (remediation_timeline_days)
- INDEX idx_external_auditor_access (external_auditor_access)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_security_compliance_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_compliance_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_compliance_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_compliance_score_range CHECK (compliance_score_threshold BETWEEN 0 AND 100)
- chk_remediation_timeline_positive CHECK (remediation_timeline_days > 0)
```

```
Table: security_audit_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- audit_id: VARCHAR(100) (Required, Unique, Indexed)
- audit_type: ENUM('Security Assessment', 'Compliance Audit', 'Vulnerability Scan', 'Penetration Test', 'Configuration Review', 'Access Review', 'Incident Response Test', 'Security Training')
- audit_category: ENUM('Internal', 'External', 'Regulatory', 'Third-party', 'Self-assessment', 'Continuous Monitoring')
- audit_scope: JSON (Audit scope and boundaries)
- audit_methodology: JSON (Audit methodology and procedures)
- audit_status: ENUM('Planned', 'In Progress', 'Completed', 'Passed', 'Failed', 'Requires Action', 'Under Review')
- audit_date: DATE (Required)
- auditor_name: VARCHAR(200)
- auditor_organization: VARCHAR(200)
- audit_findings: JSON (Security findings and observations)
- risk_assessments: JSON (Risk assessment results)
- compliance_score: DECIMAL(5,2) (Default: 0.00)
- security_posture_score: DECIMAL(3,2) (Default: 0.00)
- critical_findings: INTEGER (Default: 0)
- high_findings: INTEGER (Default: 0)
- medium_findings: INTEGER (Default: 0)
- low_findings: INTEGER (Default: 0)
- recommendations: JSON (Security recommendations and improvements)
- action_items: JSON (Required actions and timelines)
- remediation_plan: TEXT
- follow_up_required: BOOLEAN (Default: TRUE)
- follow_up_date: DATE
- audit_report_url: VARCHAR(500)
- evidence_documents: JSON (Links to evidence documents)
- compliance_frameworks: JSON (Applicable compliance frameworks)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_security_audit_log_company_audit (audit_id, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_audit_type (audit_type)
- INDEX idx_audit_category (audit_category)
- INDEX idx_audit_status (audit_status)
- INDEX idx_audit_date (audit_date)
- INDEX idx_compliance_score (compliance_score)
- INDEX idx_security_posture_score (security_posture_score)
- INDEX idx_critical_findings (critical_findings)
- INDEX idx_high_findings (high_findings)
- INDEX idx_medium_findings (medium_findings)
- INDEX idx_low_findings (low_findings)
- INDEX idx_follow_up_required (follow_up_required)
- INDEX idx_follow_up_date (follow_up_date)

Constraints:
- fk_security_audit_log_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_audit_log_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_compliance_score_range CHECK (compliance_score BETWEEN 0 AND 100)
- chk_security_posture_range CHECK (security_posture_score BETWEEN 0 AND 5)
- chk_positive_findings CHECK (critical_findings >= 0 AND high_findings >= 0 AND medium_findings >= 0 AND low_findings >= 0)
- chk_follow_up_future CHECK (follow_up_date IS NULL OR follow_up_date >= audit_date)
```

## 12.4.8 Security Analytics & Reporting Schema

```
Table: security_analytics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- department_id: UUID (Foreign Key to department)
- analysis_type: ENUM('Security Posture', 'Threat Landscape', 'Vulnerability Assessment', 'Compliance Status', 'Risk Analysis', 'Incident Trends', 'User Behavior', 'System Health')
- analysis_period: ENUM('Hourly', 'Daily', 'Weekly', 'Monthly', 'Quarterly', 'Semi-Annual', 'Annual')
- analysis_date: DATE (Required)
- metric_name: VARCHAR(100) (Required)
- metric_value: DECIMAL(15,2) (Required)
- metric_unit: VARCHAR(50)
- benchmark_value: DECIMAL(15,2)
- variance_percentage: DECIMAL (5,2)
- target_value: DECIMAL(15,2)
- achievement_percentage: DECIMAL (5,2)
- security_events_count: INTEGER (Default: 0)
- blocked_threats: INTEGER (Default: 0)
- vulnerabilities_found: INTEGER (Default: 0)
- critical_vulnerabilities: INTEGER (Default: 0)
- compliance_score: DECIMAL (5,2) (Default: 0.00)
- risk_score: DECIMAL (5,2) (Default: 0.00)
- security_posture_score: DECIMAL (3,2) (Default: 0.00)
- threat_intelligence_score: DECIMAL (3,2) (Default: 0.00)
- incident_response_time_minutes: INTEGER (Default: 0)
- mean_time_to_detect_minutes: INTEGER (Default: 0)
- mean_time_to_resolve_minutes: INTEGER (Default: 0)
- false_positive_rate: DECIMAL (5,2) (Default: 0.00)
- user_security_awareness_score: DECIMAL (3,2) (Default: 0.00)
- system_availability_percentage: DECIMAL (5,2) (Default: 99.99)
- additional_metrics: JSON (Other security KPIs and breakdowns)
- data_quality_score: DECIMAL (3,2) (Default: 5.00)
- calculated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_analysis_type (analysis_type)
- INDEX idx_analysis_period (analysis_period)
- INDEX idx_analysis_date (analysis_date)
- INDEX idx_metric_name (metric_name)
- idx_security_events_count (security_events_count)
- idx_blocked_threats (blocked_threats)
- idx_vulnerabilities_found (vulnerabilities_found)
- idx_critical_vulnerabilities (critical_vulnerabilities)
- idx_compliance_score (compliance_score)
- idx_risk_score (risk_score)
- idx_security_posture_score (security_posture_score)
- idx_threat_intelligence_score (threat_intelligence_score)
- idx_incident_response_time_minutes (incident_response_time_minutes)
- idx_mean_time_to_detect_minutes (mean_time_to_detect_minutes)
- idx_mean_time_to_resolve_minutes (mean_time_to_resolve_minutes)
- idx_false_positive_rate (false_positive_rate)
- idx_user_security_awareness_score (user_security_awareness_score)
- idx_system_availability_percentage (system_availability_percentage)

Constraints:
- fk_security_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_analytics_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_security_analytics_calculated_by FOREIGN KEY (calculated_by_user_id) REFERENCES user(id)
- chk_positive_events CHECK (security_events_count >= 0 AND blocked_threats >= 0 AND vulnerabilities_found >= 0 AND critical_vulnerabilities >= 0)
- chk_response_times_positive CHECK (incident_response_time_minutes >= 0 AND mean_time_to_detect_minutes >= 0 AND mean_time_to_resolve_minutes >= 0)
- chk_achievement_range CHECK (achievement_percentage BETWEEN 0 AND 100)
- chk_compliance_range CHECK (compliance_score BETWEEN 0 AND 100)
- chk_risk_range CHECK (risk_score BETWEEN 0 AND 100)
- chk_posture_range CHECK (security_posture_score BETWEEN 0 AND 5)
- chk_threat_intel_range CHECK (threat_intelligence_score BETWEEN 0 AND 5)
- chk_false_positive_range CHECK (false_positive_rate BETWEEN 0 AND 100)
- chk_awareness_range CHECK (user_security_awareness_score BETWEEN 0 AND 5)
- chk_availability_range CHECK (system_availability_percentage BETWEEN 0 AND 100)
- chk_data_quality_range CHECK (data_quality_score BETWEEN 1 AND 5)
```

```
Table: security_dashboard
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- dashboard_code: VARCHAR(50) (Required, Unique, Indexed)
- dashboard_name: VARCHAR(200) (Required)
- dashboard_type: ENUM('Executive', 'Security Operations', 'Compliance', 'Risk Management', 'Incident Response', 'Threat Intelligence', 'Vulnerability Management', 'Security Awareness')
- dashboard_category: ENUM('Real-time Monitoring', 'Security Analytics', 'Compliance Tracking', 'Risk Assessment', 'Incident Management', 'Threat Detection', 'Performance Metrics', 'Trend Analysis')
- dashboard_description: TEXT (Required)
- layout_config: JSON (Dashboard layout and widget configuration)
- data_sources: JSON (Data sources for the dashboard)
- refresh_frequency: ENUM('Real-time', 'Every 5 Minutes', 'Every 15 Minutes', 'Hourly', 'Daily', 'Weekly')
- access_permissions: JSON (User access permissions and restrictions)
- widget_configurations: JSON (Widget configurations and settings)
- filter_options: JSON (Available filters and parameters)
- export_options: JSON (Export formats and options)
- sharing_settings: JSON (Dashboard sharing and collaboration settings)
- alert_configurations: JSON (Alert rules and notifications)
- drill_down_capabilities: JSON (Drill-down options and linked reports)
- security_level: ENUM('Public', 'Internal', 'Confidential', 'Restricted', 'Highly Restricted')
- is_public: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- last_refreshed_at: TIMESTAMP
- refresh_status: ENUM('Success', 'Error', 'In Progress', 'Disabled', 'Scheduled')
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_security_dashboard_company_code (dashboard_code, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_dashboard_type (dashboard_type)
- INDEX idx_dashboard_category (dashboard_category)
- INDEX idx_security_level (security_level)
- idx_is_public (is_public)
- idx_is_active (is_active)
- INDEX idx_last_refreshed_at (last_refreshed_at)
- INDEX idx_refresh_status (refresh_status)

Constraints:
- fk_security_dashboard_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_dashboard_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
```

## 12.4.9 Security Training & Awareness Schema

```
Table: security_training_program
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- program_name: VARCHAR(200) (Required)
- program_type: ENUM('Security Awareness', 'Phishing Prevention', 'Data Protection', 'Password Security', 'Social Engineering', 'Incident Response', 'Compliance Training', 'Custom')
- program_category: ENUM('Mandatory', 'Recommended', 'Role-based', 'Department-specific', 'Executive', 'IT Staff', 'All Employees')
- program_description: TEXT (Required)
- training_objectives: JSON (Learning objectives and outcomes)
- target_audience: JSON (Target audience and user roles)
- training_materials: JSON (Training content and materials)
- delivery_method: ENUM('Online', 'Classroom', 'Webinar', 'Video', 'Interactive', 'Blended', 'Self-paced')
- duration_hours: DECIMAL(5,2) (Required)
- difficulty_level: ENUM('Beginner', 'Intermediate', 'Advanced', 'Expert')
- assessment_required: BOOLEAN (Default: TRUE)
- passing_score_percentage: DECIMAL (5,2) (Default: 80.00)
- certificate_issued: BOOLEAN (Default: TRUE)
- certificate_template: VARCHAR(200)
- recertification_frequency_months: INTEGER (Default: 12)
- compliance_frameworks: JSON (Applicable compliance frameworks)
- tracking_enabled: BOOLEAN (Default: TRUE)
- reminder_schedules: JSON (Training reminder schedules)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_program_type (program_type)
- INDEX idx_program_category (program_category)
- INDEX idx_delivery_method (delivery_method)
- INDEX idx_difficulty_level (difficulty_level)
- INDEX idx_assessment_required (assessment_required)
- INDEX idx_certificate_issued (certificate_issued)
- INDEX idx_recertification_frequency_months (recertification_frequency_months)
- INDEX idx_tracking_enabled (tracking_enabled)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_security_training_program_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_training_program_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_training_program_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_duration_positive CHECK (duration_hours > 0)
- chk_passing_score_range CHECK (passing_score_percentage BETWEEN 0 AND 100)
- chk_recertification_positive CHECK (recertification_frequency_months > 0)
```

```
Table: security_training_record
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- training_program_id: UUID (Foreign Key to security_training_program)
- user_id: UUID (Foreign Key to user)
- employee_id: UUID (Foreign Key to employee)
- enrollment_date: DATE (Required)
- start_date: DATE
- completion_date: DATE
- status: ENUM('Enrolled', 'In Progress', 'Completed', 'Failed', 'Expired', 'Cancelled', 'On Hold')
- completion_percentage: DECIMAL (5,2) (Default: 0.00)
- assessment_score: DECIMAL (5,2)
- max_attempts: INTEGER (Default: 3)
- attempts_used: INTEGER (Default: 0)
- time_spent_minutes: INTEGER (Default: 0)
- modules_completed: INTEGER (Default: 0)
- total_modules: INTEGER (Default: 0)
- certificate_issued: BOOLEAN (Default: FALSE)
- certificate_url: VARCHAR(500)
- certificate_expiry_date: DATE
- feedback_rating: INTEGER (Check: feedback_rating BETWEEN 1 AND 5)
- feedback_comments: TEXT
- training_path: JSON (Training progress and path taken)
- knowledge_assessment: JSON (Pre and post training assessment results)
- skill_improvement: JSON (Skill improvement metrics)
- compliance_met: BOOLEAN (Default: FALSE)
- reminder_sent_count: INTEGER (Default: 0)
- last_reminder_date: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_training_program_id (training_program_id)
- INDEX idx_user_id (user_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_enrollment_date (enrollment_date)
- INDEX idx_start_date (start_date)
- INDEX idx_completion_date (completion_date)
- INDEX idx_status (status)
- INDEX idx_completion_percentage (completion_percentage)
- INDEX idx_assessment_score (assessment_score)
- INDEX idx_certificate_issued (certificate_issued)
- INDEX idx_certificate_expiry_date (certificate_expiry_date)
- INDEX idx_compliance_met (compliance_met)
- INDEX idx_last_reminder_date (last_reminder_date)

Constraints:
- fk_security_training_record_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_training_record_program FOREIGN KEY (training_program_id) REFERENCES security_training_program(id)
- fk_security_training_record_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_security_training_record_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_security_training_record_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_completion_percentage_range CHECK (completion_percentage BETWEEN 0 AND 100)
- chk_assessment_score_range CHECK (assessment_score IS NULL OR assessment_score BETWEEN 0 AND 100)
- chk_attempts_valid CHECK (attempts_used >= 0 AND attempts_used <= max_attempts)
- chk_time_spent_positive CHECK (time_spent_minutes >= 0)
- chk_modules_valid CHECK (modules_completed >= 0 AND modules_completed <= total_modules)
- chk_reminder_count_positive CHECK (reminder_sent_count >= 0)
```

## 12.4.10 Security Integration & API Management Schema

```
Table: security_integration_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- integration_name: VARCHAR(200) (Required)
- integration_type: ENUM('SIEM', 'SOAR', 'Threat Intelligence', 'Vulnerability Management', 'Identity Provider', 'Certificate Authority', 'Security Analytics', 'Compliance Platform')
- integration_category: ENUM('Security Monitoring', 'Threat Detection', 'Incident Response', 'Identity Management', 'Compliance Management', 'Risk Assessment', 'Security Analytics')
- external_system: VARCHAR(100) (Required)
- external_system_id: VARCHAR(200) (Required)
- integration_description: TEXT
- endpoint_url: VARCHAR(500)
- authentication_method: ENUM('API Key', 'OAuth 2.0', 'Basic Auth', 'Certificate', 'SAML', 'JWT', 'mTLS', 'Syslog', 'LEEF')
- authentication_config: JSON (Encrypted authentication credentials)
- data_mapping: JSON (Field mapping between systems)
- sync_frequency: ENUM('Real-time', 'Near Real-time', 'Hourly', 'Daily', 'Weekly', 'On-demand')
- sync_direction: ENUM('Bidirectional', 'Inbound', 'Outbound')
- data_format: ENUM('JSON', 'XML', 'CSV', 'CEF', 'LEEF', 'Syslog', 'STIX', 'TAXII')
- encryption_enabled: BOOLEAN (Default: TRUE)
- compression_enabled: BOOLEAN (Default: TRUE)
- batch_size: INTEGER (Default: 1000)
- retry_count: INTEGER (Default: 0)
- max_retries: INTEGER (Default: 3)
- performance_metrics: JSON (Sync performance and statistics)
- error_handling: JSON (Error handling and recovery logic)
- security_controls: JSON (Security-specific controls and validations)
- compliance_requirements: JSON (Regulatory compliance requirements)
- is_active: BOOLEAN (Default: TRUE)
- last_sync_at: TIMESTAMP
- next_sync_at: TIMESTAMP
- sync_status: ENUM('Active', 'Inactive', 'Error', 'Paused', 'Maintenance', 'Testing')
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_integration_type (integration_type)
- INDEX idx_integration_category (integration_category)
- INDEX idx_external_system (external_system)
- INDEX idx_sync_status (sync_status)
- INDEX idx_last_sync_at (last_sync_at)
- INDEX idx_is_active (is_active)

Constraints:
- fk_security_integration_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_integration_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retry_count_valid CHECK (retry_count >= 0 AND retry_count <= max_retries)
- chk_batch_size_positive CHECK (batch_size > 0)
```

```
Table: security_api_management
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- api_name: VARCHAR(200) (Required)
- api_type: ENUM('Security Monitoring', 'Threat Intelligence', 'Incident Management', 'Vulnerability Assessment', 'Compliance Check', 'User Authentication', 'Data Protection', 'Audit Trail')
- api_category: ENUM('Internal', 'External', 'Partner', 'Third-party', 'Public', 'Restricted', 'Classified')
- api_description: TEXT
- api_version: VARCHAR(20) (Default: 'v1')
- endpoint_url: VARCHAR(500) (Required)
- authentication_type: ENUM('API Key', 'OAuth 2.0', 'JWT', 'Basic Auth', 'mTLS', 'SAML', 'Certificate')
- rate_limit_per_minute: INTEGER (Default: 1000)
- rate_limit_per_hour: INTEGER (Default: 10000)
- allowed_methods: JSON (HTTP methods allowed)
- allowed_ips: JSON (IP whitelist)
- data_access_level: ENUM('ALL', 'AGGREGATED_ONLY', 'SUMMARY_ONLY', 'METADATA_ONLY', 'ANONYMIZED_ONLY')
- security_controls: JSON (API security controls and validations)
- data_masking: BOOLEAN (Default: TRUE)
- audit_logging: BOOLEAN (Default: TRUE)
- encryption_required: BOOLEAN (Default: TRUE)
- compliance_frameworks: JSON (Compliance frameworks supported)
- sox_compliant: BOOLEAN (Default: TRUE)
- gdpr_compliant: BOOLEAN (Default: TRUE)
- hipaa_compliant: BOOLEAN (Default: FALSE)
- pci_dss_compliant: BOOLEAN (Default: FALSE)
- is_internal: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- last_used_at: TIMESTAMP
- usage_count: INTEGER (Default: 0)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_api_type (api_type)
- INDEX idx_api_category (api_category)
- INDEX idx_is_active (is_active)
- INDEX idx_is_internal (is_internal)
- INDEX idx_last_used_at (last_used_at)
- INDEX idx_usage_count (usage_count)
- INDEX idx_data_access_level (data_access_level)
- INDEX idx_sox_compliant (sox_compliant)
- INDEX idx_gdpr_compliant (gdpr_compliant)
- INDEX idx_hipaa_compliant (hipaa_compliant)
- INDEX idx_pci_dss_compliant (pci_dss_compliant)

Constraints:
- fk_security_api_management_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_api_management_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_rate_limits_positive CHECK (rate_limit_per_minute > 0 AND rate_limit_per_hour > 0)
- chk_usage_positive CHECK (usage_count >= 0)
```

## 12.4.11 Security Mobile & Remote Access Schema

```
Table: security_mobile_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- app_version: VARCHAR(20) (Required)
- platform: ENUM('iOS', 'Android', 'Web', 'Hybrid')
- build_number: VARCHAR(20) (Required)
- release_date: DATE (Required)
- is_current: BOOLEAN (Default: FALSE)
- is_mandatory: BOOLEAN (Default: FALSE)
- min_supported_version: VARCHAR(20)
- security_features: JSON (Mobile security features and capabilities)
- biometric_auth_required: BOOLEAN (Default: TRUE)
- device_encryption_required: BOOLEAN (Default: TRUE)
- jailbreak_detection: BOOLEAN (Default: TRUE)
- root_detection: BOOLEAN (Default: TRUE)
- certificate_pinning: BOOLEAN (Default: TRUE)
- secure_communication: BOOLEAN (Default: TRUE)
- offline_data_encryption: BOOLEAN (Default: TRUE)
- remote_wipe_capability: BOOLEAN (Default: TRUE)
- geofencing_enabled: BOOLEAN (Default: FALSE)
- geofencing_rules: JSON (Geographic access restrictions)
- time_based_access: BOOLEAN (Default: FALSE)
- time_restrictions: JSON (Time-based access rules)
- device_compliance_check: BOOLEAN (Default: TRUE)
- compliance_rules: JSON (Device compliance requirements)
- api_rate_limit_per_minute: INTEGER (Default: 100)
- max_concurrent_requests: INTEGER (Default: 10)
- session_timeout_minutes: INTEGER (Default: 30)
- auto_logout_enabled: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_app_version (app_version)
- INDEX idx_platform (platform)
- INDEX idx_is_current (is_current)
- INDEX idx_is_mandatory (is_mandatory)
- INDEX idx_biometric_auth_required (biometric_auth_required)
- INDEX idx_device_encryption_required (device_encryption_required)
- INDEX idx_jailbreak_detection (jailbreak_detection)
- INDEX idx_root_detection (root_detection)
- INDEX idx_certificate_pinning (certificate_pinning)
- INDEX idx_secure_communication (secure_communication)
- INDEX idx_offline_data_encryption (offline_data_encryption)
- INDEX idx_remote_wipe_capability (remote_wipe_capability)
- INDEX idx_geofencing_enabled (geofencing_enabled)
- INDEX idx_time_based_access (time_based_access)
- INDEX idx_device_compliance_check (device_compliance_check)
- INDEX idx_auto_logout_enabled (auto_logout_enabled)

Constraints:
- fk_security_mobile_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_mobile_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_rate_limit_positive CHECK (api_rate_limit_per_minute > 0)
- chk_concurrent_requests_positive CHECK (max_concurrent_requests > 0)
- chk_session_timeout_positive CHECK (session_timeout_minutes > 0)
```

```
Table: security_remote_access
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- access_type: ENUM('VPN', 'Remote Desktop', 'Web Access', 'Mobile Access', 'API Access', 'SSH Access', 'File Transfer')
- access_method: ENUM('Corporate VPN', 'Personal VPN', 'Direct Connection', 'Proxy', 'Gateway', 'Load Balancer')
- security_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- authentication_required: BOOLEAN (Default: TRUE)
- multi_factor_required: BOOLEAN (Default: TRUE)
- device_registration_required: BOOLEAN (Default: TRUE)
- ip_whitelist_enabled: BOOLEAN (Default: TRUE)
- allowed_ips: JSON (Whitelisted IP addresses)
- geo_restrictions_enabled: BOOLEAN (Default: FALSE)
- geo_restrictions: JSON (Geographic access restrictions)
- time_restrictions_enabled: BOOLEAN (Default: FALSE)
- time_restrictions: JSON (Time-based access restrictions)
- encryption_required: BOOLEAN (Default: TRUE)
- encryption_protocol: VARCHAR(50) (Default: 'TLS 1.3')
- session_logging: BOOLEAN (Default: TRUE)
- activity_monitoring: BOOLEAN (Default: TRUE)
- bandwidth_limits: JSON (Bandwidth limitations)
- connection_limits: JSON (Connection count limitations)
- data_access_restrictions: JSON (Data access level restrictions)
- compliance_monitoring: BOOLEAN (Default: TRUE)
- audit_trail_required: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_access_type (access_type)
- INDEX idx_access_method (access_method)
- INDEX idx_security_level (security_level)
- INDEX idx_authentication_required (authentication_required)
- INDEX idx_multi_factor_required (multi_factor_required)
- INDEX idx_device_registration_required (device_registration_required)
- INDEX idx_ip_whitelist_enabled (ip_whitelist_enabled)
- INDEX idx_geo_restrictions_enabled (geo_restrictions_enabled)
- INDEX idx_time_restrictions_enabled (time_restrictions_enabled)
- INDEX idx_encryption_required (encryption_required)
- INDEX idx_session_logging (session_logging)
- INDEX idx_activity_monitoring (activity_monitoring)
- INDEX idx_compliance_monitoring (compliance_monitoring)
- INDEX idx_audit_trail_required (audit_trail_required)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_security_remote_access_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_remote_access_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_remote_access_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
```

## 12.4.12 Security User Preferences & Personalization Schema

```
Table: security_user_preference
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- user_id: UUID (Foreign Key to user)
- preference_category: ENUM('Security Settings', 'Notification Preferences', 'Alert Configuration', 'Access Control', 'Privacy Settings', 'Device Management', 'Training Preferences', 'Compliance Settings')
- preference_key: VARCHAR(100) (Required)
- preference_value: JSON (Preference value and configuration)
- preference_type: ENUM('Boolean', 'String', 'Number', 'Array', 'Object', 'Date', 'Time')
- is_system_default: BOOLEAN (Default: FALSE)
- is_user_editable: BOOLEAN (Default: TRUE)
- validation_rules: JSON (Validation rules for the preference)
- default_value: JSON (Default system value)
- description: TEXT (Description of the preference)
- help_text: TEXT (Help text for the preference)
- display_order: INTEGER (Default: 0)
- is_active: BOOLEAN (Default: TRUE)
- security_impact: ENUM('Low', 'Medium', 'High', 'Critical')
- compliance_relevance: BOOLEAN (Default: FALSE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_preference_category (preference_category)
- INDEX idx_preference_key (preference_key)
- INDEX idx_is_system_default (is_system_default)
- INDEX idx_is_user_editable (is_user_editable)
- INDEX idx_display_order (display_order)
- INDEX idx_is_active (is_active)
- INDEX idx_security_impact (security_impact)
- INDEX idx_compliance_relevance (compliance_relevance)

Constraints:
- fk_security_user_preference_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_user_preference_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_security_user_preference_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_display_order_positive CHECK (display_order >= 0)
```

```
Table: security_user_profile
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- user_id: UUID (Foreign Key to user)
- default_security_view: ENUM('Executive Summary', 'Security Overview', 'Compliance Status', 'Threat Intelligence', 'Incident Management', 'Risk Assessment', 'Custom')
- preferred_alert_level: ENUM('All', 'Critical Only', 'High and Critical', 'Medium and Above', 'Low and Above')
- notification_preferences: JSON (User security notification settings)
- alert_preferences: JSON (User security alert configuration)
- mfa_preferences: JSON (Multi-factor authentication preferences)
- device_preferences: JSON (Device security preferences)
- access_preferences: JSON (Access control preferences)
- privacy_settings: JSON (User privacy and data sharing preferences)
- training_preferences: JSON (Security training preferences)
- compliance_settings: JSON (User compliance settings)
- language_preference: VARCHAR(10) (Default: 'en')
- timezone_preference: VARCHAR(50) (Default: 'UTC')
- date_format_preference: VARCHAR(20) (Default: 'YYYY-MM-DD')
- time_format_preference: ENUM('12-hour', '24-hour') (Default: '24-hour')
- accessibility_settings: JSON (Accessibility and display accommodations)
- security_questions: JSON (Security questions and answers)
- emergency_contact: JSON (Emergency contact information)
- last_security_review: DATE
- next_security_review: DATE
- security_score: DECIMAL (3,2) (Default: 0.00)
- risk_level: ENUM('Low', 'Medium', 'High', 'Critical')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_default_security_view (default_security_view)
- INDEX idx_preferred_alert_level (preferred_alert_level)
- INDEX idx_language_preference (language_preference)
- INDEX idx_timezone_preference (timezone_preference)
- INDEX idx_last_security_review (last_security_review)
- INDEX idx_next_security_review (next_security_review)
- INDEX idx_security_score (security_score)
- INDEX idx_risk_level (risk_level)

Constraints:
- fk_security_user_profile_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_user_profile_user FOREIGN KEY (user_id) REFERENCES user(id)
- chk_security_score_range CHECK (security_score BETWEEN 0 AND 5)
- chk_review_order CHECK (next_security_review >= last_security_review)
```

## 12.4.13 Security Workflow & Automation Schema

```
Table: security_workflow_definition
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- workflow_name: VARCHAR(200) (Required)
- workflow_type: ENUM('Incident Response', 'Threat Detection', 'Vulnerability Management', 'Access Request', 'Compliance Check', 'Security Review', 'Risk Assessment', 'Alert Response')
- workflow_category: ENUM('Standard', 'Emergency', 'High Value', 'Executive', 'Bulk Processing', 'Scheduled', 'Manual Trigger', 'Automated')
- trigger_event: ENUM('Security Event', 'Threat Detected', 'Vulnerability Found', 'Access Request', 'Compliance Violation', 'System Event', 'Schedule Triggered', 'Manual Start')
- workflow_steps: JSON (Ordered workflow steps and configurations)
- approval_levels: JSON (Multi-level approval requirements)
- escalation_rules: JSON (Escalation conditions and paths)
- timeout_settings: JSON (Step timeout and reminder settings)
- notification_rules: JSON (Notification triggers and recipients)
- retry_configuration: JSON (Retry logic and limits)
- performance_metrics: JSON (Workflow performance tracking)
- compliance_requirements: JSON (Regulatory compliance requirements)
- security_controls: JSON (Security-specific controls and validations)
- audit_requirements: JSON (Audit trail and documentation requirements)
- automation_level: ENUM('Manual', 'Semi-automated', 'Fully Automated', 'Intelligent Automation')
- ml_integration: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- version: INTEGER (Default: 1)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_workflow_type (workflow_type)
- INDEX idx_workflow_category (workflow_category)
- INDEX idx_trigger_event (trigger_event)
- INDEX idx_automation_level (automation_level)
- INDEX idx_ml_integration (ml_integration)
- INDEX idx_is_active (is_active)
- INDEX idx_version (version)

Constraints:
- fk_security_workflow_definition_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_workflow_definition_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_security_workflow_definition_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_version_positive CHECK (version > 0)
```

```
Table: security_workflow_instance
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- workflow_definition_id: UUID (Foreign Key to security_workflow_definition)
- user_id: UUID (Foreign Key to user)
- employee_id: UUID (Foreign Key to employee)
- instance_name: VARCHAR(200) (Required)
- current_step: INTEGER (Default: 1)
- workflow_status: ENUM('Initiated', 'In Progress', 'Pending Approval', 'Approved', 'Rejected', 'Completed', 'Cancelled', 'Escalated', 'Failed', 'On Hold')
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- initiated_by_user_id: UUID (Foreign Key to user)
- current_assignee_id: UUID (Foreign Key to user)
- started_at: TIMESTAMP (Auto)
- due_date: TIMESTAMP
- completion_date: TIMESTAMP
- workflow_data: JSON (Workflow-specific data and context)
- step_history: JSON (History of completed steps)
- error_log: TEXT
- retry_count: INTEGER (Default: 0)
- performance_metrics: JSON (Instance performance data)
- compliance_tracking: JSON (Compliance requirement tracking)
- security_assessment: JSON (Security assessment data)
- audit_evidence: JSON (Audit evidence and documentation)
- automation_decisions: JSON (Automation decisions and reasoning)
- ml_insights: JSON (Machine learning insights and predictions)
- comments: TEXT
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_workflow_definition_id (workflow_definition_id)
- INDEX idx_user_id (user_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_workflow_status (workflow_status)
- INDEX idx_priority_level (priority_level)
- INDEX idx_initiated_by_user_id (initiated_by_user_id)
- INDEX idx_current_assignee_id (current_assignee_id)
- INDEX idx_started_at (started_at)
- INDEX idx_due_date (due_date)

Constraints:
- fk_security_workflow_instance_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_security_workflow_instance_definition FOREIGN KEY (workflow_definition_id) REFERENCES security_workflow_definition(id)
- fk_security_workflow_instance_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_security_workflow_instance_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_security_workflow_instance_initiated_by FOREIGN KEY (initiated_by_user_id) REFERENCES user(id)
- fk_security_workflow_instance_current_assignee FOREIGN KEY (current_assignee_id) REFERENCES user(id)
- chk_step_positive CHECK (current_step > 0)
- chk_retry_positive CHECK (retry_count >= 0)
```

--- END OF SECTION 12.4.13 ---
