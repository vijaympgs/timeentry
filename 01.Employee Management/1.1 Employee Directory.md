# 1 Employee Management â€“ Business Blueprint (BBP with Detailed Schema)

## Business Purpose

The Employee Management module serves as the authoritative enterprise master for managing all employee-related data, organizational structure, lifecycle events, and employee-facing services. It provides a single source of truth for workforce information and acts as a parent dependency for Payroll, Attendance, IAM, POS authorization, and approval workflows. This module establishes the foundation for all HR operations and ensures data consistency across the enterprise HR ecosystem.

## Business Scope

### In Scope
- Employee master data management with comprehensive personal and professional information
- Organizational hierarchy and reporting structure management
- Employee self-service capabilities for personal information updates
- Document management with version control and compliance tracking
- Employee lifecycle management from hire to retire
- Multi-location and multi-company support
- Role-based access control and audit trails
- Integration readiness for downstream HR systems

### Out of Scope
- Payroll calculations and processing
- Time & attendance computation
- Recruitment and applicant tracking
- Performance management and reviews
- Learning and development management
- Benefits administration
- Compensation planning

## Canonical Domain Mapping

- Domain: HRM
- Aggregate Root: Employee
- Ownership: Company (Enterprise-level)
- Scope: Shared master across Payroll, Attendance, IAM, POS, Finance modules
- Data Classification: PII - Highly Sensitive
- Retention Policy: 7 years post-employment + legal requirements
- Compliance: GDPR, CCPA, SOX, Labor Laws

## Core Business Entities & Detailed Schema

### Employee (Aggregate Root)

```
Table: employee
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- employee_code: VARCHAR(20) (Unique, Indexed)
- employee_number: VARCHAR(30) (Unique, Indexed)
- title: ENUM('Mr', 'Mrs', 'Ms', 'Dr', 'Prof')
- first_name: VARCHAR(100) (Required)
- middle_name: VARCHAR(100)
- last_name: VARCHAR(100) (Required)
- display_name: VARCHAR(200) (Computed)
- preferred_name: VARCHAR(100)
- gender: ENUM('Male', 'Female', 'Other', 'Prefer not to say')
- date_of_birth: DATE (Required)
- place_of_birth: VARCHAR(200)
- nationality: VARCHAR(100)
- marital_status: ENUM('Single', 'Married', 'Divorced', 'Widowed', 'Separated')
- blood_group: ENUM('A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-')
- physically_challenged: BOOLEAN (Default: FALSE)
- employment_type: ENUM('Permanent', 'Contract', 'Intern', 'Consultant', 'Temporary')
- employment_status: ENUM('Onboarding', 'Active', 'On Leave', 'Suspended', 'Resigned', 'Terminated', 'Retired')
- employment_category: ENUM('Staff', 'Worker', 'Executive', 'Management')
- hire_date: DATE (Required)
- confirmation_date: DATE
- probation_end_date: DATE
- exit_date: DATE
- exit_reason: VARCHAR(200)
- exit_type: ENUM('Resignation', 'Termination', 'Retirement', 'Contract End', 'Death')
- department_id: UUID (Foreign Key to department)
- position_id: UUID (Foreign Key to position)
- grade_id: UUID (Foreign Key to grade)
- manager_id: UUID (Self-reference to employee.id)
- primary_location_id: UUID (Foreign Key to location)
- work_email: VARCHAR(200) (Unique, Indexed)
- personal_email: VARCHAR(200)
- work_phone: VARCHAR(50)
- mobile_phone: VARCHAR(50) (Required)
- emergency_contact_name: VARCHAR(200)
- emergency_contact_phone: VARCHAR(50)
- emergency_contact_relation: VARCHAR(100)
- work_address_id: UUID (Foreign Key to address)
- home_address_id: UUID (Foreign Key to address)
- bank_account_number: VARCHAR(50) (Encrypted)
- bank_name: VARCHAR(200)
- bank_branch: VARCHAR(200)
- bank_ifsc_code: VARCHAR(20)
- pan_number: VARCHAR(20) (Encrypted)
- aadhaar_number: VARCHAR(20) (Encrypted)
- passport_number: VARCHAR(50) (Encrypted)
- passport_expiry_date: DATE
- visa_type: VARCHAR(100)
- visa_expiry_date: DATE
- work_permit_number: VARCHAR(100)
- work_permit_expiry_date: DATE
- social_security_number: VARCHAR(50) (Encrypted)
- tax_id: VARCHAR(50) (Encrypted)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)
- deleted_at: TIMESTAMP (Soft Delete)
- version: INTEGER (Default: 1, Optimistic Locking)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_employee_company_code (company_id, employee_code)
- UNIQUE KEY uk_employee_company_number (company_id, employee_number)
- UNIQUE KEY uk_work_email (work_email)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_manager_id (manager_id)
- INDEX idx_employment_status (employment_status)
- INDEX idx_employment_type (employment_type)
- INDEX idx_active_employees (company_id, employment_status) WHERE employment_status = 'Active'

Constraints:
- fk_employee_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_employee_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_employee_position FOREIGN KEY (position_id) REFERENCES position(id)
- fk_employee_grade FOREIGN KEY (grade_id) REFERENCES grade(id)
- fk_employee_manager FOREIGN KEY (manager_id) REFERENCES employee(id)
- fk_employee_location FOREIGN KEY (primary_location_id) REFERENCES location(id)
- fk_employee_work_address FOREIGN KEY (work_address_id) REFERENCES address(id)
- fk_employee_home_address FOREIGN KEY (home_address_id) REFERENCES address(id)
- fk_employee_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_employee_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_no_circular_reporting CHECK (manager_id != id)
- chk_hire_before_exit CHECK (hire_date <= exit_date OR exit_date IS NULL)
- chk_confirmation_after_hire CHECK (confirmation_date >= hire_date OR confirmation_date IS NULL)
```

### Department

```
Table: department
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- department_code: VARCHAR(20) (Required, Indexed)
- department_name: VARCHAR(200) (Required)
- parent_department_id: UUID (Self-reference to department.id)
- department_head_id: UUID (Foreign Key to employee.id)
- cost_center_code: VARCHAR(50)
- business_unit: VARCHAR(100)
- division: VARCHAR(100)
- is_active: BOOLEAN (Default: TRUE)
- description: TEXT
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)
- deleted_at: TIMESTAMP (Soft Delete)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_department_company_code (company_id, department_code)
- INDEX idx_company_id (company_id)
- INDEX idx_parent_department_id (parent_department_id)
- INDEX idx_department_head_id (department_head_id)
- INDEX idx_active_departments (company_id, is_active) WHERE is_active = TRUE

Constraints:
- fk_department_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_department_parent FOREIGN KEY (parent_department_id) REFERENCES department(id)
- fk_department_head FOREIGN KEY (department_head_id) REFERENCES employee(id)
- chk_no_self_parent CHECK (parent_department_id != id)
```

### Position

```
Table: position
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- position_code: VARCHAR(20) (Required, Indexed)
- position_title: VARCHAR(200) (Required)
- position_level: INTEGER (Required)
- job_family: VARCHAR(100)
- job_category: VARCHAR(100)
- is_managerial: BOOLEAN (Default: FALSE)
- is_executive: BOOLEAN (Default: FALSE)
- min_salary: DECIMAL(15,2)
- max_salary: DECIMAL(15,2)
- currency_code: VARCHAR(10) (Default: 'USD')
- job_description: TEXT
- requirements: TEXT
- responsibilities: TEXT
- skills_required: TEXT
- reporting_to_position_id: UUID (Self-reference to position.id)
- department_id: UUID (Foreign Key to department)
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)
- deleted_at: TIMESTAMP (Soft Delete)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_position_company_code (company_id, position_code)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_position_level (position_level)
- INDEX idx_job_family (job_family)
- INDEX idx_active_positions (company_id, is_active) WHERE is_active = TRUE

Constraints:
- fk_position_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_position_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_position_reports_to FOREIGN KEY (reporting_to_position_id) REFERENCES position(id)
- chk_salary_range CHECK (max_salary >= min_salary)
```

### EmployeeLocation

```
Table: employee_location
Fields:
- id: UUID (Primary Key)
- employee_id: UUID (Foreign Key to employee)
- location_id: UUID (Foreign Key to location)
- is_primary: BOOLEAN (Default: FALSE)
- effective_from: DATE (Required)
- effective_to: DATE
- assignment_type: ENUM('Permanent', 'Temporary', 'Project', 'Training')
- reporting_manager_id: UUID (Foreign Key to employee.id)
- cost_center_code: VARCHAR(50)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_employee_location_effective (employee_id, location_id, effective_from)
- INDEX idx_employee_id (employee_id)
- INDEX idx_location_id (location_id)
- INDEX idx_effective_date_range (effective_from, effective_to)
- INDEX idx_primary_location (employee_id, is_primary) WHERE is_primary = TRUE

Constraints:
- fk_employee_location_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_employee_location_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_employee_location_manager FOREIGN KEY (reporting_manager_id) REFERENCES employee(id)
- chk_date_range CHECK (effective_to IS NULL OR effective_to >= effective_from)
- chk_single_primary_location CHECK (
  is_primary = FALSE OR 
  (SELECT COUNT(*) FROM employee_location el2 
   WHERE el2.employee_id = employee_location.employee_id 
   AND el2.is_primary = TRUE 
   AND el2.id != employee_location.id) = 0
)
```

## 1.1 Employee Directory

### 1.1.1 Business Purpose

The Employee Directory provides a searchable, filterable, and role-based view of all employee information within the organization. It serves as the primary interface for locating colleagues, understanding organizational structure, and accessing basic employee information while maintaining appropriate data security and privacy controls.

### 1.1.2 Business Scope

Enable employees and managers to quickly locate and contact colleagues, understand organizational structure, and access essential employee information. The directory supports advanced search capabilities, role-based access control, and integration with communication systems.

### 1.1.3 Directory Search Schema

```
Table: employee_directory_search
Fields:
- id: UUID (Primary Key)
- employee_id: UUID (Foreign Key to employee)
- searchable_content: TEXT (Full-text search index)
- skills: JSON (Array of skills)
- certifications: JSON (Array of certifications)
- languages: JSON (Array of languages)
- projects: JSON (Array of project assignments)
- expertise_areas: JSON (Array of expertise areas)
- last_updated: TIMESTAMP (Auto)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_employee_id (employee_id)
- FULLTEXT INDEX ft_searchable_content (searchable_content)
- INDEX idx_skills (skills) USING GIN
- INDEX idx_certifications (certifications) USING GIN

Constraints:
- fk_directory_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
```

### 1.1.4 Search Capabilities

```
Search Fields:
- Employee Code/Number
- Name (First, Last, Display)
- Department
- Position
- Skills
- Location
- Work Email
- Work Phone
- Expertise Areas
- Certifications
- Languages

Filter Options:
- Department
- Employment Type
- Employment Status
- Location
- Grade Level
- Job Family
- Reporting Manager
- Hire Date Range
- Skills
- Certifications

Sort Options:
- Name (A-Z, Z-A)
- Employee Code
- Hire Date
- Department
- Position Level
- Location
```

### 1.1.5 Access Control Schema

```
Table: directory_access_control
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- employee_id: UUID (Foreign Key to employee)
- access_level: ENUM('Public', 'Team', 'Department', 'Company', 'HR Only')
- granted_by_user_id: UUID (Foreign Key to user)
- granted_at: TIMESTAMP (Auto)
- expires_at: DATE
- is_active: BOOLEAN (Default: TRUE)
- access_reason: VARCHAR(200)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_access_level (access_level)
- INDEX idx_granted_at (granted_at)
- INDEX idx_expires_at (expires_at)

Constraints:
- fk_directory_access_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_directory_access_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_directory_access_granted_by FOREIGN KEY (granted_by_user_id) REFERENCES user(id)
```

### 1.1.6 Role-Based Access Rules

```
Role: HR Admin
Permissions:
- View all employee fields
- Edit all employee information
- Access terminated employee records
- Export directory data
- View audit logs
- Manage access permissions

Role: Manager
Permissions:
- View direct reports' complete information
- View team members' basic information
- Edit direct reports' limited fields (contact, emergency info)
- View organizational structure for team
- No access to terminated employees outside team

Role: Employee
Permissions:
- View basic information of all employees
- View detailed information of self
- View organizational structure (limited to reporting lines)
- No access to sensitive information (salary, performance)
- No access to terminated employees

Role: System Admin
Permissions:
- Technical configuration only
- No access to employee PII data
- System maintenance and monitoring
```

### 1.1.7 Data Visibility Rules

1. **Public Fields**: Name, position, department, work email, work phone
2. **Team Fields**: Additional fields for direct reports (mobile, emergency contact)
3. **Sensitive Fields**: Salary, performance, disciplinary (HR Admin only)
4. **Historical Fields**: Previous positions, salary history (HR Admin only)
5. **Location-based**: Restrict access by location for multi-location companies

### 1.1.8 Directory Display Schema

```
Table: directory_display_preferences
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- default_view: ENUM('List', 'Card', 'Table')
- default_sort: ENUM('Name', 'Department', 'Position', 'Location')
- page_size: INTEGER (Default: 25)
- show_photos: BOOLEAN (Default: TRUE)
- show_contact_info: BOOLEAN (Default: TRUE)
- show_department: BOOLEAN (Default: TRUE)
- show_location: BOOLEAN (Default: TRUE)
- custom_fields: JSON (Array of field configurations)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)

Constraints:
- fk_display_preferences_user FOREIGN KEY (user_id) REFERENCES user(id)
```

### 1.1.9 Directory Analytics Schema

```
Table: directory_usage_analytics
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- search_query: VARCHAR(500)
- search_type: ENUM('Name', 'Department', 'Skill', 'Advanced')
- results_count: INTEGER
- clicked_employee_id: UUID (Foreign Key to employee)
- session_id: VARCHAR(100)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- search_timestamp: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)
- INDEX idx_search_type (search_type)
- INDEX idx_search_timestamp (search_timestamp)
- INDEX idx_clicked_employee (clicked_employee_id)

Constraints:
- fk_directory_analytics_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_directory_analytics_clicked FOREIGN KEY (clicked_employee_id) REFERENCES employee(id)
```

### 1.1.10 Integration Schema

```
Table: directory_integration
Fields:
- id: UUID (Primary Key)
- integration_type: ENUM('Email', 'Calendar', 'Chat', 'Video Conference')
- external_system: VARCHAR(100)
- employee_id: UUID (Foreign Key to employee)
- external_id: VARCHAR(200)
- sync_status: ENUM('Active', 'Inactive', 'Error')
- last_sync_at: TIMESTAMP
- sync_data: JSON (Integration-specific data)
- error_message: TEXT
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_integration_type (integration_type)
- INDEX idx_external_system (external_system)
- INDEX idx_employee_id (employee_id)
- INDEX idx_sync_status (sync_status)
- INDEX idx_last_sync_at (last_sync_at)

Constraints:
- fk_directory_integration_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
```

### 1.1.11 Directory Performance Schema

```
Table: directory_search_cache
Fields:
- id: UUID (Primary Key)
- cache_key: VARCHAR(500) (Required)
- cache_data: JSON (Compressed search results)
- expires_at: TIMESTAMP (Required)
- hit_count: INTEGER (Default: 0)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_cache_key (cache_key)
- INDEX idx_expires_at (expires_at)
- INDEX idx_hit_count (hit_count)
