# 1.4 Document Management

## 1.4.1 Business Purpose

Document Management provides a centralized, secure repository for storing, managing, and tracking all employee-related documents throughout their employment lifecycle. It ensures compliance with legal requirements, maintains document integrity, provides version control, and enables efficient document retrieval while maintaining proper access controls and audit trails for all document operations.

## 1.4.2 Business Scope

Enable secure storage and management of employee documents including contracts, identification proofs, educational certificates, performance reviews, and compliance documents. The system includes document classification, access control, version management, expiry monitoring, automated retention policies, and integration with e-signature platforms while ensuring data security and regulatory compliance.

## 1.4.3 Employee Document Schema

```
Table: employee_document
Fields:
- id: UUID (Primary Key)
- employee_id: UUID (Foreign Key to employee)
- document_type_id: UUID (Foreign Key to document_type_master)
- document_name: VARCHAR(200) (Required)
- document_description: TEXT
- file_name: VARCHAR(500) (Required)
- file_path: VARCHAR(1000) (Required)
- file_size: BIGINT (Required)
- file_type: VARCHAR(100) (Required)
- mime_type: VARCHAR(200) (Required)
- file_hash: VARCHAR(256) (Required, SHA-256)
- version: INTEGER (Default: 1)
- is_current: BOOLEAN (Default: TRUE)
- status: ENUM('Draft', 'Uploaded', 'Verified', 'Rejected', 'Expired', 'Archived')
- upload_date: DATE (Required)
- expiry_date: DATE
- verification_date: DATE
- verified_by_user_id: UUID (Foreign Key to user)
- verification_notes: TEXT
- is_public: BOOLEAN (Default: FALSE)
- is_encrypted: BOOLEAN (Default: FALSE)
- storage_location: ENUM('Local', 'Cloud', 'Hybrid')
- backup_location: VARCHAR(500)
- tags: JSON (Array of tags)
- metadata: JSON (Document metadata)
- uploaded_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_document_type_id (document_type_id)
- INDEX idx_document_name (document_name)
- INDEX idx_status (status)
- INDEX idx_upload_date (upload_date)
- INDEX idx_expiry_date (expiry_date)
- INDEX idx_is_current (is_current)
- INDEX idx_file_hash (file_hash)
- INDEX idx_uploaded_by (uploaded_by_user_id)

Constraints:
- fk_employee_doc_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_employee_doc_type FOREIGN KEY (document_type_id) REFERENCES document_type_master(id)
- fk_employee_doc_verified_by FOREIGN KEY (verified_by_user_id) REFERENCES user(id)
- fk_employee_doc_uploaded_by FOREIGN KEY (uploaded_by_user_id) REFERENCES user(id)
- chk_version_positive CHECK (version > 0)
- chk_file_size_positive CHECK (file_size > 0)
```

## 1.4.4 Document Type Master Schema

```
Table: document_type_master
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- type_code: VARCHAR(50) (Required, Indexed)
- type_name: VARCHAR(200) (Required)
- category: ENUM('Personal', 'Employment', 'Education', 'Professional', 'Legal', 'Medical', 'Financial', 'Training', 'Performance', 'Compliance')
- description: TEXT
- is_required: BOOLEAN (Default: FALSE)
- is_mandatory_for_onboarding: BOOLEAN (Default: FALSE)
- is_mandatory_for_exit: BOOLEAN (Default: FALSE)
- requires_verification: BOOLEAN (Default: TRUE)
- expiry_required: BOOLEAN (Default: FALSE)
- expiry_days: INTEGER (Default: 365)
- max_file_size_mb: INTEGER (Default: 10)
- allowed_file_types: JSON (Array of allowed file extensions)
- access_level: ENUM('Public', 'HR Only', 'Manager', 'Employee', 'Restricted')
- retention_years: INTEGER (Default: 7)
- auto_archive: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- display_order: INTEGER (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_doc_type_company_code (company_id, type_code)
- INDEX idx_company_id (company_id)
- INDEX idx_category (category)
- INDEX idx_is_required (is_required)
- INDEX idx_is_active (is_active)
- INDEX idx_display_order (display_order)

Constraints:
- fk_doc_type_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_doc_type_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (retention_years > 0)
- chk_max_file_size_positive CHECK (max_file_size_mb > 0)
```

## 1.4.5 Document Version Schema

```
Table: document_version
Fields:
- id: UUID (Primary Key)
- document_id: UUID (Foreign Key to employee_document)
- version_number: INTEGER (Required)
- file_name: VARCHAR(500) (Required)
- file_path: VARCHAR(1000) (Required)
- file_size: BIGINT (Required)
- file_type: VARCHAR(100) (Required)
- file_hash: VARCHAR(256) (Required, SHA-256)
- change_summary: TEXT
- change_reason: TEXT
- status: ENUM('Draft', 'Active', 'Superseded', 'Archived')
- effective_date: DATE
- uploaded_by_user_id: UUID (Foreign Key to user)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_document_id (document_id)
- INDEX idx_version_number (version_number)
- INDEX idx_status (status)
- INDEX idx_effective_date (effective_date)
- INDEX idx_uploaded_by (uploaded_by_user_id)
- INDEX idx_approved_by (approved_by_user_id)

Constraints:
- fk_doc_version_document FOREIGN KEY (document_id) REFERENCES employee_document(id)
- fk_doc_version_uploaded_by FOREIGN KEY (uploaded_by_user_id) REFERENCES user(id)
- fk_doc_version_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_version_positive CHECK (version_number > 0)
- chk_file_size_positive CHECK (file_size > 0)
```

## 1.4.6 Document Verification Schema

```
Table: document_verification
Fields:
- id: UUID (Primary Key)
- document_id: UUID (Foreign Key to employee_document)
- verification_type: ENUM('Manual', 'Automated', 'Third Party', 'E-Signature')
- verifier_id: UUID (Foreign Key to user)
- verification_status: ENUM('Pending', 'In Progress', 'Verified', 'Rejected', 'Requires Additional Info')
- verification_method: VARCHAR(100)
- verification_result: TEXT
- verification_notes: TEXT
- verification_score: INTEGER (0-100)
- verification_date: TIMESTAMP
- expiry_date: DATE
- next_verification_date: DATE
- supporting_documents: JSON (Array of supporting document IDs)
- verification_checklist: JSON (Checklist items and results)
- automated_checks: JSON (Automated validation results)
- third_party_reference: VARCHAR(200)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_document_id (document_id)
- INDEX idx_verification_type (verification_type)
- INDEX idx_verifier_id (verifier_id)
- INDEX idx_verification_status (verification_status)
- INDEX idx_verification_date (verification_date)
- INDEX idx_expiry_date (expiry_date)

Constraints:
- fk_doc_verification_document FOREIGN KEY (document_id) REFERENCES employee_document(id)
- fk_doc_verification_verifier FOREIGN KEY (verifier_id) REFERENCES user(id)
- chk_verification_score_range CHECK (verification_score BETWEEN 0 AND 100)
```

## 1.4.7 Document Retention Schema

```
Table: document_retention
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- document_type_id: UUID (Foreign Key to document_type_master)
- retention_policy_name: VARCHAR(200) (Required)
- retention_period_years: INTEGER (Required)
- retention_trigger: ENUM('Employment End', 'Document Date', 'Fixed Date', 'Event Based')
- trigger_event: VARCHAR(200)
- archive_after_years: INTEGER
- delete_after_years: INTEGER
- legal_hold_applicable: BOOLEAN (Default: FALSE)
- compliance_requirements: JSON (Legal and compliance requirements)
- notification_before_expiry_days: INTEGER (Default: 90)
- auto_archive: BOOLEAN (Default: TRUE)
- auto_delete: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_document_type_id (document_type_id)
- INDEX idx_retention_trigger (retention_trigger)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_retention_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_retention_doc_type FOREIGN KEY (document_type_id) REFERENCES document_type_master(id)
- fk_retention_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retention_period_positive CHECK (retention_period_years > 0)
```

## 1.4.8 Document Expiry Monitoring Schema

```
Table: document_expiry_monitoring
Fields:
- id: UUID (Primary Key)
- document_id: UUID (Foreign Key to employee_document)
- employee_id: UUID (Foreign Key to employee)
- expiry_date: DATE (Required)
- expiry_type: ENUM('Document Expiry', 'Verification Expiry', 'License Expiry', 'Certification Expiry')
- notification_sent_90d: BOOLEAN (Default: FALSE)
- notification_sent_60d: BOOLEAN (Default: FALSE)
- notification_sent_30d: BOOLEAN (Default: FALSE)
- notification_sent_7d: BOOLEAN (Default: FALSE)
- notification_sent_expired: BOOLEAN (Default: FALSE)
- last_notification_date: DATE
- renewal_required: BOOLEAN (Default: TRUE)
- renewal_submitted: BOOLEAN (Default: FALSE)
- renewal_document_id: UUID (Foreign Key to employee_document)
- grace_period_days: INTEGER (Default: 30)
- final_expiry_date: DATE
- status: ENUM('Active', 'Expiring Soon', 'Expired', 'Grace Period', 'Renewed', 'Archived')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_document_id (document_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_expiry_date (expiry_date)
- INDEX idx_expiry_type (expiry_type)
- INDEX idx_status (status)
- INDEX idx_final_expiry_date (final_expiry_date)

Constraints:
- fk_expiry_monitoring_document FOREIGN KEY (document_id) REFERENCES employee_document(id)
- fk_expiry_monitoring_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_expiry_renewal_document FOREIGN KEY (renewal_document_id) REFERENCES employee_document(id)
- chk_grace_period_positive CHECK (grace_period_days >= 0)
```

## 1.4.9 Document Access Control Schema

```
Table: document_access_control
Fields:
- id: UUID (Primary Key)
- document_id: UUID (Foreign Key to employee_document)
- user_id: UUID (Foreign Key to user)
- access_type: ENUM('View', 'Download', 'Print', 'Share', 'Edit', 'Delete')
- permission_level: ENUM('Owner', 'Full Access', 'Read Only', 'Restricted')
- granted_by_user_id: UUID (Foreign Key to user)
- granted_at: TIMESTAMP (Auto)
- expires_at: TIMESTAMP
- access_reason: VARCHAR(500)
- ip_restriction: VARCHAR(45)
- time_restriction: JSON (Allowed time windows)
- download_limit: INTEGER
- download_count: INTEGER (Default: 0)
- is_active: BOOLEAN (Default: TRUE)
- last_accessed_at: TIMESTAMP
- access_count: INTEGER (Default: 0)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_document_id (document_id)
- INDEX idx_user_id (user_id)
- INDEX idx_access_type (access_type)
- INDEX idx_permission_level (permission_level)
- INDEX idx_granted_by (granted_by_user_id)
- INDEX idx_expires_at (expires_at)
- INDEX idx_is_active (is_active)

Constraints:
- fk_doc_access_document FOREIGN KEY (document_id) REFERENCES employee_document(id)
- fk_doc_access_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_doc_access_granted_by FOREIGN KEY (granted_by_user_id) REFERENCES user(id)
- chk_download_limit_positive CHECK (download_limit > 0)
```

## 1.4.10 Document Analytics Schema

```
Table: document_analytics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- document_id: UUID (Foreign Key to employee_document)
- employee_id: UUID (Foreign Key to employee)
- action: ENUM('Upload', 'View', 'Download', 'Print', 'Share', 'Delete', 'Verify', 'Archive')
- user_id: UUID (Foreign Key to user)
- session_id: VARCHAR(100)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- device_type: ENUM('Desktop', 'Mobile', 'Tablet')
- browser: VARCHAR(100)
- action_timestamp: TIMESTAMP (Auto)
- processing_time_ms: INTEGER
- file_size: BIGINT
- success_flag: BOOLEAN (Default: TRUE)
- error_message: TEXT
- additional_context: JSON (Extra context information)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_document_id (document_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_action (action)
- INDEX idx_user_id (user_id)
- INDEX idx_action_timestamp (action_timestamp)
- INDEX idx_device_type (device_type)

Constraints:
- fk_doc_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_doc_analytics_document FOREIGN KEY (document_id) REFERENCES employee_document(id)
- fk_doc_analytics_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_doc_analytics_user FOREIGN KEY (user_id) REFERENCES user(id)
```

## 1.4.11 Document Integration Schema

```
Table: document_integration
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- integration_type: ENUM('E-Signature', 'Cloud Storage', 'Document Scanner', 'OCR', 'Verification Service', 'Backup Service')
- provider_name: VARCHAR(100) (Required)
- api_endpoint: VARCHAR(500)
- api_key_encrypted: TEXT (Encrypted)
- api_secret_encrypted: TEXT (Encrypted)
- configuration: JSON (Integration-specific settings)
- supported_document_types: JSON (Array of supported document types)
- auto_sync_enabled: BOOLEAN (Default: FALSE)
- sync_frequency_minutes: INTEGER (Default: 60)
- last_sync_at: TIMESTAMP
- sync_status: ENUM('Active', 'Inactive', 'Error', 'Syncing')
- error_message: TEXT
- retry_count: INTEGER (Default: 0)
- max_retries: INTEGER (Default: 3)
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_integration_type (integration_type)
- INDEX idx_provider_name (provider_name)
- INDEX idx_sync_status (sync_status)
- INDEX idx_is_active (is_active)
- INDEX idx_last_sync_at (last_sync_at)

Constraints:
- fk_doc_integration_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_doc_integration_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_sync_frequency_positive CHECK (sync_frequency_minutes > 0)
- chk_max_retries_positive CHECK (max_retries >= 0)
