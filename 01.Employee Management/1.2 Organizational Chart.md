# 1.2 Organizational Chart

## 1.2.1 Business Purpose

The Organizational Chart provides a visual representation of the company's reporting structure, hierarchical relationships, and organizational design. It enables employees to understand reporting lines, team structures, and organizational relationships while supporting workforce planning and analysis. The chart serves as a critical tool for organizational design, succession planning, and strategic decision-making.

## 1.2.2 Business Scope

Provide interactive organizational chart visualization with drill-down capabilities, support for matrix reporting relationships, historical hierarchy tracking, and integration with workforce planning tools. The chart supports multiple view modes and export capabilities for presentations and analysis while maintaining real-time synchronization with employee data changes.

## 1.2.3 Hierarchy Schema

```
Table: organizational_hierarchy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- employee_id: UUID (Foreign Key to employee)
- manager_id: UUID (Foreign Key to employee)
- level_depth: INTEGER (Computed)
- reporting_path: VARCHAR(1000) (Computed, comma-separated employee IDs)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- hierarchy_type: ENUM('Direct', 'Dotted', 'Functional', 'Matrix')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_employee (company_id, employee_id)
- INDEX idx_manager_id (manager_id)
- INDEX idx_level_depth (level_depth)
- INDEX idx_effective_date_range (effective_from, effective_to)
- INDEX idx_hierarchy_type (hierarchy_type)
- INDEX idx_is_active (is_active)

Constraints:
- fk_hierarchy_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hierarchy_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_hierarchy_manager FOREIGN KEY (manager_id) REFERENCES employee(id)
- chk_date_range CHECK (effective_to IS NULL OR effective_to >= effective_from)
```

## 1.2.4 Hierarchy Validation Rules

```
Function: validate_reporting_structure(employee_id, proposed_manager_id, hierarchy_type)
Rules:
- Cannot report to self
- Cannot create circular dependency (recursive check)
- Manager must be in Active employment status
- Manager position must be marked as managerial
- Manager must belong to same company
- Cross-departmental reporting requires approval matrix validation
- Matrix reporting requires functional manager assignment
- Dotted-line relationships require explicit designation
- Effective date cannot be in the past for most transitions
```

## 1.2.5 Matrix Reporting Schema

```
Table: matrix_reporting
Fields:
- id: UUID (Primary Key)
- employee_id: UUID (Foreign Key to employee)
- direct_manager_id: UUID (Foreign Key to employee)
- functional_manager_id: UUID (Foreign Key to employee)
- dotted_line_manager_id: UUID (Foreign Key to employee)
- project_manager_id: UUID (Foreign Key to employee)
- reporting_percentage: DECIMAL(5,2) (Percentage of time reporting to each manager)
- effective_from: DATE (Required)
- effective_to: DATE
- is_primary: BOOLEAN (Default: FALSE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_direct_manager (direct_manager_id)
- INDEX idx_functional_manager (functional_manager_id)
- INDEX idx_dotted_line_manager (dotted_line_manager_id)
- INDEX idx_project_manager (project_manager_id)
- INDEX idx_effective_date_range (effective_from, effective_to)

Constraints:
- fk_matrix_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_matrix_direct_manager FOREIGN KEY (direct_manager_id) REFERENCES employee(id)
- fk_matrix_functional_manager FOREIGN KEY (functional_manager_id) REFERENCES employee(id)
- fk_matrix_dotted_line_manager FOREIGN KEY (dotted_line_manager_id) REFERENCES employee(id)
- fk_matrix_project_manager FOREIGN KEY (project_manager_id) REFERENCES employee(id)
- fk_matrix_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_percentage_range CHECK (reporting_percentage BETWEEN 0 AND 100)
- chk_date_range CHECK (effective_to IS NULL OR effective_to >= effective_from)
```

## 1.2.6 Organizational Unit Schema

```
Table: organizational_unit
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- unit_code: VARCHAR(50) (Required, Indexed)
- unit_name: VARCHAR(200) (Required)
- unit_type: ENUM('Division', 'Department', 'Team', 'Sub-team', 'Project', 'Committee')
- parent_unit_id: UUID (Self-reference to organizational_unit)
- unit_head_id: UUID (Foreign Key to employee)
- unit_level: INTEGER
- employee_count: INTEGER (Computed)
- budget_code: VARCHAR(50)
- cost_center_code: VARCHAR(50)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_org_unit_company_code (company_id, unit_code)
- INDEX idx_company_id (company_id)
- INDEX idx_parent_unit_id (parent_unit_id)
- INDEX idx_unit_head_id (unit_head_id)
- INDEX idx_unit_type (unit_type)
- INDEX idx_unit_level (unit_level)
- INDEX idx_is_active (is_active)

Constraints:
- fk_org_unit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_org_unit_parent FOREIGN KEY (parent_unit_id) REFERENCES organizational_unit(id)
- fk_org_unit_head FOREIGN KEY (unit_head_id) REFERENCES employee(id)
- fk_org_unit_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_no_self_parent CHECK (parent_unit_id != id)
```

## 1.2.7 Position Hierarchy Schema

```
Table: position_hierarchy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- position_id: UUID (Foreign Key to position)
- reports_to_position_id: UUID (Foreign Key to position)
- hierarchy_level: INTEGER
- reporting_path: VARCHAR(1000) (Computed)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_position (company_id, position_id)
- INDEX idx_reports_to_position (reports_to_position_id)
- INDEX idx_hierarchy_level (hierarchy_level)
- INDEX idx_effective_date_range (effective_from, effective_to)

Constraints:
- fk_pos_hierarchy_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_pos_hierarchy_position FOREIGN KEY (position_id) REFERENCES position(id)
- fk_pos_hierarchy_reports_to FOREIGN KEY (reports_to_position_id) REFERENCES position(id)
- chk_date_range CHECK (effective_to IS NULL OR effective_to >= effective_from)
```

## 1.2.8 Succession Planning Schema

```
Table: succession_planning
Fields:
- id: UUID (Primary Key)
- position_id: UUID (Foreign Key to position)
- incumbent_id: UUID (Foreign Key to employee)
- successor_id: UUID (Foreign Key to employee)
- readiness_level: ENUM('Ready Now', 'Ready in 1-2 Years', 'Ready in 3-5 Years', 'Potential', 'Not Ready')
- development_needs: TEXT
- gap_analysis: TEXT
- development_plan: TEXT
- target_date: DATE
- priority: ENUM('High', 'Medium', 'Low')
- status: ENUM('Active', 'On Hold', 'Completed', 'Cancelled')
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_position_id (position_id)
- INDEX idx_incumbent_id (incumbent_id)
- INDEX idx_successor_id (successor_id)
- INDEX idx_readiness_level (readiness_level)
- INDEX idx_priority (priority)
- INDEX idx_status (status)
- INDEX idx_target_date (target_date)

Constraints:
- fk_succession_position FOREIGN KEY (position_id) REFERENCES position(id)
- fk_succession_incumbent FOREIGN KEY (incumbent_id) REFERENCES employee(id)
- fk_succession_successor FOREIGN KEY (successor_id) REFERENCES employee(id)
- fk_succession_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
```

## 1.2.9 Chart Configuration Schema

```
Table: org_chart_configuration
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- user_id: UUID (Foreign Key to user)
- chart_type: ENUM('Hierarchical', 'Matrix', 'Circular', 'Horizontal')
- display_mode: ENUM('Compact', 'Detailed', 'Photos Only', 'Names Only')
- max_levels: INTEGER (Default: 5)
- show_contractors: BOOLEAN (Default: FALSE)
- show_terminated: BOOLEAN (Default: FALSE)
- color_scheme: VARCHAR(50) (Default: 'Default')
- node_size: ENUM('Small', 'Medium', 'Large')
- animation_enabled: BOOLEAN (Default: TRUE)
- export_format: ENUM('PNG', 'SVG', 'PDF', 'Excel')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_chart_type (chart_type)

Constraints:
- fk_chart_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_chart_config_user FOREIGN KEY (user_id) REFERENCES user(id)
```

## 1.2.10 Chart Analytics Schema

```
Table: org_chart_analytics
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- chart_type: ENUM('Hierarchical', 'Matrix', 'Circular', 'Horizontal')
- action: ENUM('View', 'Export', 'Print', 'Share', 'Drill Down')
- node_clicked_id: UUID (Foreign Key to employee)
- session_id: VARCHAR(100)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- action_timestamp: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)
- INDEX idx_chart_type (chart_type)
- INDEX idx_action (action)
- INDEX idx_node_clicked (node_clicked_id)
- INDEX idx_action_timestamp (action_timestamp)

Constraints:
- fk_chart_analytics_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_chart_analytics_node FOREIGN KEY (node_clicked_id) REFERENCES employee(id)
```

## 1.2.11 Hierarchy Change Log Schema

```
Table: hierarchy_change_log
Fields:
- id: UUID (Primary Key)
- employee_id: UUID (Foreign Key to employee)
- change_type: ENUM('Manager Change', 'Promotion', 'Transfer', 'Department Change', 'Position Change')
- old_manager_id: UUID (Foreign Key to employee)
- new_manager_id: UUID (Foreign Key to employee)
- old_position_id: UUID (Foreign Key to position)
- new_position_id: UUID (Foreign Key to position)
- old_department_id: UUID (Foreign Key to department)
- new_department_id: UUID (Foreign Key to department)
- effective_date: DATE (Required)
- change_reason: TEXT
- approved_by_user_id: UUID (Foreign Key to user)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_change_type (change_type)
- INDEX idx_effective_date (effective_date)
- INDEX idx_approved_by (approved_by_user_id)

Constraints:
- fk_hierarchy_log_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_hierarchy_log_old_manager FOREIGN KEY (old_manager_id) REFERENCES employee(id)
- fk_hierarchy_log_new_manager FOREIGN KEY (new_manager_id) REFERENCES employee(id)
- fk_hierarchy_log_old_position FOREIGN KEY (old_position_id) REFERENCES position(id)
- fk_hierarchy_log_new_position FOREIGN KEY (new_position_id) REFERENCES position(id)
- fk_hierarchy_log_old_department FOREIGN KEY (old_department_id) REFERENCES department(id)
- fk_hierarchy_log_new_department FOREIGN KEY (new_department_id) REFERENCES department(id)
- fk_hierarchy_log_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- fk_hierarchy_log_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
