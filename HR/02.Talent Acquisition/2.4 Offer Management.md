# 2.4 Offer Management

## 2.4.1 Business Purpose

Offer Management provides a structured workflow for creating, approving, and managing job offers to selected candidates. It ensures consistent offer processes, compliance with compensation policies, proper documentation, and timely communication while maintaining offer tracking, negotiation management, and integration with onboarding processes to facilitate smooth candidate transitions to employment.

## 2.4.2 Business Scope

Enable comprehensive offer management including offer letter generation, multi-level approval workflows, compensation validation, background check coordination, offer negotiation tracking, and candidate communication. The system supports automated calculations, template management, deadline tracking, offer withdrawal processes, and integration with payroll and onboarding systems while ensuring data accuracy and regulatory compliance.

## 2.4.3 Offer Master Schema

```
Table: job_offer
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- offer_number: VARCHAR(50) (Unique, Indexed)
- application_id: UUID (Foreign Key to candidate_application)
- requisition_id: UUID (Foreign Key to job_requisition)
- candidate_id: UUID (Foreign Key to candidate)
- offer_type: ENUM('Standard', 'Executive', 'Contract', 'Intern', 'Contingent', 'Remote')
- offer_status: ENUM('Draft', 'Submitted', 'Pending Approval', 'Approved', 'Rejected', 'Accepted', 'Declined', 'Withdrawn', 'Expired')
- offer_date: DATE (Required)
- expiry_date: DATE (Required)
- acceptance_deadline_days: INTEGER (Default: 7)
- position_title: VARCHAR(200) (Required)
- department_id: UUID (Foreign Key to department)
- location_id: UUID (Foreign Key to location)
- employment_type: ENUM('Full Time', 'Part Time', 'Contract', 'Intern', 'Temporary', 'Consultant')
- work_schedule: ENUM('Standard', 'Flexible', 'Remote', 'Hybrid', 'Shift Work')
- start_date: DATE (Required)
- reporting_to_employee_id: UUID (Foreign Key to employee)
- salary_basis: ENUM('Annual', 'Monthly', 'Hourly', 'Project')
- base_salary: DECIMAL(15,2)
- currency_code: VARCHAR(10) (Default: 'USD')
- bonus_eligible: BOOLEAN (Default: FALSE)
- bonus_percentage: DECIMAL(5,2)
- bonus_target: DECIMAL(15,2)
- commission_eligible: BOOLEAN (Default: FALSE)
- commission_structure: JSON (Commission details)
- stock_options: BOOLEAN (Default: FALSE)
- stock_details: JSON (Stock option details)
- benefits_package_id: UUID (Foreign Key to benefits_package)
- relocation_assistance: BOOLEAN (Default: FALSE)
- relocation_amount: DECIMAL(10,2)
- signing_bonus: DECIMAL(10,2)
- probation_period_days: INTEGER (Default: 90)
- notice_period_days: INTEGER
- offer_terms: TEXT
- special_conditions: TEXT
- background_check_required: BOOLEAN (Default: TRUE)
- background_check_status: ENUM('Not Started', 'In Progress', 'Completed', 'Failed', 'Waived')
- drug_test_required: BOOLEAN (Default: FALSE)
- created_by_user_id: UUID (Foreign Key to user)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- sent_date: TIMESTAMP
- accepted_date: DATE
- declined_date: DATE
- withdrawal_reason: TEXT
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_offer_number (offer_number)
- INDEX idx_company_id (company_id)
- INDEX idx_application_id (application_id)
- INDEX idx_requisition_id (requisition_id)
- INDEX idx_candidate_id (candidate_id)
- INDEX idx_offer_status (offer_status)
- INDEX idx_offer_date (offer_date)
- INDEX idx_expiry_date (expiry_date)
- INDEX idx_created_by (created_by_user_id)
- INDEX idx_approved_by (approved_by_user_id)

Constraints:
- fk_offer_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_offer_application FOREIGN KEY (application_id) REFERENCES candidate_application(id)
- fk_offer_requisition FOREIGN KEY (requisition_id) REFERENCES job_requisition(id)
- fk_offer_candidate FOREIGN KEY (candidate_id) REFERENCES candidate(id)
- fk_offer_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_offer_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_offer_reporting_to FOREIGN KEY (reporting_to_employee_id) REFERENCES employee(id)
- fk_offer_benefits_package FOREIGN KEY (benefits_package_id) REFERENCES benefits_package(id)
- fk_offer_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_offer_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_acceptance_deadline_positive CHECK (acceptance_deadline_days > 0)
- chk_bonus_percentage_range CHECK (bonus_percentage BETWEEN 0 AND 100)
```

## 2.4.4 Offer Approval Workflow Schema

```
Table: offer_approval_workflow
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- workflow_template_id: UUID (Foreign Key to workflow_template)
- approval_level: INTEGER (Required)
- approver_type: ENUM('Hiring Manager', 'Department Head', 'HR Business Partner', 'Finance', 'Compensation', 'Executive', 'Specific User')
- approver_id: UUID (Foreign Key to user)
- status: ENUM('Pending', 'Approved', 'Rejected', 'Delegated', 'Escalated')
- decision: ENUM('Approve', 'Reject', 'Request More Info', 'Delegate')
- comments: TEXT
- attachments: JSON (Array of document IDs)
- delegated_to_user_id: UUID (Foreign Key to user)
- escalated_to_user_id: UUID (Foreign Key to user)
- due_date: TIMESTAMP
- action_date: TIMESTAMP
- approval_order: INTEGER
- is_parallel: BOOLEAN (Default: FALSE)
- auto_approve: BOOLEAN (Default: FALSE)
- approval_conditions: JSON (Conditions for approval)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_workflow_template (workflow_template_id)
- INDEX idx_approver_id (approver_id)
- INDEX idx_approval_level (approval_level)
- INDEX idx_status (status)
- INDEX idx_decision (decision)
- INDEX idx_due_date (due_date)
- INDEX idx_approval_order (approval_order)

Constraints:
- fk_offer_approval_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_offer_approval_template FOREIGN KEY (workflow_template_id) REFERENCES workflow_template(id)
- fk_offer_approval_approver FOREIGN KEY (approver_id) REFERENCES user(id)
- fk_offer_approval_delegated_to FOREIGN KEY (delegated_to_user_id) REFERENCES user(id)
- fk_offer_approval_escalated_to FOREIGN KEY (escalated_to_user_id) REFERENCES user(id)
```

## 2.4.5 Offer Compensation Schema

```
Table: offer_compensation
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- compensation_type: ENUM('Base Salary', 'Bonus', 'Commission', 'Stock Options', 'Signing Bonus', 'Relocation', 'Car Allowance', 'Housing Allowance', 'Other')
- amount: DECIMAL(15,2)
- currency_code: VARCHAR(10) (Default: 'USD')
- frequency: ENUM('One Time', 'Annual', 'Monthly', 'Quarterly', 'Per Hour', 'Per Project')
- payment_schedule: JSON (Payment schedule details)
- performance_criteria: TEXT
- vesting_schedule: JSON (Vesting details for stock/options)
- conditions: TEXT (Conditions for receiving compensation)
- tax_implications: JSON (Tax information)
- is_taxable: BOOLEAN (Default: TRUE)
- is_guaranteed: BOOLEAN (Default: FALSE)
- effective_date: DATE
- expiry_date: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_compensation_type (compensation_type)
- INDEX idx_amount (amount)
- INDEX idx_frequency (frequency)
- INDEX idx_effective_date (effective_date)
- INDEX idx_expiry_date (expiry_date)

Constraints:
- fk_compensation_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_compensation_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_amount_positive CHECK (amount > 0)
```

## 2.4.6 Offer Template Schema

```
Table: offer_template
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- template_name: VARCHAR(200) (Required)
- template_type: ENUM('Standard', 'Executive', 'Technical', 'Sales', 'Customer Service', 'Operations', 'Finance', 'HR', 'IT')
- template_description: TEXT
- offer_letter_template: TEXT (Required)
- terms_conditions_template: TEXT
- compensation_structure: JSON (Default compensation structure)
- benefits_included: JSON (Standard benefits included)
- legal_clauses: JSON (Legal clauses and disclaimers)
- required_fields: JSON (Array of required field names)
- field_validations: JSON (Field validation rules)
- approval_workflow_template_id: UUID (Foreign Key to workflow_template)
- is_active: BOOLEAN (Default: TRUE)
- usage_count: INTEGER (Default: 0)
- version: INTEGER (Default: 1)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_template_type (template_type)
- INDEX idx_is_active (is_active)
- INDEX idx_usage_count (usage_count)
- INDEX idx_version (version)

Constraints:
- fk_offer_template_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_offer_template_workflow FOREIGN KEY (approval_workflow_template_id) REFERENCES workflow_template(id)
- fk_offer_template_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_usage_count_positive CHECK (usage_count >= 0)
- chk_version_positive CHECK (version > 0)
```

## 2.4.7 Offer Negotiation Schema

```
Table: offer_negotiation
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- negotiation_round: INTEGER (Required)
- initiated_by: ENUM('Candidate', 'Company', 'Recruiter')
- negotiation_type: ENUM('Salary', 'Bonus', 'Benefits', 'Start Date', 'Work Schedule', 'Location', 'Other')
- original_value: DECIMAL(15,2)
- requested_value: DECIMAL(15,2)
- counter_value: DECIMAL(15,2)
- final_value: DECIMAL(15,2)
- currency_code: VARCHAR(10) (Default: 'USD')
- negotiation_status: ENUM('Requested', 'Under Review', 'Approved', 'Rejected', 'Withdrawn')
- candidate_request: TEXT
- company_response: TEXT
- negotiation_notes: TEXT
- decision_maker_id: UUID (Foreign Key to user)
- decision_date: TIMESTAMP
- approval_required: BOOLEAN (Default: TRUE)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- impact_on_offer: JSON (Impact on other offer terms)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_negotiation_round (negotiation_round)
- INDEX idx_initiated_by (initiated_by)
- INDEX idx_negotiation_type (negotiation_type)
- INDEX idx_negotiation_status (negotiation_status)
- INDEX idx_decision_date (decision_date)

Constraints:
- fk_negotiation_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_negotiation_decision_maker FOREIGN KEY (decision_maker_id) REFERENCES user(id)
- fk_negotiation_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_negotiation_round_positive CHECK (negotiation_round > 0)
```

## 2.4.8 Offer Communication Schema

```
Table: offer_communication
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- candidate_id: UUID (Foreign Key to candidate)
- communication_type: ENUM('Offer Letter', 'Offer Revision', 'Negotiation', 'Acceptance', 'Rejection', 'Withdrawal', 'Reminder', 'Follow-up')
- direction: ENUM('Inbound', 'Outbound')
- subject: VARCHAR(500)
- message_content: TEXT (Required)
- template_id: UUID (Foreign Key to communication_template)
- template_name: VARCHAR(200)
- sender_id: UUID (Foreign Key to user)
- recipient_email: VARCHAR(200)
- recipient_phone: VARCHAR(50)
- status: ENUM('Draft', 'Sent', 'Delivered', 'Failed', 'Bounced', 'Opened', 'Clicked', 'Replied')
- sent_date: TIMESTAMP
- delivered_date: TIMESTAMP
- opened_date: TIMESTAMP
- clicked_date: TIMESTAMP
- replied_date: TIMESTAMP
- error_message: TEXT
- attachments: JSON (Array of document IDs)
- priority: ENUM('Low', 'Medium', 'High', 'Urgent')
- auto_generated: BOOLEAN (Default: FALSE)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_candidate_id (candidate_id)
- INDEX idx_communication_type (communication_type)
- INDEX idx_direction (direction)
- INDEX idx_sender_id (sender_id)
- INDEX idx_status (status)
- INDEX idx_sent_date (sent_date)
- INDEX idx_priority (priority)

Constraints:
- fk_offer_communication_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_offer_communication_candidate FOREIGN KEY (candidate_id) REFERENCES candidate(id)
- fk_offer_communication_template FOREIGN KEY (template_id) REFERENCES communication_template(id)
- fk_offer_communication_sender FOREIGN KEY (sender_id) REFERENCES user(id)
```

## 2.4.9 Offer Analytics Schema

```
Table: offer_analytics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- offer_id: UUID (Foreign Key to job_offer)
- application_id: UUID (Foreign Key to candidate_application)
- requisition_id: UUID (Foreign Key to job_requisition)
- department_id: UUID (Foreign Key to department)
- position_id: UUID (Foreign Key to position)
- metric_type: ENUM('Acceptance Rate', 'Rejection Rate', 'Withdrawal Rate', 'Negotiation Rate', 'Time to Accept', 'Offer to Hire Time', 'Cost per Hire', 'Offer Quality Score')
- metric_value: DECIMAL(15,2)
- metric_unit: VARCHAR(50)
- benchmark_value: DECIMAL(15,2)
- variance_percentage: DECIMAL(5,2)
- measurement_date: DATE (Required)
- comparison_period: ENUM('Week', 'Month', 'Quarter', 'Year')
- additional_metrics: JSON (Additional KPIs and measurements)
- calculated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_application_id (application_id)
- INDEX idx_requisition_id (requisition_id)
- INDEX idx_department_id (department_id)
- INDEX idx_position_id (position_id)
- INDEX idx_metric_type (metric_type)
- INDEX idx_measurement_date (measurement_date)
- INDEX idx_comparison_period (comparison_period)

Constraints:
- fk_offer_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_offer_analytics_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_offer_analytics_application FOREIGN KEY (application_id) REFERENCES candidate_application(id)
- fk_offer_analytics_requisition FOREIGN KEY (requisition_id) REFERENCES job_requisition(id)
- fk_offer_analytics_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_offer_analytics_position FOREIGN KEY (position_id) REFERENCES position(id)
- fk_offer_analytics_calculated_by FOREIGN KEY (calculated_by_user_id) REFERENCES user(id)
```

## 2.4.10 Offer Integration Schema

```
Table: offer_integration
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- integration_type: ENUM('Payroll System', 'Background Check', 'Benefits Administration', 'Onboarding', 'HRIS', 'Document Management', 'E-Signature')
- provider_name: VARCHAR(200) (Required)
- integration_status: ENUM('Pending', 'In Progress', 'Completed', 'Failed', 'Skipped')
- api_endpoint: VARCHAR(500)
- request_data: JSON (Data sent to external system)
- response_data: JSON (Response from external system)
- error_message: TEXT
- retry_count: INTEGER (Default: 0)
- max_retries: INTEGER (Default: 3)
- last_sync_at: TIMESTAMP
- next_sync_at: TIMESTAMP
- sync_frequency_minutes: INTEGER (Default: 60)
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_integration_type (integration_type)
- INDEX idx_provider_name (provider_name)
- INDEX idx_integration_status (integration_status)
- INDEX idx_last_sync_at (last_sync_at)
- INDEX idx_next_sync_at (next_sync_at)
- INDEX idx_is_active (is_active)

Constraints:
- fk_offer_integration_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_offer_integration_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retry_count_range CHECK (retry_count BETWEEN 0 AND max_retries)
- chk_sync_frequency_positive CHECK (sync_frequency_minutes > 0)
```

## 2.4.11 Offer Audit Log Schema

```
Table: offer_audit_log
Fields:
- id: UUID (Primary Key)
- offer_id: UUID (Foreign Key to job_offer)
- company_id: UUID (Foreign Key to company)
- action: ENUM('Create', 'Update', 'Submit', 'Approve', 'Reject', 'Accept', 'Decline', 'Withdraw', 'Expire', 'Send', 'Negotiate')
- entity_type: ENUM('Offer', 'Approval', 'Compensation', 'Communication', 'Negotiation', 'Integration', 'Template')
- entity_id: UUID
- old_values: JSON (Previous values)
- new_values: JSON (Updated values)
- field_changes: JSON (Specific field changes)
- action_reason: TEXT
- performed_by_user_id: UUID (Foreign Key to user)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- session_id: VARCHAR(100)
- timestamp: TIMESTAMP (Auto)
- additional_context: JSON (Extra context information)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_offer_id (offer_id)
- INDEX idx_company_id (company_id)
- INDEX idx_action (action)
- INDEX idx_entity_type (entity_type)
- INDEX idx_performed_by (performed_by_user_id)
- INDEX idx_timestamp (timestamp)

Constraints:
- fk_offer_audit_offer FOREIGN KEY (offer_id) REFERENCES job_offer(id)
- fk_offer_audit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_offer_audit_performed_by FOREIGN KEY (performed_by_user_id) REFERENCES user(id)
