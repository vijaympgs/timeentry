# 13.5 HR System Settings

## 13.5.1 Business Purpose & Scope

## 13.5.1.1 Business Purpose

HR System Settings provides a comprehensive framework for centralized configuration, customization, and administration of the entire HR management system, ensuring optimal system performance, data integrity, security compliance, and user experience across all HR modules. This system enables administrators to configure workflows, set up organizational policies, manage system integrations, customize user interfaces, and maintain compliance with regulatory requirements while providing flexible configuration options that adapt to changing business needs and organizational growth through centralized control, automated validation, and comprehensive audit trails.

## 13.5.1.2 Business Scope

Enable comprehensive HR system configuration and administration including system parameters, workflow configurations, email templates, notification rules, security settings, integration management, data import/export utilities, user interface customization, compliance configurations, performance monitoring, backup and recovery settings, multi-tenant configurations, and system maintenance tools. The system supports various configuration types, validation rules, approval workflows, change management processes, audit trails, and provides seamless integration with all HR modules while ensuring data security, system stability, and regulatory compliance with industry standards and organizational requirements.

--- END OF SECTION 13.5.1 ---

## 13.5.2 System Configuration Schema

```
Table: hr_system_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- config_category: ENUM('General Settings', 'Security Settings', 'Email Configuration', 'Notification Rules', 'Workflow Settings', 'Integration Settings', 'Compliance Settings', 'Performance Settings')
- config_key: VARCHAR(200) (Required, Indexed)
- config_value: TEXT
- config_type: ENUM('String', 'Integer', 'Decimal', 'Boolean', 'JSON', 'Encrypted')
- default_value: TEXT
- description: TEXT
- is_system_config: BOOLEAN (Default: FALSE)
- is_encrypted: BOOLEAN (Default: FALSE)
- validation_rule: TEXT (Validation regex or rule description)
- min_value: DECIMAL(15,2)
- max_value: DECIMAL(15,2)
- allowed_values: JSON (List of allowed values for ENUM type)
- requires_restart: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- last_modified_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_config_company_category_key (company_id, config_category, config_key)
- INDEX idx_company_id (company_id)
- INDEX idx_config_category (config_category)
- INDEX idx_config_key (config_key)
- INDEX idx_is_system_config (is_system_config)
- INDEX idx_is_active (is_active)
- INDEX idx_updated_at (updated_at)

Constraints:
- fk_hr_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_config_modified_by FOREIGN KEY (last_modified_by_user_id) REFERENCES user(id)
- chk_value_range CHECK (min_value IS NULL OR max_value IS NULL OR min_value <= max_value)
```

```
Table: hr_workflow_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- workflow_name: VARCHAR(200) (Required, Unique, Indexed)
- workflow_type: ENUM('Leave Approval', 'Expense Approval', 'Performance Review', 'Onboarding', 'Offboarding', 'Document Approval', 'Time Sheet Approval', 'Request Processing')
- workflow_description: TEXT
- trigger_event: VARCHAR(200) (Required)
- workflow_steps: JSON (Ordered sequence of workflow steps)
- approval_levels: INTEGER (Default: 1)
- auto_approval_rules: JSON (Conditions for automatic approval)
- escalation_rules: JSON (Escalation conditions and timing)
- timeout_settings: JSON (Timeout configurations for each step)
- notification_rules: JSON (When to send notifications)
- conditional_logic: JSON (Conditional branching logic)
- is_active: BOOLEAN (Default: TRUE)
- is_default: BOOLEAN (Default: FALSE)
- version: INTEGER (Default: 1)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_workflow_company_name (workflow_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_workflow_type (workflow_type)
- INDEX idx_trigger_event (trigger_event)
- INDEX idx_is_active (is_active)
- INDEX idx_is_default (is_default)
- INDEX idx_version (version)

Constraints:
- fk_hr_workflow_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_workflow_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_workflow_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_approval_levels_positive CHECK (approval_levels > 0)
- chk_version_positive CHECK (version > 0)
```

--- END OF SECTION 13.5.2 ---

## 13.5.3 Email & Notification Template Schema

```
Table: hr_email_template
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- template_name: VARCHAR(200) (Required, Unique, Indexed)
- template_category: ENUM('Leave Management', 'Performance Review', 'Recruitment', 'Onboarding', 'Offboarding', 'Payroll', 'Benefits', 'System Notifications', 'Compliance', 'General HR')
- template_type: ENUM('HTML', 'Text', 'Both')
- subject_template: VARCHAR(500) (Required)
- body_template: TEXT (Required)
- template_variables: JSON (Variables that can be substituted)
- default_language: VARCHAR(10) (Default: 'en')
- is_system_template: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- approval_required: BOOLEAN (Default: FALSE)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- version: INTEGER (Default: 1)
- usage_count: INTEGER (Default: 0)
- last_used_at: TIMESTAMP
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_email_template_company_name (template_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_template_category (template_category)
- INDEX idx_template_type (template_type)
- INDEX idx_is_system_template (is_system_template)
- INDEX idx_is_active (is_active)
- INDEX idx_default_language (default_language)
- INDEX idx_usage_count (usage_count)

Constraints:
- fk_hr_email_template_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_email_template_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- fk_hr_email_template_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_email_template_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_usage_count_positive CHECK (usage_count >= 0)
- chk_version_positive CHECK (version > 0)
```

```
Table: hr_notification_rule
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- rule_name: VARCHAR(200) (Required, Unique, Indexed)
- rule_category: ENUM('System Events', 'User Actions', 'Workflow Events', 'Compliance Events', 'Performance Events', 'Recruitment Events')
- trigger_event: VARCHAR(200) (Required)
- trigger_conditions: JSON (Conditions that trigger this notification)
- notification_channels: JSON (Email, SMS, In-App, Push, Webhook)
- recipient_rules: JSON (Who receives the notification)
- template_mapping: JSON (Which template to use for each channel)
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- frequency_limits: JSON (How often this notification can be sent)
- quiet_hours: JSON (Time periods when notifications are suppressed)
- escalation_rules: JSON (When and how to escalate notifications)
- is_active: BOOLEAN (Default: TRUE)
- is_system_rule: BOOLEAN (Default: FALSE)
- test_mode: BOOLEAN (Default: FALSE)
- last_triggered_at: TIMESTAMP
- trigger_count: INTEGER (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_notification_rule_company_name (rule_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_rule_category (rule_category)
- INDEX idx_trigger_event (trigger_event)
- INDEX idx_priority_level (priority_level)
- INDEX idx_is_active (is_active)
- INDEX idx_is_system_rule (is_system_rule)
- INDEX idx_last_triggered_at (last_triggered_at)

Constraints:
- fk_hr_notification_rule_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_notification_rule_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_notification_rule_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_trigger_count_positive CHECK (trigger_count >= 0)
```

--- END OF SECTION 13.5.3 ---

## 13.5.4 HR System Governance & Access Control Schema

```
Table: hr_system_role_permission
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- role_name: VARCHAR(100) (Required, Unique, Indexed)
- role_description: TEXT
- role_type: ENUM('SYSTEM_ADMIN', 'HR_ADMIN', 'CONFIG_ADMIN', 'WORKFLOW_ADMIN', 'TEMPLATE_ADMIN', 'NOTIFICATION_ADMIN', 'SECURITY_ADMIN', 'COMPLIANCE_ADMIN', 'REPORT_VIEWER', 'AUDITOR')
- can_manage_system_config: BOOLEAN (Default: FALSE)
- can_manage_workflows: BOOLEAN (Default: FALSE)
- can_manage_templates: BOOLEAN (Default: FALSE)
- can_manage_notifications: BOOLEAN (Default: FALSE)
- can_manage_integrations: BOOLEAN (Default: FALSE)
- can_manage_security: BOOLEAN (Default: FALSE)
- can_manage_compliance: BOOLEAN (Default: FALSE)
- can_view_audit_logs: BOOLEAN (Default: FALSE)
- can_export_data: BOOLEAN (Default: FALSE)
- can_import_data: BOOLEAN (Default: FALSE)
- can_manage_backups: BOOLEAN (Default: FALSE)
- can_system_maintenance: BOOLEAN (Default: FALSE)
- can_view_system_metrics: BOOLEAN (Default: FALSE)
- can_manage_user_access: BOOLEAN (Default: FALSE)
- data_access_level: ENUM('ALL', 'COMPANY', 'DEPARTMENT', 'TEAM', 'OWN', 'NONE')
- is_system_role: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_system_role_company_name (role_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_role_type (role_type)
- INDEX idx_is_system_role (is_system_role)
- INDEX idx_is_active (is_active)
- INDEX idx_data_access_level (data_access_level)

Constraints:
- fk_hr_system_role_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_system_role_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
```

```
Table: hr_system_user_role_assignment
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- role_id: UUID (Foreign Key to hr_system_role_permission)
- company_id: UUID (Foreign Key to company)
- department_id: UUID (Foreign Key to department)
- team_id: UUID (Foreign Key to team)
- assigned_by_user_id: UUID (Foreign Key to user)
- assigned_date: TIMESTAMP (Auto)
- expiry_date: DATE
- is_active: BOOLEAN (Default: TRUE)
- assignment_notes: TEXT
- security_clearance_level: ENUM('Basic', 'Standard', 'Enhanced', 'Top Secret')
- system_admin_training_required: BOOLEAN (Default: FALSE)
- system_admin_training_status: ENUM('Not Required', 'Pending', 'Certified', 'Expired')
- configuration_permissions: JSON (Specific configuration permissions)
- workflow_permissions: JSON (Specific workflow management permissions)
- template_permissions: JSON (Specific template management permissions)
- integration_permissions: JSON (Specific integration management permissions)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_system_user_role_company (user_id, role_id, company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_role_id (role_id)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_team_id (team_id)
- INDEX idx_is_active (is_active)
- INDEX idx_expiry_date (expiry_date)
- INDEX idx_security_clearance_level (security_clearance_level)

Constraints:
- fk_hr_system_user_role_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_hr_system_user_role_role FOREIGN KEY (role_id) REFERENCES hr_system_role_permission(id)
- fk_hr_system_user_role_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_system_user_role_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_hr_system_user_role_team FOREIGN KEY (team_id) REFERENCES team(id)
- fk_hr_system_user_role_assigned_by FOREIGN KEY (assigned_by_user_id) REFERENCES user(id)
```

--- END OF SECTION 13.5.4 ---

## 13.5.5 System Integration & Audit Performance Schema

```
Table: hr_system_integration
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- integration_name: VARCHAR(200) (Required, Unique, Indexed)
- integration_type: ENUM('API Integration', 'Database Link', 'File Transfer', 'Webhook', 'Email Gateway', 'SMS Gateway', 'Payment Gateway', 'Biometric System', 'Time Tracking', 'Active Directory')
- integration_category: ENUM('Third Party HR', 'Payroll System', 'Benefits Provider', 'Time Attendance', 'Recruitment Platform', 'Learning Management', 'Communication Tool', 'Security System')
- integration_description: TEXT
- endpoint_url: VARCHAR(500)
- api_version: VARCHAR(20) (Default: 'v1')
- authentication_type: ENUM('API Key', 'OAuth 2.0', 'Basic Auth', 'JWT', 'Certificate', 'SAML', 'Custom')
- authentication_config: JSON (Encrypted authentication credentials)
- data_format: ENUM('JSON', 'XML', 'CSV', 'Fixed Width', 'Custom')
- sync_frequency: ENUM('Real-time', 'Every 5 mins', 'Every 15 mins', 'Hourly', 'Daily', 'Weekly', 'On-demand')
- sync_direction: ENUM('Bidirectional', 'Inbound Only', 'Outbound Only')
- is_active: BOOLEAN (Default: TRUE)
- connection_status: ENUM('Connected', 'Disconnected', 'Error', 'Testing', 'Maintenance')
- last_sync_at: TIMESTAMP
- last_successful_sync_at: TIMESTAMP
- error_count: INTEGER (Default: 0)
- max_retry_attempts: INTEGER (Default: 3)
- timeout_seconds: INTEGER (Default: 30)
- rate_limit_per_hour: INTEGER (Default: 1000)
- field_mappings: JSON (Field mapping between systems)
- validation_rules: JSON (Data validation rules)
- transformation_rules: JSON (Data transformation logic)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_integration_company_name (integration_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_integration_type (integration_type)
- INDEX idx_integration_category (integration_category)
- INDEX idx_is_active (is_active)
- INDEX idx_connection_status (connection_status)
- INDEX idx_last_sync_at (last_sync_at)
- INDEX idx_last_successful_sync_at (last_successful_sync_at)

Constraints:
- fk_hr_integration_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_integration_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_integration_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_error_count_valid CHECK (error_count >= 0 AND error_count <= max_retry_attempts)
- chk_positive_values CHECK (timeout_seconds > 0 AND rate_limit_per_hour > 0 AND max_retry_attempts >= 0)
```

```
Table: hr_system_audit_trail
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- integration_id: UUID (Foreign Key to hr_system_integration)
- audit_type: ENUM('Configuration Change', 'User Access', 'System Integration', 'Workflow Update', 'Template Change', 'Security Event', 'Data Import', 'Data Export', 'System Maintenance', 'Backup Operation')
- action: ENUM('Create', 'Update', 'Delete', 'Activate', 'Deactivate', 'Sync', 'Import', 'Export', 'Login', 'Logout', 'Approve', 'Reject', 'Execute')
- entity_type: ENUM('System Config', 'Workflow Config', 'Email Template', 'Notification Rule', 'User Role', 'Integration', 'Security Setting', 'Audit Log')
- entity_id: UUID
- old_values: JSON (Previous values before change)
- new_values: JSON (New values after change)
- field_changes: JSON (Specific field changes)
- action_reason: TEXT
- business_justification: TEXT
- impact_assessment: TEXT
- risk_level: ENUM('Low', 'Medium', 'High', 'Critical')
- affected_modules: JSON (HR modules affected by this change)
- system_impact: TEXT (Description of system impact)
- rollback_available: BOOLEAN (Default: FALSE)
- rollback_deadline: TIMESTAMP
- performed_by_user_id: UUID (Foreign Key to user)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- session_id: VARCHAR(100)
- timestamp: TIMESTAMP (Auto)
- additional_context: JSON (Extra context information)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_integration_id (integration_id)
- INDEX idx_audit_type (audit_type)
- INDEX idx_action (action)
- INDEX idx_entity_type (entity_type)
- INDEX idx_risk_level (risk_level)
- INDEX idx_performed_by_user_id (performed_by_user_id)
- INDEX idx_timestamp (timestamp)
- INDEX idx_rollback_available (rollback_available)

Constraints:
- fk_hr_audit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_audit_integration FOREIGN KEY (integration_id) REFERENCES hr_system_integration(id)
- fk_hr_audit_performed_by FOREIGN KEY (performed_by_user_id) REFERENCES user(id)
```

--- END OF SECTION 13.5.5 ---

## 13.5.6 System Compliance & Reporting Schema

```
Table: hr_compliance_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- compliance_type: ENUM('Data Privacy', 'Security Standards', 'Industry Regulations', 'Legal Requirements', 'Internal Policies', 'Audit Requirements', 'System Compliance')
- compliance_category: ENUM('GDPR', 'CCPA', 'SOX', 'HIPAA', 'ISO 27001', 'SOC 2', 'Industry Specific', 'Company Policy')
- compliance_code: VARCHAR(50) (Required, Indexed)
- regulation_name: VARCHAR(200) (Required)
- jurisdiction: VARCHAR(100) (Required)
- compliance_requirements: JSON (Specific compliance requirements)
- reporting_requirements: JSON (Reporting and disclosure requirements)
- notification_requirements: JSON (Employee notification requirements)
- data_retention_period: INTEGER (Days to retain data)
- audit_frequency: ENUM('Daily', 'Weekly', 'Monthly', 'Quarterly', 'Annually', 'On-demand')
- certification_requirements: JSON (Certification and training requirements)
- documentation_requirements: JSON (Documentation and record-keeping)
- monitoring_rules: JSON (Continuous monitoring requirements)
- violation_handling: JSON (How to handle compliance violations)
- is_active: BOOLEAN (Default: TRUE)
- effective_date: DATE (Required)
- expiry_date: DATE
- last_audit_date: DATE
- next_audit_date: DATE
- compliance_score: DECIMAL(5,2) (Percentage)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_compliance_type (compliance_type)
- INDEX idx_compliance_category (compliance_category)
- INDEX idx_compliance_code (compliance_code)
- INDEX idx_jurisdiction (jurisdiction)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_date (effective_date)
- INDEX idx_next_audit_date (next_audit_date)
- INDEX idx_compliance_score (compliance_score)

Constraints:
- fk_hr_compliance_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_compliance_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_compliance_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (data_retention_period > 0)
- chk_effective_order CHECK (expiry_date IS NULL OR expiry_date >= effective_date)
- chk_score_range CHECK (compliance_score BETWEEN 0 AND 100)
```

```
Table: hr_system_report
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- report_name: VARCHAR(200) (Required, Unique, Indexed)
- report_type: ENUM('System Usage', 'Security Audit', 'Compliance Report', 'Performance Metrics', 'User Activity', 'Integration Status', 'Configuration Summary', 'Change Management', 'Backup Status', 'System Health')
- report_category: ENUM('Executive', 'Operational', 'Technical', 'Compliance', 'Security', 'Performance')
- report_description: TEXT
- report_frequency: ENUM('Real-time', 'Daily', 'Weekly', 'Monthly', 'Quarterly', 'Annually', 'On-demand')
- data_source: JSON (Data sources for the report)
- report_format: ENUM('PDF', 'Excel', 'CSV', 'XML', 'JSON', 'HTML')
- delivery_method: ENUM('Email', 'Portal', 'API', 'SFTP', 'Manual Download')
- recipient_roles: JSON (Roles that receive this report)
- distribution_list: JSON (Email distribution list)
- template_config: JSON (Report template configuration)
- scheduling_config: JSON (Automated scheduling settings)
- approval_workflow_id: UUID (Foreign Key to approval_workflow)
- auto_generate: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- last_generated_at: TIMESTAMP
- next_generation_date: TIMESTAMP
- generation_count: INTEGER (Default: 0)
- file_size_kb: DECIMAL(10,2)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_report_company_name (report_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_report_type (report_type)
- INDEX idx_report_category (report_category)
- idx_report_frequency (report_frequency)
- idx_is_active (is_active)
- INDEX idx_last_generated_at (last_generated_at)
- INDEX idx_next_generation_date (next_generation_date)
- INDEX idx_generation_count (generation_count)

Constraints:
- fk_hr_report_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_report_approval_workflow FOREIGN KEY (approval_workflow_id) REFERENCES approval_workflow(id)
- fk_hr_report_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_report_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_generation_count_positive CHECK (generation_count >= 0)
- chk_file_size_positive CHECK (file_size_kb >= 0)
```

--- END OF SECTION 13.5.6 ---

## 13.5.7 System Analytics & Insights Schema

```
Table: hr_system_analytics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- analytics_date: DATE (Required)
- dashboard_type: ENUM('Executive', 'Operational', 'Technical', 'Security', 'Compliance', 'Performance', 'User Activity', 'Integration Status')
- report_date: DATE (Required)
- total_configurations: INTEGER (Default: 0)
- active_configurations: INTEGER (Default: 0)
- system_uptime_percentage: DECIMAL(5,2) (Default: 99.9)
- api_response_time_avg_ms: INTEGER (Default: 200)
- database_response_time_avg: INTEGER (Default: 100)
- user_sessions_count: INTEGER (Default: 0)
- active_user_sessions: INTEGER (Default: 0)
- failed_logins: INTEGER (Default: 0)
- configuration_changes: INTEGER (Default: 0)
- workflow_executions: INTEGER (Default: 0)
- email_notifications_sent: INTEGER (Default: 0)
- data_imports_processed: INTEGER (Default: 0)
- data_exports_generated: INTEGER (Default: 0)
- integration_syncs_completed: INTEGER (Default: 0)
- backup_operations: INTEGER (Default: 0)
- security_events: INTEGER (Default: 0)
- compliance_violations: INTEGER (Default: 0)
- system_errors: INTEGER (Default: 0)
- performance_score: DECIMAL(5,2) (Overall system health score)
- user_satisfaction_score: DECIMAL(5,2) (User satisfaction metrics)
- system_utilization_rate: DECIMAL(5,2) (Percentage of features used)
- storage_utilization_percentage: DECIMAL(5,2)
- memory_usage_percentage: DECIMAL(5,2)
- cpu_usage_percentage: DECIMAL (5,2)
- network_latency_ms: INTEGER
- disk_io_wait_ms: INTEGER
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_analytics_date (analytics_date)
- INDEX idx_dashboard_type (dashboard_type)
- INDEX idx_report_date (report_date)
- INDEX idx_total_configurations (total_configurations)
- INDEX idx_active_configurations (active_configurations)
- INDEX idx_system_uptime_percentage (system_uptime_percentage)
- INDEX idx_api_response_time_avg (api_response_time_avg)
- INDEX idx_user_sessions_count (user_sessions_count)
- INDEX idx_performance_score (performance_score)
- INDEX idx_user_satisfaction_score (user_satisfaction_score)

Constraints:
- fk_hr_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_analytics_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_uptime_range CHECK (system_uptime_percentage BETWEEN 0 AND 100)
- chk_performance_range CHECK (performance_score BETWEEN 0 AND 100)
- chk_satisfaction_range CHECK (user_satisfaction_score BETWEEN 0 AND 100)
- chk_utilization_range CHECK (system_utilization_rate BETWEEN 0 AND 100)
```

```
Table: hr_system_performance_metrics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- metric_date: DATE (Required)
- metric_category: ENUM('Database Performance', 'API Performance', 'User Experience', 'Integration Performance', 'System Resources', 'Security Metrics', 'Backup Performance')
- metric_name: VARCHAR(200) (Required, Indexed)
- metric_value: DECIMAL(15,2)
- metric_unit: VARCHAR(50) (Default: 'ms')
- baseline_value: DECIMAL(15,2)
- target_value: DECIMAL(15,2)
- performance_trend: ENUM('Improving', 'Declining', 'Stable', 'Volatile')
- alert_threshold_min: DECIMAL(15,2)
- alert_threshold_max: DECIMAL(15,2)
- is_critical_metric: BOOLEAN (Default: FALSE)
- sla_requirement: VARCHAR(200)
- current_sla_status: ENUM('Compliant', 'Warning', 'Non-Compliant', 'Not Applicable')
- historical_data: JSON (Last 30 days of data points)
- benchmark_comparison: DECIMAL(5,2) (Industry benchmark comparison)
- impact_assessment: TEXT (Business impact of this metric)
- recommended_actions: JSON (Recommended improvement actions)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_metric_date (metric_date)
- INDEX idx_metric_category (metric_category)
- INDEX idx_metric_name (metric_name)
- INDEX idx_metric_value (metric_value)
- INDEX idx_is_critical_metric (is_critical_metric)
- INDEX idx_current_sla_status (current_sla_status)
- INDEX idx_performance_trend (performance_trend)

Constraints:
- fk_hr_performance_company FOREIGN KEY (company_id) REFERENCES company(id)
- chk_value_range CHECK (metric_value >= 0 AND baseline_value >= 0 AND target_value >= 0)
- chk_threshold_order CHECK (alert_threshold_min <= alert_threshold_max)
```

--- END OF SECTION 13.5.7 ---

## 13.5.8 System Communication & Notification Schema

```
Table: hr_system_communication_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- communication_type: ENUM('Email', 'SMS', 'In-App', 'Push Notification', 'Webhook', 'API Call', 'System Alert')
- communication_category: ENUM('System Notification', 'User Alert', 'Compliance Alert', 'Security Alert', 'Performance Alert', 'Integration Alert', 'Backup Alert', 'Maintenance Alert')
- recipient_type: ENUM('User', 'Role', 'Department', 'Team', 'All Users', 'External System', 'Admin Group')
- recipient_id: UUID (Foreign Key to user or role)
- recipient_email: VARCHAR(500)
- recipient_phone: VARCHAR(50)
- subject: VARCHAR(500)
- message_content: TEXT
- template_id: UUID (Foreign Key to hr_email_template)
- notification_rule_id: UUID (Foreign Key to hr_notification_rule)
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- delivery_status: ENUM('Pending', 'Sent', 'Delivered', 'Failed', 'Bounced', 'Opened', 'Clicked')
- delivery_attempts: INTEGER (Default: 0)
- max_delivery_attempts: INTEGER (Default: 3)
- sent_at: TIMESTAMP
- delivered_at: TIMESTAMP
- opened_at: TIMESTAMP
- clicked_at: TIMESTAMP
- failed_at: TIMESTAMP
- failure_reason: TEXT
- response_data: JSON (Webhook or API response data)
- tracking_id: VARCHAR(100) (Unique tracking identifier)
- campaign_id: VARCHAR(100) (For grouped communications)
- is_system_generated: BOOLEAN (Default: TRUE)
- requires_acknowledgment: BOOLEAN (Default: FALSE)
- acknowledged_at: TIMESTAMP
- acknowledged_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_communication_type (communication_type)
- INDEX idx_communication_category (communication_category)
- INDEX idx_recipient_type (recipient_type)
- INDEX idx_recipient_id (recipient_id)
- INDEX idx_priority_level (priority_level)
- INDEX idx_delivery_status (delivery_status)
- INDEX idx_sent_at (sent_at)
- INDEX idx_delivered_at (delivered_at)
- INDEX idx_tracking_id (tracking_id)
- INDEX idx_campaign_id (campaign_id)

Constraints:
- fk_hr_communication_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_communication_template FOREIGN KEY (template_id) REFERENCES hr_email_template(id)
- fk_hr_communication_rule FOREIGN KEY (notification_rule_id) REFERENCES hr_notification_rule(id)
- fk_hr_communication_recipient FOREIGN KEY (recipient_id) REFERENCES user(id)
- fk_hr_communication_acknowledged_by FOREIGN KEY (acknowledged_by_user_id) REFERENCES user(id)
- chk_delivery_attempts_valid CHECK (delivery_attempts >= 0 AND delivery_attempts <= max_delivery_attempts)
- chk_max_attempts_positive CHECK (max_delivery_attempts > 0)
```

```
Table: hr_system_alert
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- alert_name: VARCHAR(200) (Required, Unique, Indexed)
- alert_type: ENUM('System Health', 'Security', 'Performance', 'Compliance', 'Integration', 'Backup', 'Maintenance', 'User Activity', 'Data Integrity')
- alert_category: ENUM('Critical', 'Warning', 'Information', 'Success')
- alert_description: TEXT
- trigger_condition: JSON (Conditions that trigger this alert)
- severity_level: ENUM('Low', 'Medium', 'High', 'Critical', 'Emergency')
- notification_channels: JSON (How to send notifications)
- escalation_rules: JSON (When and how to escalate)
- auto_resolution_rules: JSON (Automatic resolution conditions)
- is_active: BOOLEAN (Default: TRUE)
- is_system_alert: BOOLEAN (Default: FALSE)
- requires_immediate_action: BOOLEAN (Default: FALSE)
- cooldown_period_minutes: INTEGER (Default: 60)
- max_alerts_per_hour: INTEGER (Default: 10)
- last_triggered_at: TIMESTAMP
- trigger_count: INTEGER (Default: 0)
- resolved_count: INTEGER (Default: 0)
- false_positive_count: INTEGER (Default: 0)
- average_resolution_time_minutes: INTEGER (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_alert_company_name (alert_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_alert_type (alert_type)
- INDEX idx_alert_category (alert_category)
- INDEX idx_severity_level (severity_level)
- INDEX idx_is_active (is_active)
- INDEX idx_is_system_alert (is_system_alert)
- INDEX idx_last_triggered_at (last_triggered_at)
- INDEX idx_trigger_count (trigger_count)

Constraints:
- fk_hr_alert_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_alert_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_alert_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_cooldown_positive CHECK (cooldown_period_minutes >= 0)
- chk_max_alerts_positive CHECK (max_alerts_per_hour > 0)
- chk_counts_valid CHECK (trigger_count >= 0 AND resolved_count >= 0 AND false_positive_count >= 0)
```

--- END OF SECTION 13.5.8 ---

## 13.5.9 User Preferences & Personalization Schema

```
Table: hr_system_user_preferences
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- company_id: UUID (Foreign Key to company)
- preference_category: ENUM('Dashboard', 'Notifications', 'Interface', 'Reports', 'Workflows', 'Integrations', 'Security', 'Accessibility')
- preference_key: VARCHAR(200) (Required, Indexed)
- preference_value: TEXT
- preference_type: ENUM('String', 'Integer', 'Boolean', 'JSON', 'Array')
- default_value: TEXT
- is_system_default: BOOLEAN (Default: FALSE)
- is_user_customizable: BOOLEAN (Default: TRUE)
- requires_approval: BOOLEAN (Default: FALSE)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- last_modified_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_user_pref_user_category_key (user_id, preference_category, preference_key)
- INDEX idx_user_id (user_id)
- INDEX idx_company_id (company_id)
- INDEX idx_preference_category (preference_category)
- INDEX idx_preference_key (preference_key)
- INDEX idx_is_user_customizable (is_user_customizable)
- INDEX idx_updated_at (updated_at)

Constraints:
- fk_hr_user_pref_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_hr_user_pref_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_user_pref_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- fk_hr_user_pref_modified_by FOREIGN KEY (last_modified_by_user_id) REFERENCES user(id)
```

```
Table: hr_system_ui_customization
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- company_id: UUID (Foreign Key to company)
- customization_type: ENUM('Dashboard Layout', 'Menu Configuration', 'Widget Settings', 'Theme Settings', 'Language Settings', 'Timezone Settings', 'Date Format', 'Number Format')
- component_name: VARCHAR(200) (Required)
- customization_data: JSON (Customization configuration)
- is_active: BOOLEAN (Default: TRUE)
- is_default_for_role: BOOLEAN (Default: FALSE)
- applies_to_role_id: UUID (Foreign Key to hr_system_role_permission)
- applies_to_department_id: UUID (Foreign Key to department)
- applies_to_team_id: UUID (Foreign Key to team)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)
- INDEX idx_company_id (company_id)
- INDEX idx_customization_type (customization_type)
- INDEX idx_component_name (component_name)
- INDEX idx_is_active (is_active)
- INDEX idx_is_default_for_role (is_default_for_role)
- INDEX idx_applies_to_role_id (applies_to_role_id)
- INDEX idx_applies_to_department_id (applies_to_department_id)
- INDEX idx_applies_to_team_id (applies_to_team_id)

Constraints:
- fk_hr_ui_custom_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_hr_ui_custom_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_ui_custom_role FOREIGN KEY (applies_to_role_id) REFERENCES hr_system_role_permission(id)
- fk_hr_ui_custom_department FOREIGN KEY (applies_to_department_id) REFERENCES department(id)
- fk_hr_ui_custom_team FOREIGN KEY (applies_to_team_id) REFERENCES team(id)
- fk_hr_ui_custom_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_ui_custom_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
```

--- END OF SECTION 13.5.9 ---

## 13.5.10 Mobile & API Access Schema

```
Table: hr_system_api_access
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- api_key_name: VARCHAR(200) (Required, Unique, Indexed)
- api_key_hash: VARCHAR(500) (Required, Encrypted)
- api_key_type: ENUM('System Integration', 'Mobile App', 'Third Party', 'Webhook', 'Internal Service', 'Partner Integration')
- access_level: ENUM('Read Only', 'Read Write', 'Admin', 'Full Access')
- allowed_endpoints: JSON (List of allowed API endpoints)
- rate_limit_per_hour: INTEGER (Default: 1000)
- rate_limit_per_minute: INTEGER (Default: 100)
- ip_whitelist: JSON (Allowed IP addresses)
- domain_whitelist: JSON (Allowed domains)
- is_active: BOOLEAN (Default: TRUE)
- expires_at: TIMESTAMP
- last_used_at: TIMESTAMP
- usage_count: INTEGER (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- assigned_to_user_id: UUID (Foreign Key to user)
- assigned_to_role_id: UUID (Foreign Key to hr_system_role_permission)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_api_key_company_name (api_key_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_api_key_type (api_key_type)
- INDEX idx_access_level (access_level)
- INDEX idx_is_active (is_active)
- INDEX idx_expires_at (expires_at)
- INDEX idx_last_used_at (last_used_at)
- INDEX idx_usage_count (usage_count)
- INDEX idx_assigned_to_user_id (assigned_to_user_id)
- INDEX idx_assigned_to_role_id (assigned_to_role_id)

Constraints:
- fk_hr_api_access_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_api_access_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_api_access_assigned_user FOREIGN KEY (assigned_to_user_id) REFERENCES user(id)
- fk_hr_api_access_assigned_role FOREIGN KEY (assigned_to_role_id) REFERENCES hr_system_role_permission(id)
- chk_rate_limits_positive CHECK (rate_limit_per_hour > 0 AND rate_limit_per_minute > 0)
- chk_usage_count_positive CHECK (usage_count >= 0)
```

```
Table: hr_system_mobile_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- device_id: VARCHAR(200) (Required, Indexed)
- user_id: UUID (Foreign Key to user)
- device_type: ENUM('iOS', 'Android', 'Tablet', 'Mobile Web')
- app_version: VARCHAR(50)
- os_version: VARCHAR(50)
- device_name: VARCHAR(200)
- push_notification_token: VARCHAR(500)
- biometric_enabled: BOOLEAN (Default: FALSE)
- offline_mode_enabled: BOOLEAN (Default: FALSE)
- offline_sync_frequency: ENUM('Real-time', 'Every 5 mins', 'Every 15 mins', 'Hourly', 'Manual')
- allowed_features: JSON (Features accessible on mobile)
- security_settings: JSON (Mobile-specific security settings)
- is_active: BOOLEAN (Default: TRUE)
- is_trusted_device: BOOLEAN (Default: FALSE)
- last_login_at: TIMESTAMP
- last_sync_at: TIMESTAMP
- login_count: INTEGER (Default: 0)
- failed_login_attempts: INTEGER (Default: 0)
- locked_until: TIMESTAMP
- registered_at: TIMESTAMP (Auto)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_mobile_company_device (company_id, device_id)
- INDEX idx_company_id (company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_device_type (device_type)
- INDEX idx_is_active (is_active)
- INDEX idx_is_trusted_device (is_trusted_device)
- INDEX idx_last_login_at (last_login_at)
- INDEX idx_last_sync_at (last_sync_at)
- INDEX idx_login_count (login_count)
- INDEX idx_registered_at (registered_at)

Constraints:
- fk_hr_mobile_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_mobile_config_user FOREIGN KEY (user_id) REFERENCES user(id)
- chk_login_count_positive CHECK (login_count >= 0)
- chk_failed_attempts_valid CHECK (failed_login_attempts >= 0)
```

--- END OF SECTION 13.5.10 ---

## 13.5.11 System Security & Compliance Schema

```
Table: hr_system_security_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- security_category: ENUM('Authentication', 'Authorization', 'Data Protection', 'Network Security', 'Session Management', 'Password Policy', 'Multi-Factor Auth', 'Encryption Settings')
- security_setting: VARCHAR(200) (Required, Indexed)
- security_value: TEXT
- security_type: ENUM('Boolean', 'Integer', 'String', 'JSON', 'Encrypted')
- default_value: TEXT
- description: TEXT
- is_system_setting: BOOLEAN (Default: FALSE)
- is_encrypted: BOOLEAN (Default: FALSE)
- validation_rule: TEXT
- min_value: INTEGER
- max_value: INTEGER
- allowed_values: JSON
- requires_restart: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- last_modified_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_security_company_category_setting (company_id, security_category, security_setting)
- INDEX idx_company_id (company_id)
- INDEX idx_security_category (security_category)
- INDEX idx_security_setting (security_setting)
- INDEX idx_is_system_setting (is_system_setting)
- INDEX idx_is_active (is_active)
- INDEX idx_updated_at (updated_at)

Constraints:
- fk_hr_security_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_security_config_modified_by FOREIGN KEY (last_modified_by_user_id) REFERENCES user(id)
- chk_value_range CHECK (min_value IS NULL OR max_value IS NULL OR min_value <= max_value)
```

```
Table: hr_system_security_audit
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- audit_type: ENUM('Security Incident', 'Access Violation', 'Data Breach', 'Unauthorized Access', 'Configuration Change', 'Security Policy Violation', 'Malware Detection', 'Suspicious Activity')
- severity_level: ENUM('Low', 'Medium', 'High', 'Critical', 'Emergency')
- incident_title: VARCHAR(500) (Required)
- incident_description: TEXT
- affected_systems: JSON (Systems affected by the incident)
- affected_data: JSON (Data types affected)
- detected_at: TIMESTAMP (Required)
- reported_by_user_id: UUID (Foreign Key to user)
- incident_status: ENUM('Open', 'Investigating', 'Contained', 'Resolved', 'Closed', 'False Positive')
- resolution_details: TEXT
- impact_assessment: TEXT
- root_cause_analysis: TEXT
- preventive_measures: JSON (Measures taken to prevent recurrence)
- compliance_violations: JSON (Any compliance regulations violated)
- notification_sent: BOOLEAN (Default: FALSE)
- notification_recipients: JSON (Who was notified about the incident)
- resolved_by_user_id: UUID (Foreign Key to user)
- resolved_at: TIMESTAMP
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_audit_type (audit_type)
- INDEX idx_severity_level (severity_level)
- INDEX idx_detected_at (detected_at)
- INDEX idx_incident_status (incident_status)
- INDEX idx_reported_by_user_id (reported_by_user_id)
- INDEX idx_resolved_by_user_id (resolved_by_user_id)
- INDEX idx_resolved_at (resolved_at)

Constraints:
- fk_hr_security_audit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_security_audit_reported_by FOREIGN KEY (reported_by_user_id) REFERENCES user(id)
- fk_hr_security_audit_resolved_by FOREIGN KEY (resolved_by_user_id) REFERENCES user(id)
```

--- END OF SECTION 13.5.11 ---

## 13.5.12 Workflow & Process Automation Schema

```
Table: hr_system_automation_rule
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- rule_name: VARCHAR(200) (Required, Unique, Indexed)
- rule_category: ENUM('Data Processing', 'User Management', 'System Maintenance', 'Compliance Monitoring', 'Report Generation', 'Notification Management', 'Integration Sync', 'Backup Operations')
- trigger_event: VARCHAR(200) (Required)
- trigger_conditions: JSON (Conditions that trigger the automation)
- automation_actions: JSON (Actions to be executed)
- execution_order: INTEGER (Default: 1)
- execution_frequency: ENUM('One-time', 'Recurring', 'Event-driven', 'Scheduled')
- schedule_config: JSON (Scheduling configuration for recurring rules)
- retry_policy: JSON (Retry configuration on failure)
- timeout_seconds: INTEGER (Default: 300)
- max_execution_time_minutes: INTEGER (Default: 60)
- is_active: BOOLEAN (Default: TRUE)
- is_system_rule: BOOLEAN (Default: FALSE)
- requires_approval: BOOLEAN (Default: FALSE)
- approval_workflow_id: UUID (Foreign Key to approval_workflow)
- last_executed_at: TIMESTAMP
- next_execution_at: TIMESTAMP
- execution_count: INTEGER (Default: 0)
- success_count: INTEGER (Default: 0)
- failure_count: INTEGER (Default: 0)
- average_execution_time_seconds: INTEGER (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_automation_company_name (rule_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_rule_category (rule_category)
- INDEX idx_trigger_event (trigger_event)
- INDEX idx_is_active (is_active)
- INDEX idx_is_system_rule (is_system_rule)
- INDEX idx_last_executed_at (last_executed_at)
- INDEX idx_next_execution_at (next_execution_at)
- INDEX idx_execution_count (execution_count)

Constraints:
- fk_hr_automation_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_automation_approval_workflow FOREIGN KEY (approval_workflow_id) REFERENCES approval_workflow(id)
- fk_hr_automation_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_automation_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_execution_order_positive CHECK (execution_order > 0)
- chk_timeout_positive CHECK (timeout_seconds > 0 AND max_execution_time_minutes > 0)
- chk_counts_valid CHECK (execution_count >= 0 AND success_count >= 0 AND failure_count >= 0)
```

```
Table: hr_system_automation_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- automation_rule_id: UUID (Foreign Key to hr_system_automation_rule)
- execution_id: VARCHAR(100) (Required, Indexed)
- execution_status: ENUM('Started', 'Running', 'Completed', 'Failed', 'Cancelled', 'Timeout')
- trigger_data: JSON (Data that triggered the execution)
- execution_context: JSON (Context information during execution)
- actions_executed: JSON (List of actions executed)
- execution_results: JSON (Results of each action)
- error_details: JSON (Error information if failed)
- execution_start_time: TIMESTAMP (Required)
- execution_end_time: TIMESTAMP
- execution_duration_seconds: INTEGER
- resource_usage: JSON (CPU, memory, and other resource usage)
- affected_records: INTEGER (Number of records affected)
- notification_sent: BOOLEAN (Default: FALSE)
- rollback_executed: BOOLEAN (Default: FALSE)
- rollback_details: JSON (Rollback execution details)
- executed_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_automation_rule_id (automation_rule_id)
- INDEX idx_execution_id (execution_id)
- INDEX idx_execution_status (execution_status)
- INDEX idx_execution_start_time (execution_start_time)
- INDEX idx_execution_end_time (execution_end_time)
- INDEX idx_executed_by_user_id (executed_by_user_id)

Constraints:
- fk_hr_automation_log_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_automation_log_rule FOREIGN KEY (automation_rule_id) REFERENCES hr_system_automation_rule(id)
- fk_hr_automation_log_executed_by FOREIGN KEY (executed_by_user_id) REFERENCES user(id)
- chk_duration_positive CHECK (execution_duration_seconds >= 0)
- chk_affected_records_positive CHECK (affected_records >= 0)
```

--- END OF SECTION 13.5.12 ---

## 13.5.13 Data Archival & Retention Schema

```
Table: hr_system_archival_policy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- policy_name: VARCHAR(200) (Required, Unique, Indexed)
- policy_category: ENUM('User Data', 'Configuration Data', 'Audit Logs', 'Communication Logs', 'Analytics Data', 'Backup Data', 'Integration Data', 'Security Logs')
- data_type: VARCHAR(200) (Required)
- retention_period_days: INTEGER (Required)
- archival_trigger: ENUM('Age-based', 'Event-based', 'Manual', 'Scheduled', 'Storage Threshold')
- archival_conditions: JSON (Conditions for archival)
- archival_destination: ENUM('Cold Storage', 'Archive Database', 'File System', 'Cloud Storage', 'Tape Backup')
- compression_enabled: BOOLEAN (Default: TRUE)
- encryption_enabled: BOOLEAN (Default: TRUE)
- access_restrictions: JSON (Who can access archived data)
- retrieval_process: JSON (How to retrieve archived data)
- compliance_requirements: JSON (Legal and compliance requirements)
- is_active: BOOLEAN (Default: TRUE)
- is_system_policy: BOOLEAN (Default: FALSE)
- last_archived_at: TIMESTAMP
- next_archival_at: TIMESTAMP
- archived_records_count: INTEGER (Default: 0)
- storage_saved_mb: DECIMAL(15,2) (Default: 0)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_hr_archival_company_name (policy_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_policy_category (policy_category)
- INDEX idx_data_type (data_type)
- INDEX idx_retention_period_days (retention_period_days)
- INDEX idx_archival_trigger (archival_trigger)
- INDEX idx_is_active (is_active)
- INDEX idx_last_archived_at (last_archived_at)
- INDEX idx_next_archival_at (next_archival_at)

Constraints:
- fk_hr_archival_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_archival_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_hr_archival_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (retention_period_days > 0)
- chk_records_count_positive CHECK (archived_records_count >= 0)
- chk_storage_saved_positive CHECK (storage_saved_mb >= 0)
```

```
Table: hr_system_archival_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- archival_policy_id: UUID (Foreign Key to hr_system_archival_policy)
- archival_batch_id: VARCHAR(100) (Required, Indexed)
- archival_status: ENUM('Started', 'Running', 'Completed', 'Failed', 'Cancelled', 'Partial')
- source_table: VARCHAR(200) (Required)
- records_processed: INTEGER (Default: 0)
- records_archived: INTEGER (Default: 0)
- records_failed: INTEGER (Default: 0)
- data_size_before_mb: DECIMAL(15,2) (Default: 0)
- data_size_after_mb: DECIMAL(15,2) (Default: 0)
- compression_ratio: DECIMAL(5,2) (Compression percentage achieved)
- archival_location: VARCHAR(500) (Location where data was archived)
- checksum_verification: BOOLEAN (Default: FALSE)
- integrity_check_passed: BOOLEAN (Default: FALSE)
- error_details: JSON (Error information if failed)
- archival_start_time: TIMESTAMP (Required)
- archival_end_time: TIMESTAMP
- archival_duration_minutes: INTEGER
- storage_cost_savings: DECIMAL(15,2) (Monthly cost savings)
- compliance_verified: BOOLEAN (Default: FALSE)
- notified_stakeholders: BOOLEAN (Default: FALSE)
- rollback_available: BOOLEAN (Default: FALSE)
- rollback_deadline: TIMESTAMP
- executed_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_archival_policy_id (archival_policy_id)
- INDEX idx_archival_batch_id (archival_batch_id)
- INDEX idx_archival_status (archival_status)
- INDEX idx_source_table (source_table)
- INDEX idx_archival_start_time (archival_start_time)
- INDEX idx_archival_end_time (archival_end_time)
- INDEX idx_executed_by_user_id (executed_by_user_id)

Constraints:
- fk_hr_archival_log_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_hr_archival_log_policy FOREIGN KEY (archival_policy_id) REFERENCES hr_system_archival_policy(id)
- fk_hr_archival_log_executed_by FOREIGN KEY (executed_by_user_id) REFERENCES user(id)
- chk_records_processed_positive CHECK (records_processed >= 0)
- chk_records_archived_positive CHECK (records_archived >= 0)
- chk_records_failed_positive CHECK (records_failed >= 0)
- chk_data_sizes_positive CHECK (data_size_before_mb >= 0 AND data_size_after_mb >= 0)
- chk_compression_ratio_valid CHECK (compression_ratio BETWEEN 0 AND 100)
- chk_duration_positive CHECK (archival_duration_minutes >= 0)
```

--- END OF SECTION 13.5.13 ---
