# 13.2 Background Check Integration

## 13.2.1 Business Purpose & Scope

## 13.2.1.1 Business Purpose

Background Check Integration provides a comprehensive framework for seamless integration between the HR system and external background screening providers, ensuring efficient, compliant, and thorough candidate verification processes. This integration automates background check requests, tracks screening progress, manages compliance requirements, and maintains data integrity while reducing manual administrative overhead and ensuring consistent screening standards across the organization through automated workflows, real-time status updates, and comprehensive audit trails.

## 13.2.1.2 Business Scope

Enable comprehensive background check integration management including multi-provider support, automated screening requests, real-time status tracking, compliance monitoring, result management, candidate communication, workflow automation, reporting and analytics, and audit trail maintenance. The system supports various background check providers, custom screening packages, integration configurations, validation rules, approval workflows, compliance monitoring, and provides seamless integration with recruitment, onboarding, and compliance modules while ensuring data security, privacy, and regulatory compliance with FCRA, EEOC, and other applicable laws.

--- END OF SECTION 13.2.1 ---

## 13.2.2 Background Check Provider Configuration Schema

```
Table: background_check_provider_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_name: VARCHAR(200) (Required)
- provider_type: ENUM('Checkr', 'GoodHire', 'Accurate', 'Sterling', 'HireRight', 'Certiphi', 'First Advantage', 'Infomart', 'Custom API', 'SFTP', 'File Import')
- provider_code: VARCHAR(50) (Required, Unique, Indexed)
- integration_method: ENUM('API', 'SFTP', 'File Upload', 'Webhook', 'Database Link')
- api_endpoint_url: VARCHAR(500)
- api_version: VARCHAR(20) (Default: 'v1')
- authentication_type: ENUM('API Key', 'OAuth 2.0', 'Basic Auth', 'Certificate', 'SSH Key')
- authentication_config: JSON (Encrypted authentication credentials)
- data_format: ENUM('JSON', 'XML', 'CSV', 'Fixed Width', 'Excel')
- encoding_format: VARCHAR(20) (Default: 'UTF-8')
- sync_frequency: ENUM('Real-time', 'Every 15 mins', 'Hourly', 'Daily', 'Weekly', 'On-demand')
- sync_direction: ENUM('Bidirectional', 'Inbound Only', 'Outbound Only')
- is_primary_provider: BOOLEAN (Default: FALSE)
- is_active: BOOLEAN (Default: TRUE)
- connection_status: ENUM('Connected', 'Disconnected', 'Error', 'Testing', 'Maintenance')
- last_sync_at: TIMESTAMP
- last_successful_sync_at: TIMESTAMP
- error_count: INTEGER (Default: 0)
- max_retry_attempts: INTEGER (Default: 3)
- timeout_seconds: INTEGER (Default: 30)
- rate_limit_per_hour: INTEGER (Default: 1000)
- supported_check_types: JSON (Criminal, Education, Employment, Credit, Drug, MVR, Professional)
- field_mappings: JSON (Field mapping between HR and background check systems)
- validation_rules: JSON (Data validation rules)
- transformation_rules: JSON (Data transformation logic)
- compliance_settings: JSON (FCRA, EEOC, state-specific compliance)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_provider_company_code (provider_code, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_type (provider_type)
- INDEX idx_integration_method (integration_method)
- INDEX idx_is_primary_provider (is_primary_provider)
- INDEX idx_is_active (is_active)
- INDEX idx_connection_status (connection_status)
- INDEX idx_last_sync_at (last_sync_at)
- INDEX idx_last_successful_sync_at (last_successful_sync_at)

Constraints:
- fk_bg_check_provider_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_provider_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_provider_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_error_count_valid CHECK (error_count >= 0 AND error_count <= max_retry_attempts)
- chk_positive_values CHECK (timeout_seconds > 0 AND rate_limit_per_hour > 0 AND max_retry_attempts >= 0)
```

--- END OF SECTION 13.2.2 ---

## 13.2.3 Background Check Request & Result Schema

```
Table: background_check_request
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- candidate_id: UUID (Foreign Key to candidate)
- job_application_id: UUID (Foreign Key to job_application)
- request_number: VARCHAR(50) (Required, Unique, Indexed)
- request_type: ENUM('Pre-Employment', 'Post-Offer', 'Periodic', 'Promotion', 'Contract Renewal', 'Volunteer')
- screening_package: VARCHAR(200) (Required)
- check_types: JSON (Array of background check types to perform)
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- request_status: ENUM('Initiated', 'Submitted', 'In Progress', 'Completed', 'Failed', 'Cancelled', 'On Hold')
- initiated_by_user_id: UUID (Foreign Key to user)
- approved_by_user_id: UUID (Foreign Key to user)
- initiated_at: TIMESTAMP (Auto)
- submitted_at: TIMESTAMP
- completed_at: TIMESTAMP
- due_date: DATE
- estimated_completion_date: DATE
- candidate_consentiment: ENUM('Pending', 'Approved', 'Declined', 'Withdrawn')
- consent_obtained_at: TIMESTAMP
- consent_expires_at: TIMESTAMP
- cost_center_id: UUID (Foreign Key to cost_center)
- total_cost: DECIMAL(10,2) (Default: 0.00)
- currency_code: VARCHAR(3) (Default: 'USD')
- billing_method: ENUM('Company Paid', 'Candidate Paid', 'Shared')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_request_company_number (request_number, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_candidate_id (candidate_id)
- INDEX idx_job_application_id (job_application_id)
- INDEX idx_request_type (request_type)
- INDEX idx_screening_package (screening_package)
- INDEX idx_request_status (request_status)
- INDEX idx_priority_level (priority_level)
- INDEX idx_initiated_by_user_id (initiated_by_user_id)
- INDEX idx_approved_by_user_id (approved_by_user_id)
- INDEX idx_initiated_at (initiated_at)
- INDEX idx_due_date (due_date)

Constraints:
- fk_bg_check_request_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_request_provider_config FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_request_candidate FOREIGN KEY (candidate_id) REFERENCES candidate(id)
- fk_bg_check_request_job_application FOREIGN KEY (job_application_id) REFERENCES job_application(id)
- fk_bg_check_request_initiated_by FOREIGN KEY (initiated_by_user_id) REFERENCES user(id)
- fk_bg_check_request_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_cost_positive CHECK (total_cost >= 0)
- chk_date_order CHECK (due_date >= initiated_at AND estimated_completion_date >= initiated_at)
```

```
Table: background_check_result
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- request_id: UUID (Foreign Key to background_check_request)
- check_type: ENUM('Criminal', 'Education', 'Employment', 'Credit', 'Drug Test', 'MVR', 'Professional License', 'Reference', 'Identity Verification')
- check_status: ENUM('Pending', 'In Progress', 'Completed', 'Failed', 'Cancelled', 'Not Applicable')
- result_status: ENUM('Clear', 'Consider', 'Adverse Action', 'Pending Review', 'Data Not Found', 'Error')
- severity_level: ENUM('None', 'Low', 'Medium', 'High', 'Critical')
- check_date: DATE
- completion_date: TIMESTAMP
- result_details: JSON (Detailed check results and findings)
- provider_reference_id: VARCHAR(100)
- raw_data: JSON (Original response from provider)
- processed_data: JSON (Processed and structured results)
- flags_raised: JSON (Any flags or issues identified)
- recommendation: ENUM('Hire', 'Do Not Hire', 'Conditional Hire', 'Further Review')
- review_required: BOOLEAN (Default: FALSE)
- reviewed_by_user_id: UUID (Foreign Key to user)
- reviewed_at: TIMESTAMP
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_request_id (request_id)
- INDEX idx_check_type (check_type)
- INDEX idx_check_status (check_status)
- INDEX idx_result_status (result_status)
- INDEX idx_severity_level (severity_level)
- INDEX idx_check_date (check_date)
- INDEX idx_completion_date (completion_date)
- INDEX idx_reviewed_by_user_id (reviewed_by_user_id)

Constraints:
- fk_bg_check_result_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_result_request FOREIGN KEY (request_id) REFERENCES background_check_request(id)
- fk_bg_check_result_reviewed_by FOREIGN KEY (reviewed_by_user_id) REFERENCES user(id)
- chk_completion_order CHECK (completion_date >= check_date)
```

--- END OF SECTION 13.2.3 ---

## 13.2.4 Background Check Governance & Access Control Schema

```
Table: background_check_role_permission
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- role_name: VARCHAR(100) (Required, Unique, Indexed)
- role_description: TEXT
- role_type: ENUM('BG_CHECK_ADMIN', 'BG_CHECK_MANAGER', 'BG_CHECK_SPECIALIST', 'HR_ADMIN', 'RECRUITER', 'HIRING_MANAGER', 'COMPLIANCE_OFFICER', 'AUDITOR', 'VIEWER')
- can_initiate_checks: BOOLEAN (Default: FALSE)
- can_approve_checks: BOOLEAN (Default: FALSE)
- can_view_sensitive_data: BOOLEAN (Default: FALSE)
- can_manage_providers: BOOLEAN (Default: FALSE)
- can_view_results: BOOLEAN (Default: FALSE)
- can_adverse_action: BOOLEAN (Default: FALSE)
- can_view_reports: BOOLEAN (Default: FALSE)
- can_export_data: BOOLEAN (Default: FALSE)
- can_manage_integrations: BOOLEAN (Default: FALSE)
- can_view_audit_logs: BOOLEAN (Default: FALSE)
- can_handle_exceptions: BOOLEAN (Default: FALSE)
- can_approve_overrides: BOOLEAN (Default: FALSE)
- can_manage_compliance: BOOLEAN (Default: FALSE)
- data_access_level: ENUM('ALL', 'DEPARTMENT', 'REGION', 'OWN', 'NONE')
- is_active: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_role_name_company (role_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_role_type (role_type)
- INDEX idx_is_active (is_active)
- INDEX idx_data_access_level (data_access_level)

Constraints:
- fk_bg_check_role_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_role_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
```

```
Table: background_check_user_role_assignment
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- role_id: UUID (Foreign Key to background_check_role_permission)
- company_id: UUID (Foreign Key to company)
- department_id: UUID (Foreign Key to department)
- region_id: UUID (Foreign Key to region)
- assigned_by_user_id: UUID (Foreign Key to user)
- assigned_date: TIMESTAMP (Auto)
- expiry_date: DATE
- is_active: BOOLEAN (Default: TRUE)
- assignment_notes: TEXT
- security_clearance_level: ENUM('Basic', 'Standard', 'Enhanced', 'Top Secret')
- background_check_required: BOOLEAN (Default: FALSE)
- background_check_status: ENUM('Not Required', 'Pending', 'Passed', 'Failed', 'Expired')
- fcra_certification_required: BOOLEAN (Default: FALSE)
- fcra_certification_status: ENUM('Not Required', 'Pending', 'Certified', 'Expired')
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_user_role_company (user_id, role_id, company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_role_id (role_id)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_region_id (region_id)
- INDEX idx_is_active (is_active)
- INDEX idx_expiry_date (expiry_date)
- INDEX idx_security_clearance_level (security_clearance_level)

Constraints:
- fk_bg_check_user_role_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_bg_check_user_role_role FOREIGN KEY (role_id) REFERENCES background_check_role_permission(id)
- fk_bg_check_user_role_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_user_role_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_bg_check_user_role_region FOREIGN KEY (region_id) REFERENCES region(id)
- fk_bg_check_user_role_assigned_by FOREIGN KEY (assigned_by_user_id) REFERENCES user(id)
```

--- END OF SECTION 13.2.4 ---

## 13.2.5 Background Check Integration & Audit Performance Schema

```
Table: background_check_integration_monitoring
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- monitoring_date: DATE (Required)
- api_response_time_ms: INTEGER
- sync_success_rate: DECIMAL(5,2) (Percentage)
- data_accuracy_score: DECIMAL(5,2) (Percentage)
- error_rate: DECIMAL(5,2) (Percentage)
- throughput_requests_per_hour: INTEGER
- availability_percentage: DECIMAL(5,2)
- data_latency_minutes: INTEGER
- connection_drops: INTEGER (Default: 0)
- timeout_incidents: INTEGER (Default: 0)
- validation_failures: INTEGER (Default: 0)
- compliance_violations: INTEGER (Default: 0)
- manual_interventions: INTEGER (Default: 0)
- rollback_incidents: INTEGER (Default: 0)
- performance_score: DECIMAL(5,2) (Overall performance rating)
- sla_compliance: BOOLEAN (Default: TRUE)
- critical_incidents: INTEGER (Default: 0)
- warning_incidents: INTEGER (Default: 0)
- system_load_percentage: DECIMAL(5,2)
- memory_usage_mb: INTEGER
- cpu_usage_percentage: DECIMAL(5,2)
- network_latency_ms: INTEGER
- disk_io_wait_ms: INTEGER
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_monitoring_date (monitoring_date)
- INDEX idx_sync_success_rate (sync_success_rate)
- INDEX idx_data_accuracy_score (data_accuracy_score)
- INDEX idx_error_rate (error_rate)
- INDEX idx_performance_score (performance_score)
- INDEX idx_sla_compliance (sla_compliance)

Constraints:
- fk_bg_check_monitoring_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_monitoring_provider_config FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- chk_positive_integers CHECK (api_response_time_ms >= 0 AND throughput_requests_per_hour >= 0 AND connection_drops >= 0)
- chk_score_ranges CHECK (sync_success_rate BETWEEN 0 AND 100 AND data_accuracy_score BETWEEN 0 AND 100 AND error_rate BETWEEN 0 AND 100)
- chk_performance_range CHECK (performance_score BETWEEN 0 AND 100)
```

```
Table: background_check_audit_trail
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- request_id: UUID (Foreign Key to background_check_request)
- audit_type: ENUM('Data Sync', 'Configuration Change', 'Access Control', 'Security Incident', 'Compliance Check', 'Performance Issue', 'Consent Management', 'Adverse Action')
- action: ENUM('Create', 'Update', 'Delete', 'Activate', 'Deactivate', 'Sync', 'Export', 'Import', 'Approve', 'Reject', 'Consent Given', 'Consent Withdrawn')
- entity_type: ENUM('Provider Config', 'Request', 'Result', 'User Role', 'Candidate Data', 'Compliance Setting', 'Consent Record')
- entity_id: UUID
- old_values: JSON (Previous values before change)
- new_values: JSON (New values after change)
- field_changes: JSON (Specific field changes)
- action_reason: TEXT
- business_justification: TEXT
- impact_assessment: TEXT
- risk_level: ENUM('Low', 'Medium', 'High', 'Critical')
- compliance_impact: TEXT
- affected_candidates: INTEGER (Default: 0)
- data_sensitivity_level: ENUM('Public', 'Internal', 'Confidential', 'Restricted', 'PII')
- regulatory_impact: ENUM('None', 'FCRA', 'EEOC', 'GDPR', 'CCPA', 'HIPAA', 'State Laws')
- performed_by_user_id: UUID (Foreign Key to user)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- session_id: VARCHAR(100)
- timestamp: TIMESTAMP (Auto)
- additional_context: JSON (Extra context information)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_request_id (request_id)
- INDEX idx_audit_type (audit_type)
- INDEX idx_action (action)
- INDEX idx_entity_type (entity_type)
- INDEX idx_risk_level (risk_level)
- INDEX idx_performed_by_user_id (performed_by_user_id)
- INDEX idx_timestamp (timestamp)
- INDEX idx_data_sensitivity_level (data_sensitivity_level)

Constraints:
- fk_bg_check_audit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_audit_provider_config FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_audit_request FOREIGN KEY (request_id) REFERENCES background_check_request(id)
- fk_bg_check_audit_performed_by FOREIGN KEY (performed_by_user_id) REFERENCES user(id)
- chk_affected_candidates_positive CHECK (affected_candidates >= 0)
```

--- END OF SECTION 13.2.5 ---

## 13.2.6 Background Check Compliance & Reporting Schema

```
Table: background_check_compliance_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- compliance_type: ENUM('FCRA', 'EEOC', 'State Law', 'Industry Specific', 'International', 'GDPR', 'CCPA')
- jurisdiction: VARCHAR(100) (Required)
- compliance_code: VARCHAR(50) (Required, Indexed)
- regulation_name: VARCHAR(200) (Required)
- compliance_requirements: JSON (Specific compliance requirements)
- consent_requirements: JSON (Consent collection and management)
- disclosure_requirements: JSON (Disclosure requirements)
- adverse_action_procedures: JSON (Adverse action process requirements)
- data_retention_period: INTEGER (Days to retain data)
- reporting_requirements: JSON (Reporting and disclosure requirements)
- notification_requirements: JSON (Candidate notification requirements)
- is_active: BOOLEAN (Default: TRUE)
- effective_date: DATE (Required)
- expiry_date: DATE
- last_updated_by_authority: DATE
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_compliance_type (compliance_type)
- INDEX idx_jurisdiction (jurisdiction)
- INDEX idx_compliance_code (compliance_code)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_date (effective_date)

Constraints:
- fk_bg_check_compliance_config_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_compliance_config_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_compliance_config_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_compliance_config_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (data_retention_period > 0)
- chk_effective_order CHECK (expiry_date IS NULL OR expiry_date >= effective_date)
```

```
Table: background_check_adverse_action
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- request_id: UUID (Foreign Key to background_check_request)
- result_id: UUID (Foreign Key to background_check_result)
- adverse_action_type: ENUM('Pre-Adverse Notice', 'Adverse Action Notice', 'Final Decision', 'Withdrawal')
- action_status: ENUM('Initiated', 'Notice Sent', 'Waiting Period', 'Candidate Response', 'Completed', 'Cancelled')
- trigger_reason: TEXT (Required)
- legal_basis: VARCHAR(200)
- notice_template_used: VARCHAR(200)
- notice_sent_date: DATE
- waiting_period_days: INTEGER (Default: 5)
- response_deadline_date: DATE
- candidate_response: ENUM('No Response', 'Dispute', 'Accept', 'Request Review')
- response_received_date: DATE
- final_decision: ENUM('Proceed with Adverse Action', 'Reverse Decision', 'Further Investigation')
- final_decision_date: DATE
- supporting_documents: JSON (Links to supporting documents)
- legal_review_required: BOOLEAN (Default: FALSE)
- legal_review_completed: BOOLEAN (Default: FALSE)
- legal_review_by_user_id: UUID (Foreign Key to user)
- legal_review_date: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_request_id (request_id)
- INDEX idx_result_id (result_id)
- INDEX idx_adverse_action_type (adverse_action_type)
- INDEX idx_action_status (action_status)
- INDEX idx_notice_sent_date (notice_sent_date)
- INDEX idx_response_deadline_date (response_deadline_date)
- INDEX idx_final_decision_date (final_decision_date)
- INDEX idx_legal_review_by_user_id (legal_review_by_user_id)

Constraints:
- fk_bg_check_adverse_action_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_adverse_action_request FOREIGN KEY (request_id) REFERENCES background_check_request(id)
- fk_bg_check_adverse_action_result FOREIGN KEY (result_id) REFERENCES background_check_result(id)
- fk_bg_check_adverse_action_legal_review_by FOREIGN KEY (legal_review_by_user_id) REFERENCES user(id)
- fk_bg_check_adverse_action_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_waiting_period_positive CHECK (waiting_period_days > 0)
```

--- END OF SECTION 13.2.6 ---

## 13.2.7 Background Check Analytics & Insights Schema

```
Table: background_check_analytics_dashboard
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- dashboard_name: VARCHAR(200) (Required)
- dashboard_type: ENUM('Executive', 'Manager', 'BG Check Admin', 'Compliance', 'Recruitment', 'Operational')
- analysis_period: ENUM('Daily', 'Weekly', 'Monthly', 'Quarterly', 'Yearly', 'YTD', 'Custom')
- report_date: DATE (Required)
- total_requests: INTEGER (Default: 0)
- completed_checks: INTEGER (Default: 0)
- pending_checks: INTEGER (Default: 0)
- failed_checks: INTEGER (Default: 0)
- average_processing_time_hours: DECIMAL(8,2) (Default: 0.00)
- total_cost: DECIMAL(12,2) (Default: 0.00)
- average_cost_per_check: DECIMAL(10,2) (Default: 0.00)
- clear_results: INTEGER (Default: 0)
- consider_results: INTEGER (Default: 0)
- adverse_actions: INTEGER (Default: 0)
- compliance_score: DECIMAL(5,2) (Default: 100.00)
- provider_performance_score: DECIMAL(5,2) (Default: 0.00)
- candidate_satisfaction_score: DECIMAL(5,2) (Default: 0.00)
- time_to_hire_impact_days: DECIMAL(8,2) (Default: 0.00)
- screening_effectiveness_rate: DECIMAL(5,2) (Default: 0.00)
- cost_per_hire_impact: DECIMAL(10,2) (Default: 0.00)
- additional_metrics: JSON (Other KPIs and breakdowns)
- trend_data: JSON (Historical trend information)
- department_breakdown: JSON (Department-wise screening data)
- check_type_breakdown: JSON (Check type performance data)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_dashboard_type (dashboard_type)
- INDEX idx_analysis_period (analysis_period)
- INDEX idx_report_date (report_date)
- INDEX idx_total_requests (total_requests)
- INDEX idx_compliance_score (compliance_score)
- INDEX idx_provider_performance_score (provider_performance_score)

Constraints:
- fk_bg_check_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_analytics_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_analytics_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_positive_counts CHECK (total_requests >= 0 AND completed_checks >= 0 AND pending_checks >= 0)
- chk_positive_metrics CHECK (average_processing_time_hours >= 0 AND total_cost >= 0 AND average_cost_per_check >= 0)
- chk_percentage_ranges CHECK (compliance_score BETWEEN 0 AND 100 AND screening_effectiveness_rate BETWEEN 0 AND 100)
```

```
Table: background_check_cost_analysis
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- analysis_date: DATE (Required)
- cost_category: ENUM('Screening Fees', 'Administrative', 'Compliance', 'Legal Review', 'Technology', 'Training')
- department_id: UUID (Foreign Key to department)
- job_category_id: UUID (Foreign Key to job_category)
- check_type: ENUM('Criminal', 'Education', 'Employment', 'Credit', 'Drug Test', 'MVR', 'Professional License', 'Reference', 'Identity Verification')
- cost_amount: DECIMAL(12,2) (Required)
- cost_percentage: DECIMAL(5,2) (Percentage of total screening cost)
- budget_amount: DECIMAL(12,2)
- variance_amount: DECIMAL(12,2)
- variance_percentage: DECIMAL(5,2)
- request_count: INTEGER (Default: 0)
- average_cost_per_request: DECIMAL(10,2)
- period_over_period_change: DECIMAL(5,2)
- year_over_year_change: DECIMAL(5,2)
- cost_driver: VARCHAR(200)
- cost_trend: ENUM('Increasing', 'Decreasing', 'Stable', 'Volatile')
- efficiency_score: DECIMAL(5,2)
- benchmark_comparison: DECIMAL(5,2)
- cost_optimization_opportunities: JSON
- roi_analysis: JSON (Return on investment analysis)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_analysis_date (analysis_date)
- INDEX idx_cost_category (cost_category)
- INDEX idx_department_id (department_id)
- INDEX idx_job_category_id (job_category_id)
- INDEX idx_check_type (check_type)
- INDEX idx_cost_amount (cost_amount)
- INDEX idx_cost_percentage (cost_percentage)
- INDEX idx_variance_percentage (variance_percentage)

Constraints:
- fk_bg_check_cost_analysis_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_cost_analysis_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_cost_analysis_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_bg_check_cost_analysis_job_category FOREIGN KEY (job_category_id) REFERENCES job_category(id)
- fk_bg_check_cost_analysis_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_positive_amounts CHECK (cost_amount >= 0 AND average_cost_per_request >= 0)
- chk_positive_counts CHECK (request_count >= 0)
- chk_percentage_ranges CHECK (cost_percentage BETWEEN 0 AND 100 AND efficiency_score BETWEEN 0 AND 100)
```

--- END OF SECTION 13.2.7 ---

## 13.2.8 Background Check Communication & Notification Schema

```
Table: background_check_notification_template
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- template_name: VARCHAR(200) (Required, Unique, Indexed)
- template_type: ENUM('Request Initiated', 'Consent Required', 'Check Completed', 'Adverse Action', 'Compliance Reminder', 'System Maintenance', 'Approval Required')
- notification_category: ENUM('Information', 'Warning', 'Error', 'Success', 'Reminder', 'Alert', 'Legal Notice')
- subject_template: VARCHAR(500) (Required)
- body_template: TEXT (Required)
- template_variables: JSON (Variables that can be substituted)
- delivery_channels: JSON (Email, SMS, In-App, Push, Webhook, Postal Mail)
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- is_active: BOOLEAN (Default: TRUE)
- is_default: BOOLEAN (Default: FALSE)
- language_code: VARCHAR(10) (Default: 'en')
- html_enabled: BOOLEAN (Default: TRUE)
- attachment_templates: JSON (Template for attachments)
- approval_required: BOOLEAN (Default: FALSE)
- approval_workflow_id: UUID (Foreign Key to approval_workflow)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- version: INTEGER (Default: 1)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_template_company_name (template_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_template_type (template_type)
- INDEX idx_notification_category (notification_category)
- INDEX idx_priority_level (priority_level)
- INDEX idx_is_active (is_active)
- INDEX idx_is_default (is_default)
- INDEX idx_language_code (language_code)
- INDEX idx_approval_workflow_id (approval_workflow_id)

Constraints:
- fk_bg_check_template_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_template_approval_workflow FOREIGN KEY (approval_workflow_id) REFERENCES approval_workflow(id)
- fk_bg_check_template_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- fk_bg_check_template_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_template_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_version_positive CHECK (version > 0)
```

```
Table: background_check_notification_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- template_id: UUID (Foreign Key to background_check_notification_template)
- request_id: UUID (Foreign Key to background_check_request)
- notification_type: ENUM('Request Initiated', 'Consent Required', 'Check Completed', 'Adverse Action', 'Compliance Alert', 'System Error', 'Maintenance Notice')
- recipient_type: ENUM('Candidate', 'User', 'Role', 'Department', 'All Admins', 'External System', 'Legal Counsel')
- recipient_id: UUID
- recipient_email: VARCHAR(200)
- recipient_phone: VARCHAR(50)
- recipient_address: TEXT (For postal mail)
- delivery_channel: ENUM('Email', 'SMS', 'In-App', 'Push Notification', 'Webhook', 'Postal Mail')
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical', 'Emergency')
- status: ENUM('Pending', 'Sent', 'Delivered', 'Failed', 'Bounced', 'Opened', 'Clicked', 'Returned')
- subject: VARCHAR(500)
- message_body: TEXT
- template_variables_used: JSON (Actual values substituted)
- attachment_urls: JSON (Links to attachments)
- sent_at: TIMESTAMP
- delivered_at: TIMESTAMP
- opened_at: TIMESTAMP
- clicked_at: TIMESTAMP
- failed_at: TIMESTAMP
- failure_reason: TEXT
- retry_count: INTEGER (Default: 0)
- max_retries: INTEGER (Default: 3)
- next_retry_at: TIMESTAMP
- external_message_id: VARCHAR(200) (ID from external service)
- response_data: JSON (Response from notification service)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_template_id (template_id)
- INDEX idx_request_id (request_id)
- INDEX idx_notification_type (notification_type)
- INDEX idx_recipient_type (recipient_type)
- INDEX idx_recipient_id (recipient_id)
- INDEX idx_delivery_channel (delivery_channel)
- INDEX idx_priority_level (priority_level)
- INDEX idx_status (status)
- INDEX idx_sent_at (sent_at)
- INDEX idx_retry_count (retry_count)

Constraints:
- fk_bg_check_notification_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_notification_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_notification_template FOREIGN KEY (template_id) REFERENCES background_check_notification_template(id)
- fk_bg_check_notification_request FOREIGN KEY (request_id) REFERENCES background_check_request(id)
- fk_bg_check_notification_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retry_valid CHECK (retry_count >= 0 AND retry_count <= max_retries)
```

--- END OF SECTION 13.2.8 ---

## 13.2.9 Background Check User Preferences & Personalization Schema

```
Table: background_check_user_preferences
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- dashboard_layout: JSON (Preferred dashboard widget arrangement)
- default_dashboard_view: ENUM('Executive', 'Manager', 'BG Check Admin', 'Compliance', 'Recruitment')
- notification_preferences: JSON (Email, SMS, In-App notification settings)
- report_preferences: JSON (Default report formats and filters)
- data_export_format: ENUM('PDF', 'Excel', 'CSV', 'JSON')
- timezone: VARCHAR(50) (Default: 'UTC')
- date_format: VARCHAR(20) (Default: 'YYYY-MM-DD')
- time_format: ENUM('12-hour', '24-hour') (Default: '24-hour')
- language_preference: VARCHAR(10) (Default: 'en')
- currency_display: VARCHAR(10) (Default: 'USD')
- decimal_places: INTEGER (Default: 2)
- auto_refresh_interval: INTEGER (Default: 300) (Seconds)
- default_date_range: ENUM('Today', 'This Week', 'This Month', 'This Quarter', 'This Year')
- favorite_reports: JSON (Quick access to frequently used reports)
- quick_filters: JSON (Saved filter configurations)
- alert_thresholds: JSON (Personal alert thresholds)
- email_digest_frequency: ENUM('Never', 'Daily', 'Weekly', 'Monthly')
- mobile_app_preferences: JSON (Mobile-specific settings)
- accessibility_settings: JSON (Screen reader, high contrast, etc.)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_user_preferences_company_user (user_id, company_id)
- INDEX idx_user_id (user_id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_default_dashboard_view (default_dashboard_view)
- INDEX idx_language_preference (language_preference)
- INDEX idx_timezone (timezone)

Constraints:
- fk_bg_check_user_preferences_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_bg_check_user_preferences_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_user_preferences_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- chk_positive_intervals CHECK (auto_refresh_interval > 0 AND decimal_places >= 0)
```

```
Table: background_check_personalized_dashboard
Fields:
- id: UUID (Primary Key)
- user_id: UUID (Foreign Key to user)
- company_id: UUID (Foreign Key to company)
- dashboard_name: VARCHAR(200) (Required)
- dashboard_type: ENUM('Custom', 'Executive', 'Manager', 'BG Check Admin', 'Compliance', 'Recruitment')
- is_default: BOOLEAN (Default: FALSE)
- is_public: BOOLEAN (Default: FALSE)
- widget_configuration: JSON (Layout and widget settings)
- data_filters: JSON (Default data filters applied)
- refresh_interval: INTEGER (Default: 300) (Seconds)
- auto_refresh_enabled: BOOLEAN (Default: TRUE)
- drill_down_permissions: JSON (Allowed drill-down levels)
- export_permissions: JSON (Allowed export formats)
- sharing_permissions: JSON (Who can view this dashboard)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_user_id (user_id)
- INDEX idx_company_id (company_id)
- INDEX idx_dashboard_type (dashboard_type)
- INDEX idx_is_default (is_default)
- INDEX idx_is_public (is_public)
- INDEX idx_created_by_user_id (created_by_user_id)
- INDEX idx_updated_by_user_id (updated_by_user_id)

Constraints:
- fk_bg_check_dashboard_user FOREIGN KEY (user_id) REFERENCES user(id)
- fk_bg_check_dashboard_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_dashboard_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_dashboard_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_refresh_interval_positive CHECK (refresh_interval > 0)
```

--- END OF SECTION 13.2.9 ---

## 13.2.10 Background Check Mobile & API Access Schema

```
Table: background_check_mobile_app_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- app_version: VARCHAR(20) (Required)
- platform: ENUM('iOS', 'Android', 'Web', 'Hybrid')
- build_number: VARCHAR(20) (Required)
- release_date: DATE (Required)
- is_current: BOOLEAN (Default: FALSE)
- is_mandatory: BOOLEAN (Default: FALSE)
- min_supported_version: VARCHAR(20)
- features_enabled: JSON (Mobile-specific background check features)
- api_endpoints: JSON (Mobile-specific API endpoints)
- offline_capabilities: JSON (Offline functionality support)
- security_config: JSON (Mobile security settings)
- push_notification_enabled: BOOLEAN (Default: TRUE)
- biometric_auth_enabled: BOOLEAN (Default: TRUE)
- offline_data_retention_days: INTEGER (Default: 30)
- mobile_dashboard_config: JSON (Mobile dashboard layout)
- quick_actions: JSON (Mobile quick action buttons)
- data_sync_settings: JSON (Mobile data sync preferences)
- candidate_portal_access: BOOLEAN (Default: TRUE)
- consent_management_enabled: BOOLEAN (Default: TRUE)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_app_version (app_version)
- INDEX idx_platform (platform)
- idx_is_current (is_current)
- idx_is_mandatory (is_mandatory)
- INDEX idx_release_date (release_date)

Constraints:
- fk_bg_check_mobile_app_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_mobile_app_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_mobile_app_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (offline_data_retention_days >= 0)
```

```
Table: background_check_api_access
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- api_key: VARCHAR(200) (Required, Unique, Indexed)
- api_name: VARCHAR(200) (Required)
- api_description: TEXT
- api_version: VARCHAR(20) (Default: 'v1')
- endpoint_url: VARCHAR(500) (Required)
- authentication_type: ENUM('API Key', 'OAuth 2.0', 'JWT', 'Basic Auth')
- rate_limit_per_hour: INTEGER (Default: 1000)
- rate_limit_per_day: INTEGER (Default: 10000)
- allowed_methods: JSON (HTTP methods allowed)
- allowed_ips: JSON (IP whitelist)
- webhook_url: VARCHAR(500)
- webhook_events: JSON (Events that trigger webhooks)
- is_active: BOOLEAN (Default: TRUE)
- is_internal: BOOLEAN (Default: FALSE)
- access_level: ENUM('Read Only', 'Read Write', 'Admin', 'Full Access')
- data_access_scope: JSON (What data can be accessed)
- created_by_user_id: UUID (Foreign Key to user)
- last_used_at: TIMESTAMP
- usage_count: INTEGER (Default: 0)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_api_key (api_key)
- INDEX idx_api_version (api_version)
- INDEX idx_is_active (is_active)
- INDEX idx_is_internal (is_internal)
- INDEX idx_access_level (access_level)
- INDEX idx_last_used_at (last_used_at)
- INDEX idx_usage_count (usage_count)

Constraints:
- fk_bg_check_api_access_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_api_access_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_api_access_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_rate_limits_positive CHECK (rate_limit_per_hour > 0 AND rate_limit_per_day > 0)
- chk_usage_positive CHECK (usage_count >= 0)
```

--- END OF SECTION 13.2.10 ---

## 13.2.11 Background Check Security & Compliance Schema

```
Table: background_check_security_config
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- security_level: ENUM('Basic', 'Standard', 'Enhanced', 'High', 'Maximum')
- encryption_at_rest: BOOLEAN (Default: TRUE)
- encryption_in_transit: BOOLEAN (Default: TRUE)
- encryption_algorithm: VARCHAR(50) (Default: 'AES-256')
- data_masking_enabled: BOOLEAN (Default: TRUE)
- pii_protection_level: ENUM('Standard', 'Enhanced', 'Maximum')
- access_logging_enabled: BOOLEAN (Default: TRUE)
- session_timeout_minutes: INTEGER (Default: 30)
- password_policy: JSON (Password complexity requirements)
- multi_factor_auth_required: BOOLEAN (Default: TRUE)
- ip_whitelist_enabled: BOOLEAN (Default: FALSE)
- allowed_ip_ranges: JSON (Whitelisted IP addresses)
- geo_fencing_enabled: BOOLEAN (Default: FALSE)
- allowed_countries: JSON (Geographic access restrictions)
- data_classification_policy: JSON (Data sensitivity classification)
- breach_detection_enabled: BOOLEAN (Default: TRUE)
- automated_backup_enabled: BOOLEAN (Default: TRUE)
- backup_retention_days: INTEGER (Default: 90)
- disaster_recovery_plan: JSON (DR procedures and contacts)
- security_audit_frequency: ENUM('Daily', 'Weekly', 'Monthly', 'Quarterly')
- penetration_testing_frequency: ENUM('Monthly', 'Quarterly', 'Semi-Annually', 'Annually')
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_security_level (security_level)
- INDEX idx_encryption_at_rest (encryption_at_rest)
- INDEX idx_multi_factor_auth_required (multi_factor_auth_required)
- INDEX idx_ip_whitelist_enabled (ip_whitelist_enabled)
- INDEX idx_geo_fencing_enabled (geo_fencing_enabled)

Constraints:
- fk_bg_check_security_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_security_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_security_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_security_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_positive_intervals CHECK (session_timeout_minutes > 0 AND backup_retention_days > 0)
```

```
Table: background_check_compliance_monitoring
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- compliance_type: ENUM('FCRA', 'EEOC', 'GDPR', 'CCPA', 'HIPAA', 'State Laws', 'Industry Standards')
- monitoring_frequency: ENUM('Real-time', 'Hourly', 'Daily', 'Weekly', 'Monthly')
- last_check_date: TIMESTAMP
- next_check_date: TIMESTAMP
- compliance_status: ENUM('Compliant', 'Non-Compliant', 'Warning', 'Under Review', 'Exempt')
- compliance_score: DECIMAL(5,2) (Percentage)
- violations_detected: INTEGER (Default: 0)
- critical_violations: INTEGER (Default: 0)
- violations_resolved: INTEGER (Default: 0)
- open_violations: INTEGER (Default: 0)
- compliance_rules: JSON (Specific compliance rules being monitored)
- monitoring_results: JSON (Detailed monitoring results)
- remediation_actions: JSON (Actions taken to resolve violations)
- regulatory_updates: JSON (Recent regulatory changes)
- audit_trail: JSON (Compliance audit history)
- risk_assessment: JSON (Current risk level and factors)
- compliance_reports: JSON (Generated compliance reports)
- notification_settings: JSON (Alert preferences for violations)
- auto_remediation_enabled: BOOLEAN (Default: FALSE)
- escalation_rules: JSON (When to escalate compliance issues)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_compliance_type (compliance_type)
- INDEX idx_monitoring_frequency (monitoring_frequency)
- INDEX idx_last_check_date (last_check_date)
- INDEX idx_next_check_date (next_check_date)
- INDEX idx_compliance_status (compliance_status)
- INDEX idx_compliance_score (compliance_score)
- INDEX idx_violations_detected (violations_detected)

Constraints:
- fk_bg_check_compliance_monitoring_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_compliance_monitoring_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_compliance_monitoring_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_compliance_monitoring_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_score_range CHECK (compliance_score BETWEEN 0 AND 100)
- chk_positive_violations CHECK (violations_detected >= 0 AND critical_violations >= 0)
```

--- END OF SECTION 13.2.11 ---

## 13.2.12 Background Check Workflow & Process Automation Schema

```
Table: background_check_workflow_definition
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- workflow_name: VARCHAR(200) (Required, Unique, Indexed)
- workflow_description: TEXT
- workflow_type: ENUM('Screening Request', 'Consent Management', 'Result Review', 'Adverse Action', 'Compliance Check', 'Provider Integration')
- workflow_category: ENUM('Standard', 'Custom', 'Emergency', 'Compliance', 'Legal Review')
- trigger_events: JSON (Events that initiate this workflow)
- workflow_steps: JSON (Ordered sequence of workflow steps)
- approval_rules: JSON (Approval requirements and routing)
- escalation_rules: JSON (When and how to escalate)
- timeout_settings: JSON (Timeout configurations for each step)
- notification_rules: JSON (When to send notifications)
- conditional_logic: JSON (Conditional branching logic)
- integration_points: JSON (External system integrations)
- is_active: BOOLEAN (Default: TRUE)
- is_default: BOOLEAN (Default: FALSE)
- version: INTEGER (Default: 1)
- priority_level: ENUM('Low', 'Normal', 'High', 'Critical')
- max_execution_time_minutes: INTEGER (Default: 1440)
- retry_configuration: JSON (Retry settings for failed steps)
- error_handling: JSON (Error handling procedures)
- performance_metrics: JSON (KPIs and monitoring settings)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_workflow_company_name (workflow_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_workflow_type (workflow_type)
- INDEX idx_workflow_category (workflow_category)
- INDEX idx_is_active (is_active)
- INDEX idx_is_default (is_default)
- INDEX idx_priority_level (priority_level)
- INDEX idx_version (version)

Constraints:
- fk_bg_check_workflow_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_workflow_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_workflow_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_workflow_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_version_positive CHECK (version > 0)
- chk_execution_time_positive CHECK (max_execution_time_minutes > 0)
```

```
Table: background_check_workflow_execution
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- workflow_definition_id: UUID (Foreign Key to background_check_workflow_definition)
- request_id: UUID (Foreign Key to background_check_request)
- execution_id: VARCHAR(100) (Required, Unique, Indexed)
- execution_status: ENUM('Pending', 'In Progress', 'Completed', 'Failed', 'Cancelled', 'On Hold', 'Escalated')
- current_step: INTEGER (Default: 1)
- total_steps: INTEGER (Required)
- started_at: TIMESTAMP (Auto)
- completed_at: TIMESTAMP
- due_date: TIMESTAMP
- actual_duration_minutes: INTEGER
- initiator_user_id: UUID (Foreign Key to user)
- assigned_to_user_id: UUID (Foreign Key to user)
- step_history: JSON (History of completed steps)
- current_step_data: JSON (Data for current step)
- variables: JSON (Workflow variables and context)
- error_log: JSON (Error messages and stack traces)
- retry_count: INTEGER (Default: 0)
- max_retries: INTEGER (Default: 3)
- escalation_level: INTEGER (Default: 0)
- parent_execution_id: UUID (Foreign Key to background_check_workflow_execution)
- child_executions: JSON (IDs of child workflow executions)
- performance_metrics: JSON (Execution performance data)
- completion_summary: JSON (Final execution summary)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_execution_company_id (execution_id, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_workflow_definition_id (workflow_definition_id)
- INDEX idx_request_id (request_id)
- INDEX idx_execution_status (execution_status)
- INDEX idx_current_step (current_step)
- INDEX idx_started_at (started_at)
- INDEX idx_due_date (due_date)
- INDEX idx_initiator_user_id (initiator_user_id)
- INDEX idx_assigned_to_user_id (assigned_to_user_id)
- INDEX idx_parent_execution_id (parent_execution_id)

Constraints:
- fk_bg_check_execution_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_execution_workflow_definition FOREIGN KEY (workflow_definition_id) REFERENCES background_check_workflow_definition(id)
- fk_bg_check_execution_request FOREIGN KEY (request_id) REFERENCES background_check_request(id)
- fk_bg_check_execution_initiator FOREIGN KEY (initiator_user_id) REFERENCES user(id)
- fk_bg_check_execution_assigned_to FOREIGN KEY (assigned_to_user_id) REFERENCES user(id)
- fk_bg_check_execution_parent FOREIGN KEY (parent_execution_id) REFERENCES background_check_workflow_execution(id)
- chk_step_valid CHECK (current_step >= 1 AND current_step <= total_steps)
- chk_positive_values CHECK (total_steps > 0 AND actual_duration_minutes >= 0)
```

--- END OF SECTION 13.2.12 ---

## 13.2.13 Background Check Data Archival & Retention Schema

```
Table: background_check_retention_policy
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- policy_name: VARCHAR(200) (Required, Unique, Indexed)
- policy_type: ENUM('Legal Requirement', 'Company Policy', 'Industry Standard', 'Contractual Obligation')
- data_category: ENUM('Request Data', 'Results Data', 'Consent Records', 'Audit Logs', 'Compliance Data', 'Communication Logs')
- retention_period_days: INTEGER (Required)
- retention_period_type: ENUM('Fixed Days', 'Years After Completion', 'Until Candidate Age', 'Indefinite')
- archival_action: ENUM('Delete', 'Archive', 'Anonymize', 'Aggregate')
- archival_location: ENUM('Cold Storage', 'Long-term Archive', 'Compliance Archive', 'Secure Delete')
- compliance_requirements: JSON (Legal and regulatory requirements)
- business_justification: TEXT
- auto_apply: BOOLEAN (Default: TRUE)
- is_active: BOOLEAN (Default: TRUE)
- effective_date: DATE (Required)
- expiry_date: DATE
- last_review_date: DATE
- next_review_date: DATE
- review_frequency_months: INTEGER (Default: 12)
- exceptions_allowed: BOOLEAN (Default: FALSE)
- exception_approval_required: BOOLEAN (Default: TRUE)
- notification_settings: JSON (Notifications before archival)
- created_by_user_id: UUID (Foreign Key to user)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_bg_check_retention_company_name (policy_name, company_id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_policy_type (policy_type)
- INDEX idx_data_category (data_category)
- INDEX idx_retention_period_days (retention_period_days)
- INDEX idx_archival_action (archival_action)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_date (effective_date)
- INDEX idx_next_review_date (next_review_date)

Constraints:
- fk_bg_check_retention_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_retention_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_retention_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_bg_check_retention_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_retention_positive CHECK (retention_period_days > 0 AND review_frequency_months > 0)
- chk_effective_order CHECK (expiry_date IS NULL OR expiry_date >= effective_date)
```

```
Table: background_check_archival_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- provider_config_id: UUID (Foreign Key to background_check_provider_config)
- retention_policy_id: UUID (Foreign Key to background_check_retention_policy)
- archival_batch_id: VARCHAR(100) (Required, Indexed)
- archival_date: DATE (Required)
- archival_action: ENUM('Archive', 'Delete', 'Anonymize', 'Aggregate')
- data_type: ENUM('Request Records', 'Result Records', 'Consent Data', 'Audit Logs', 'Notifications', 'Compliance Data')
- records_processed: INTEGER (Default: 0)
- records_archived: INTEGER (Default: 0)
- records_failed: INTEGER (Default: 0)
- archive_location: VARCHAR(500)
- archive_size_mb: DECIMAL(12,2)
- compression_ratio: DECIMAL(5,2)
- encryption_method: VARCHAR(50)
- retention_expiry_date: DATE
- verification_status: ENUM('Pending', 'Verified', 'Failed', 'Requires Review')
- verification_date: TIMESTAMP
- verification_details: JSON (Verification results and checksums)
- error_log: JSON (Errors encountered during archival)
- rollback_available: BOOLEAN (Default: FALSE)
- rollback_deadline: DATE
- compliance_attestation: BOOLEAN (Default: FALSE)
- attestation_by_user_id: UUID (Foreign Key to user)
- attestation_date: TIMESTAMP
- cost_savings: DECIMAL(12,2) (Estimated cost savings from archival)
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_provider_config_id (provider_config_id)
- INDEX idx_retention_policy_id (retention_policy_id)
- INDEX idx_archival_batch_id (archival_batch_id)
- INDEX idx_archival_date (archival_date)
- INDEX idx_archival_action (archival_action)
- INDEX idx_data_type (data_type)
- INDEX idx_verification_status (verification_status)
- INDEX idx_retention_expiry_date (retention_expiry_date)
- INDEX idx_attestation_by_user_id (attestation_by_user_id)

Constraints:
- fk_bg_check_archival_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_bg_check_archival_provider FOREIGN KEY (provider_config_id) REFERENCES background_check_provider_config(id)
- fk_bg_check_archival_retention_policy FOREIGN KEY (retention_policy_id) REFERENCES background_check_retention_policy(id)
- fk_bg_check_archival_attestation_by FOREIGN KEY (attestation_by_user_id) REFERENCES user(id)
- fk_bg_check_archival_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_positive_counts CHECK (records_processed >= 0 AND records_archived >= 0 AND records_failed >= 0)
- chk_archive_size_positive CHECK (archive_size_mb >= 0)
- chk_compression_ratio_valid CHECK (compression_ratio BETWEEN 0 AND 1)
```

--- END OF SECTION 13.2.13 ---
