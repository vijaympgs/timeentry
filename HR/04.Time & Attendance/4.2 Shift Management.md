# 4.2 Shift Management

## 4.2.1 Business Purpose

Shift Management provides comprehensive scheduling and rotation management for employee work shifts, ensuring optimal staffing coverage, compliance with labor regulations, and efficient resource allocation. This enables organizations to manage complex shift patterns, rotation schedules, and coverage requirements while supporting multiple work locations and business operations.

## 4.2.2 Business Scope

Enable complete shift management including shift scheduling, rotation patterns, overtime rules, break time tracking, and coverage planning. The system supports automated scheduling, conflict detection, compliance monitoring, and real-time adjustments while ensuring accuracy, fairness, and regulatory compliance across all shift types and work locations.

## 4.2.3 Shift Master Schema

```
Table: shift
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- shift_code: VARCHAR(50) (Required, Indexed)
- shift_name: VARCHAR(200) (Required)
- shift_type: ENUM('Regular', 'Night', 'Weekend', 'Holiday', 'On-Call', 'Split', 'Rotating', 'Flexible')
- work_schedule_id: UUID (Foreign Key to work_schedule)
- location_id: UUID (Foreign Key to location)
- department_id: UUID (Foreign Key to department)
- start_time: TIME (Required)
- end_time: TIME (Required)
- duration_hours: DECIMAL(4,2) (Required)
- break_duration_minutes: INTEGER (Default: 0)
- paid_break_minutes: INTEGER (Default: 0)
- unpaid_break_minutes: INTEGER (Default: 0)
- is_night_shift: BOOLEAN (Default: FALSE)
- is_weekend_shift: BOOLEAN (Default: FALSE)
- is_holiday_shift: BOOLEAN (Default: FALSE)
- overtime_eligible: BOOLEAN (Default: TRUE)
- double_time_eligible: BOOLEAN (Default: FALSE)
- shift_differential_rate: DECIMAL(5,2) (Default: 0.00)
- night_differential_rate: DECIMAL(5,2) (Default: 0.00)
- weekend_differential_rate: DECIMAL(5,2) (Default: 0.00)
- holiday_differential_rate: DECIMAL(5,2) (Default: 0.00)
- minimum_staff_required: INTEGER (Default: 1)
- maximum_staff_allowed: INTEGER (Default: 50)
- skill_requirements: JSON (Array of required skills)
- certification_requirements: JSON (Array of required certifications)
- physical_requirements: JSON (Physical demands and requirements)
- safety_requirements: JSON (Safety protocols and equipment)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- UNIQUE KEY uk_shift_company_code (company_id, shift_code)
- INDEX idx_company_id (company_id)
- INDEX idx_shift_type (shift_type)
- INDEX idx_work_schedule_id (work_schedule_id)
- INDEX idx_location_id (location_id)
- INDEX idx_department_id (department_id)
- INDEX idx_start_time (start_time)
- INDEX idx_end_time (end_time)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_shift_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_work_schedule FOREIGN KEY (work_schedule_id) REFERENCES work_schedule(id)
- fk_shift_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_shift_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_shift_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_duration_positive CHECK (duration_hours > 0)
- chk_break_duration_valid CHECK (break_duration_minutes >= 0 AND paid_break_minutes >= 0 AND unpaid_break_minutes >= 0)
- chk_staff_limits CHECK (maximum_staff_allowed >= minimum_staff_required)
```

## 4.2.4 Shift Rotation Schema

```
Table: shift_rotation
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- rotation_name: VARCHAR(200) (Required)
- rotation_type: ENUM('Fixed', 'Rotating', 'Alternating', 'Flexible', 'Seasonal', 'Project-Based')
- rotation_pattern: ENUM('Daily', 'Weekly', 'Bi-Weekly', 'Monthly', 'Custom')
- rotation_cycle_days: INTEGER (Required)
- rotation_description: TEXT
- shift_sequence: JSON (Array of shift IDs in rotation order)
- rotation_schedule: JSON (Detailed rotation schedule and timing)
- day_shift_id: UUID (Foreign Key to shift)
- night_shift_id: UUID (Foreign Key to shift)
- weekend_shift_id: UUID (Foreign Key to shift)
- holiday_shift_id: UUID (Foreign Key to shift)
- rotation_start_day: ENUM('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday')
- auto_rotate: BOOLEAN (Default: TRUE)
- rotation_frequency_days: INTEGER (Default: 7)
- advance_notice_days: INTEGER (Default: 7)
- max_consecutive_days: INTEGER (Default: 6)
- min_rest_hours_between_shifts: INTEGER (Default: 11)
- is_active: BOOLEAN (Default: TRUE)
- effective_from: DATE (Required)
- effective_to: DATE
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_rotation_type (rotation_type)
- INDEX idx_rotation_pattern (rotation_pattern)
- INDEX idx_day_shift_id (day_shift_id)
- INDEX idx_night_shift_id (night_shift_id)
- INDEX idx_weekend_shift_id (weekend_shift_id)
- INDEX idx_holiday_shift_id (holiday_shift_id)
- INDEX idx_is_active (is_active)
- INDEX idx_effective_from (effective_from)

Constraints:
- fk_shift_rotation_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_rotation_day_shift FOREIGN KEY (day_shift_id) REFERENCES shift(id)
- fk_shift_rotation_night_shift FOREIGN KEY (night_shift_id) REFERENCES shift(id)
- fk_shift_rotation_weekend_shift FOREIGN KEY (weekend_shift_id) REFERENCES shift(id)
- fk_shift_rotation_holiday_shift FOREIGN KEY (holiday_shift_id) REFERENCES shift(id)
- fk_shift_rotation_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- chk_cycle_days_positive CHECK (rotation_cycle_days > 0)
- chk_frequency_days_positive CHECK (rotation_frequency_days > 0)
- chk_advance_notice_positive CHECK (advance_notice_days >= 0)
```

## 4.2.5 Employee Shift Assignment Schema

```
Table: employee_shift_assignment
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- employee_id: UUID (Foreign Key to employee)
- shift_id: UUID (Foreign Key to shift)
- rotation_id: UUID (Foreign Key to shift_rotation)
- assignment_type: ENUM('Permanent', 'Temporary', 'Rotating', 'On-Call', 'Backup', 'Project')
- assignment_status: ENUM('Active', 'Inactive', 'On Leave', 'Transferred', 'Terminated')
- effective_from: DATE (Required)
- effective_to: DATE
- primary_assignment: BOOLEAN (Default: FALSE)
- assignment_priority: ENUM('Low', 'Medium', 'High', 'Critical')
- work_location_id: UUID (Foreign Key to location)
- department_id: UUID (Foreign Key to department)
- cost_center_code: VARCHAR(50)
- reporting_manager_id: UUID (Foreign Key to employee)
- team_lead_id: UUID (Foreign Key to employee)
- backup_employee_id: UUID (Foreign Key to employee)
- skill_match_score: DECIMAL(5,2) (Default: 0.00)
- certification_match_score: DECIMAL(5,2) (Default: 0.00)
- availability_score: DECIMAL(5,2) (Default: 0.00)
- performance_score: DECIMAL(5,2) (Default: 0.00)
- preference_score: DECIMAL(5,2) (Default: 0.00)
- seniority_score: DECIMAL(5,2) (Default: 0.00)
- assignment_reason: TEXT
- special_conditions: JSON (Special assignment conditions and requirements)
- created_by_user_id: UUID (Foreign Key to user)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_shift_id (shift_id)
- INDEX idx_rotation_id (rotation_id)
- INDEX idx_assignment_type (assignment_type)
- INDEX idx_assignment_status (assignment_status)
- INDEX idx_effective_from (effective_from)
- INDEX idx_effective_to (effective_to)
- INDEX idx_primary_assignment (primary_assignment)
- INDEX idx_assignment_priority (assignment_priority)

Constraints:
- fk_employee_shift_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_employee_shift_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_employee_shift_shift FOREIGN KEY (shift_id) REFERENCES shift(id)
- fk_employee_shift_rotation FOREIGN KEY (rotation_id) REFERENCES shift_rotation(id)
- fk_employee_shift_location FOREIGN KEY (work_location_id) REFERENCES location(id)
- fk_employee_shift_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_employee_shift_manager FOREIGN KEY (reporting_manager_id) REFERENCES employee(id)
- fk_employee_shift_team_lead FOREIGN KEY (team_lead_id) REFERENCES employee(id)
- fk_employee_shift_backup FOREIGN KEY (backup_employee_id) REFERENCES employee(id)
- fk_employee_shift_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_employee_shift_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_score_ranges CHECK (skill_match_score BETWEEN 0 AND 100 AND certification_match_score BETWEEN 0 AND 100 AND availability_score BETWEEN 0 AND 100)
```

## 4.2.6 Shift Schedule Schema

```
Table: shift_schedule
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- schedule_name: VARCHAR(200) (Required)
- schedule_type: ENUM('Weekly', 'Bi-Weekly', 'Monthly', 'Custom', 'Holiday', 'Special Event')
- schedule_period_start: DATE (Required)
- schedule_period_end: DATE (Required)
- schedule_status: ENUM('Draft', 'Published', 'Active', 'Completed', 'Cancelled')
- location_id: UUID (Foreign Key to location)
- department_id: UUID (Foreign Key to department)
- shift_id: UUID (Foreign Key to shift)
- scheduled_date: DATE (Required)
- scheduled_start_time: TIME (Required)
- scheduled_end_time: TIME (Required)
- scheduled_duration_hours: DECIMAL(4,2) (Required)
- assigned_employees: JSON (Array of employee IDs)
- required_employees: INTEGER (Default: 1)
- confirmed_employees: INTEGER (Default: 0)
- backup_employees: JSON (Array of backup employee IDs)
- on_call_employees: JSON (Array of on-call employee IDs)
- coverage_percentage: DECIMAL(5,2) (Default: 0.00)
- overtime_approved: BOOLEAN (Default: FALSE)
- special_instructions: TEXT
- emergency_contacts: JSON (Emergency contact information)
- equipment_requirements: JSON (Required equipment and tools)
- safety_requirements: JSON (Safety protocols and equipment)
- created_by_user_id: UUID (Foreign Key to user)
- approved_by_user_id: UUID (Foreign Key to user)
- approved_at: TIMESTAMP
- published_at: TIMESTAMP
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_schedule_name (schedule_name)
- INDEX idx_schedule_type (schedule_type)
- INDEX idx_schedule_period_start (schedule_period_start)
- INDEX idx_schedule_period_end (schedule_period_end)
- INDEX idx_schedule_status (schedule_status)
- INDEX idx_location_id (location_id)
- INDEX idx_department_id (department_id)
- INDEX idx_shift_id (shift_id)
- INDEX idx_scheduled_date (scheduled_date)
- INDEX idx_coverage_percentage (coverage_percentage)

Constraints:
- fk_shift_schedule_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_schedule_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_shift_schedule_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_shift_schedule_shift FOREIGN KEY (shift_id) REFERENCES shift(id)
- fk_shift_schedule_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
- fk_shift_schedule_approved_by FOREIGN KEY (approved_by_user_id) REFERENCES user(id)
- chk_period_order CHECK (schedule_period_end >= schedule_period_start)
- chk_duration_positive CHECK (scheduled_duration_hours > 0)
- chk_employee_counts CHECK (confirmed_employees <= required_employees)
```

## 4.2.7 Shift Swap Schema

```
Table: shift_swap
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- original_employee_id: UUID (Foreign Key to employee)
- replacement_employee_id: UUID (Foreign Key to employee)
- shift_schedule_id: UUID (Foreign Key to shift_schedule)
- swap_type: ENUM('Voluntary', 'Manager Initiated', 'Emergency', 'Permanent', 'Temporary')
- swap_status: ENUM('Requested', 'Pending Approval', 'Approved', 'Rejected', 'Completed', 'Cancelled')
- swap_reason: TEXT (Required)
- original_shift_date: DATE (Required)
- replacement_shift_date: DATE
- swap_effective_from: DATE (Required)
- swap_effective_to: DATE
- manager_approval_required: BOOLEAN (Default: TRUE)
- hr_approval_required: BOOLEAN (Default: FALSE)
- approved_by_manager_id: UUID (Foreign Key to employee)
- approved_by_hr_id: UUID (Foreign Key to employee)
- manager_approved_at: TIMESTAMP
- hr_approved_at: TIMESTAMP
- swap_notes: TEXT
- impact_assessment: TEXT
- compensation_adjustment: BOOLEAN (Default: FALSE)
- compensation_details: JSON (Compensation adjustment information)
- notification_sent: BOOLEAN (Default: FALSE)
- requested_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_original_employee_id (original_employee_id)
- INDEX idx_replacement_employee_id (replacement_employee_id)
- INDEX idx_shift_schedule_id (shift_schedule_id)
- INDEX idx_swap_type (swap_type)
- INDEX idx_swap_status (swap_status)
- INDEX idx_original_shift_date (original_shift_date)
- INDEX idx_swap_effective_from (swap_effective_from)
- INDEX idx_manager_approval_required (manager_approval_required)

Constraints:
- fk_shift_swap_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_swap_original_employee FOREIGN KEY (original_employee_id) REFERENCES employee(id)
- fk_shift_swap_replacement_employee FOREIGN KEY (replacement_employee_id) REFERENCES employee(id)
- fk_shift_swap_schedule FOREIGN KEY (shift_schedule_id) REFERENCES shift_schedule(id)
- fk_shift_swap_manager_approval FOREIGN KEY (approved_by_manager_id) REFERENCES employee(id)
- fk_shift_swap_hr_approval FOREIGN KEY (approved_by_hr_id) REFERENCES employee(id)
- fk_shift_swap_requested_by FOREIGN KEY (requested_by_user_id) REFERENCES user(id)
- chk_effective_period CHECK (swap_effective_to IS NULL OR swap_effective_to >= swap_effective_from)
```

## 4.2.8 Shift Coverage Schema

```
Table: shift_coverage
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- location_id: UUID (Foreign Key to location)
- department_id: UUID (Foreign Key to department)
- shift_id: UUID (Foreign Key to shift)
- coverage_date: DATE (Required)
- coverage_period: ENUM('Day', 'Night', '24 Hours', 'Custom')
- minimum_staff_required: INTEGER (Required)
- maximum_staff_allowed: INTEGER (Required)
- currently_scheduled: INTEGER (Default: 0)
- currently_confirmed: INTEGER (Default: 0)
- coverage_percentage: DECIMAL(5,2) (Default: 0.00)
- coverage_status: ENUM('Fully Covered', 'Partially Covered', 'Understaffed', 'Overstaffed', 'Critical')
- skill_gaps: JSON (Array of missing skills)
- certification_gaps: JSON (Array of missing certifications)
- backup_coverage: INTEGER (Default: 0)
- on_call_coverage: INTEGER (Default: 0)
- overtime_coverage: INTEGER (Default: 0)
- external_coverage: INTEGER (Default: 0)
- coverage_risk_level: ENUM('Low', 'Medium', 'High', 'Critical')
- contingency_plans: JSON (Contingency plans and backup options)
- auto_fill_enabled: BOOLEAN (Default: FALSE)
- auto_fill_criteria: JSON (Auto-fill criteria and rules)
- last_updated: TIMESTAMP (Auto)
- updated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_location_id (location_id)
- INDEX idx_department_id (department_id)
- INDEX idx_shift_id (shift_id)
- INDEX idx_coverage_date (coverage_date)
- INDEX idx_coverage_period (coverage_period)
- INDEX idx_coverage_status (coverage_status)
- INDEX idx_coverage_percentage (coverage_percentage)
- INDEX idx_coverage_risk_level (coverage_risk_level)

Constraints:
- fk_shift_coverage_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_coverage_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_shift_coverage_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_shift_coverage_shift FOREIGN KEY (shift_id) REFERENCES shift(id)
- fk_shift_coverage_updated_by FOREIGN KEY (updated_by_user_id) REFERENCES user(id)
- chk_staff_limits CHECK (maximum_staff_allowed >= minimum_staff_required)
- chk_coverage_percentage CHECK (coverage_percentage BETWEEN 0 AND 100)
```

## 4.2.9 Shift Analytics Schema

```
Table: shift_analytics
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- department_id: UUID (Foreign Key to department)
- location_id: UUID (Foreign Key to location)
- shift_id: UUID (Foreign Key to shift)
- analysis_type: ENUM('Coverage Analysis', 'Staffing Efficiency', 'Overtime Analysis', 'Cost Analysis', 'Compliance Analysis', 'Productivity Analysis')
- analysis_period: ENUM('Daily', 'Weekly', 'Monthly', 'Quarterly', 'Semi-Annual', 'Annual')
- analysis_date: DATE (Required)
- metric_name: VARCHAR(100) (Required)
- metric_value: DECIMAL(15,2)
- metric_unit: VARCHAR(50)
- benchmark_value: DECIMAL(15,2)
- variance_percentage: DECIMAL(5,2)
- target_value: DECIMAL(15,2)
- achievement_percentage: DECIMAL(5,2)
- total_shifts: INTEGER (Default: 0)
- covered_shifts: INTEGER (Default: 0)
- uncovered_shifts: INTEGER (Default: 0)
- overtime_shifts: INTEGER (Default: 0)
- total_hours_scheduled: DECIMAL(8,2) (Default: 0.00)
- total_hours_worked: DECIMAL(8,2) (Default: 0.00)
- overtime_hours: DECIMAL(8,2) (Default: 0.00)
- staffing_efficiency_score: DECIMAL(5,2) (Default: 0.00)
- coverage_efficiency_score: DECIMAL(5,2) (Default: 0.00)
- cost_efficiency_score: DECIMAL(5,2) (Default: 0.00)
- compliance_score: DECIMAL(5,2) (Default: 0.00)
- additional_metrics: JSON (Additional KPIs and breakdowns)
- calculated_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_department_id (department_id)
- INDEX idx_location_id (location_id)
- INDEX idx_shift_id (shift_id)
- INDEX idx_analysis_type (analysis_type)
- INDEX idx_analysis_period (analysis_period)
- INDEX idx_analysis_date (analysis_date)
- INDEX idx_metric_name (metric_name)

Constraints:
- fk_shift_analytics_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_analytics_department FOREIGN KEY (department_id) REFERENCES department(id)
- fk_shift_analytics_location FOREIGN KEY (location_id) REFERENCES location(id)
- fk_shift_analytics_shift FOREIGN KEY (shift_id) REFERENCES shift(id)
- fk_shift_analytics_calculated_by FOREIGN KEY (calculated_by_user_id) REFERENCES user(id)
```

## 4.2.10 Shift Communication Schema

```
Table: shift_communication
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- employee_id: UUID (Foreign Key to employee)
- communication_type: ENUM('Schedule Change', 'Shift Swap', 'Coverage Alert', 'Overtime Request', 'Emergency Coverage', 'Schedule Publication')
- communication_title: VARCHAR(200) (Required)
- communication_purpose: TEXT
- delivery_method: ENUM('Email', 'SMS', 'Push Notification', 'Portal Alert', 'Manager Notification', 'Team Notification')
- communication_status: ENUM('Draft', 'Scheduled', 'Sent', 'Delivered', 'Failed', 'Read', 'Acknowledged', 'Action Required')
- shift_schedule_id: UUID (Foreign Key to shift_schedule)
- scheduled_time: TIMESTAMP
- sent_time: TIMESTAMP
- delivery_time: TIMESTAMP
- read_time: TIMESTAMP
- acknowledged_time: TIMESTAMP
- action_deadline: DATE
- action_completed: BOOLEAN (Default: FALSE)
- action_completion_date: DATE
- content_type: ENUM('Text', 'HTML', 'PDF', 'Link', 'Interactive')
- content_summary: TEXT
- content_details: JSON (Full communication content)
- priority: ENUM('Low', 'Medium', 'High', 'Urgent', 'Critical')
- requires_response: BOOLEAN (Default: FALSE)
- response_received: BOOLEAN (Default: FALSE)
- response_details: TEXT
- created_by_user_id: UUID (Foreign Key to user)
- created_at: TIMESTAMP (Auto)
- updated_at: TIMESTAMP (Auto)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_employee_id (employee_id)
- INDEX idx_communication_type (communication_type)
- INDEX idx_delivery_method (delivery_method)
- INDEX idx_communication_status (communication_status)
- INDEX idx_shift_schedule_id (shift_schedule_id)
- INDEX idx_scheduled_time (scheduled_time)
- INDEX idx_priority (priority)
- INDEX idx_requires_response (requires_response)
- INDEX idx_action_deadline (action_deadline)

Constraints:
- fk_shift_communication_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_communication_employee FOREIGN KEY (employee_id) REFERENCES employee(id)
- fk_shift_communication_schedule FOREIGN KEY (shift_schedule_id) REFERENCES shift_schedule(id)
- fk_shift_communication_created_by FOREIGN KEY (created_by_user_id) REFERENCES user(id)
```

## 4.2.11 Shift Audit Log Schema

```
Table: shift_audit_log
Fields:
- id: UUID (Primary Key)
- company_id: UUID (Foreign Key to company)
- action: ENUM('Create', 'Update', 'Delete', 'Assign', 'Swap', 'Approve', 'Reject', 'Publish', 'Cancel', 'Modify')
- entity_type: ENUM('Shift', 'Rotation', 'Assignment', 'Schedule', 'Swap', 'Coverage', 'Analytics', 'Communication')
- entity_id: UUID
- old_values: JSON (Previous values)
- new_values: JSON (Updated values)
- field_changes: JSON (Specific field changes)
- action_reason: TEXT
- business_justification: TEXT
- impact_assessment: TEXT
- affected_employees: INTEGER (Default: 0)
- payroll_impact: BOOLEAN (Default: FALSE)
- compliance_impact: TEXT
- coverage_impact: TEXT
- performed_by_user_id: UUID (Foreign Key to user)
- ip_address: VARCHAR(45)
- user_agent: TEXT
- session_id: VARCHAR(100)
- timestamp: TIMESTAMP (Auto)
- additional_context: JSON (Extra context information)

Indexes:
- PRIMARY KEY (id)
- INDEX idx_company_id (company_id)
- INDEX idx_action (action)
- INDEX idx_entity_type (entity_type)
- INDEX idx_performed_by (performed_by_user_id)
- INDEX idx_timestamp (timestamp)
- INDEX idx_payroll_impact (payroll_impact)
- INDEX idx_affected_employees (affected_employees)

Constraints:
- fk_shift_audit_company FOREIGN KEY (company_id) REFERENCES company(id)
- fk_shift_audit_performed_by FOREIGN KEY (performed_by_user_id) REFERENCES user(id)
